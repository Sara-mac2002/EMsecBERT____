Remote B-TARGET_ASSET
services I-TARGET_ASSET
could O
be O
used O
to O
support O
remote O
access O
, O
data O
transmission O
, O
authentication O
, O
name O
resolution O
, O
and O
other O
remote O
functions O
. O

Further O
, O
remote B-TARGET_ASSET
services I-TARGET_ASSET
may O
be O
necessary O
to O
allow O
operators O
and O
administrators O
to O
configure O
systems B-TARGET_ASSET
within O
the O
network B-TARGET_ASSET
from O
their O
engineering B-TARGET_ASSET
or O
management O
workstations B-TARGET_ASSET
. O

An O
adversary O
may O
use O
this O
technique O
to O
access O
devices B-TARGET_ASSET
which O
may O
be O
dual-homed B-PRECON
( O
Citation O
: O
Blake O
Johnson O
, O
Dan O
Caban O
, O
Marina O
Krotofil O
, O
Dan O
Scali O
, O
Nathan O
Brubaker O
, O
Christopher O
Glyer O
December O
2017 O
) O
to O
multiple O
network B-TARGET_ASSET
segments I-TARGET_ASSET
, O
and O
can O
be O
used O
for O
[ O
Program O
Download O
] O
( O
https://attack.mitre.org/techniques/T0843 O
) O
or O
to O
execute O
attacks O
on O
control B-TARGET_ASSET
devices I-TARGET_ASSET
directly O
through O
[ O
Valid O
Accounts O
] O
( O
https://attack.mitre.org/techniques/T0859 O
) O
. O

Specific O
remote B-TARGET_ASSET
services I-TARGET_ASSET
( O
RDP B-TARGET_ASSET
& O
VNC B-TARGET_ASSET
) O
may O
be O
a O
precursor O
to O
enable O
[ O
Graphical O
User O
Interface O
] O
( O
https://attack.mitre.org/techniques/T0823 O
) O
execution O
on O
devices B-TARGET_ASSET
such O
as O
HMIs B-TARGET_ASSET
or O
engineering B-TARGET_ASSET
workstation I-TARGET_ASSET
software B-TARGET_ASSET
. O

Based O
on O
incident O
data O
, O
CISA O
and O
FBI O
assessed O
that O
Chinese O
state-sponsored O
actors O
also O
compromised O
various O
authorized B-PRECON
remote I-PRECON
access I-PRECON
channels B-TARGET_ASSET
, O
including O
systems B-TARGET_ASSET
designed O
to O
transfer O
data O
and/or O
allow O
access O
between O
corporate B-TARGET_ASSET
and O
ICS B-TARGET_ASSET
networks I-TARGET_ASSET
. O

( O
Citation O
: O
CISA O
AA21-201A O
Pipeline O
Intrusion O
July O
2021 O
) O

Adversaries O
may O
use O
input/output O
( O
I/O O
) O
module B-TARGET_ASSET
discovery I-TARGET_ASSET
to O
gather O
key O
information O
about O
a O
control B-TARGET_ASSET
system I-TARGET_ASSET
device I-TARGET_ASSET
. O

An O
I/O B-TARGET_ASSET
module I-TARGET_ASSET
is O
a O
device B-TARGET_ASSET
that O
allows O
the O
control B-TARGET_ASSET
system I-TARGET_ASSET
device I-TARGET_ASSET
to O
either O
receive O
or O
send O
signals O
to O
other O
devices B-TARGET_ASSET
. O

These O
signals O
can O
be O
analog O
or O
digital O
, O
and O
may O
support O
a O
number O
of O
different O
protocols B-TARGET_ASSET
. O

Devices B-TARGET_ASSET
are O
often O
able O
to O
use O
attachable B-PRECON
I/O I-PRECON
modules B-TARGET_ASSET
to O
increase O
the O
number O
of O
inputs O
and O
outputs O
that O
it O
can O
utilize O
. O

An O
adversary O
with O
access O
to O
a O
device B-TARGET_ASSET
can O
use O
native B-PRECON
device I-PRECON
functions I-PRECON
to O
enumerate O
I/O B-TARGET_ASSET
modules I-TARGET_ASSET
that O
are O
connected O
to O
the O
device B-TARGET_ASSET
. O

Information O
regarding O
the O
I/O B-TARGET_ASSET
modules I-TARGET_ASSET
can O
aid O
the O
adversary O
in O
understanding O
related O
control O
processes O
. O

Adversaries O
may O
cause O
a O
denial B-TARGET_ASSET
of I-TARGET_ASSET
control I-TARGET_ASSET
to O
temporarily O
prevent O
operators O
and O
engineers O
from O
interacting O
with O
process O
controls B-TARGET_ASSET
. O

An O
adversary O
may O
attempt O
to O
deny O
process O
control B-TARGET_ASSET
access O
to O
cause O
a O
temporary O
loss O
of O
communication O
with O
the O
control B-TARGET_ASSET
device I-TARGET_ASSET
or O
to O
prevent O
operator O
adjustment O
of O
process O
controls B-TARGET_ASSET
. O

An O
affected O
process O
may O
still O
be O
operating O
during O
the O
period O
of O
control O
loss O
, O
but O
not O
necessarily O
in O
a O
desired O
state O
. O

( O
Citation O
: O
Corero O
) O

( O
Citation O
: O
Michael O
J. O
Assante O
and O
Robert O
M. O
Lee O
) O

( O
Citation O
: O
Tyson O
Macaulay O
) O

In O
the O
2017 O
Dallas O
Siren O
incident O
operators O
were O
unable O
to O
disable O
the O
false O
alarms O
from O
the O
Office O
of O
Emergency O
Management O
headquarters B-TARGET_ASSET
. O

( O
Citation O
: O
Mark O
Loveless O
April O
2017 O
) O

Adversaries O
may O
modify O
alarm B-TARGET_ASSET
settings B-TARGET_ASSET
to O
prevent O
alerts O
that O
may O
inform O
operators O
of O
their O
presence O
or O
to O
prevent O
responses O
to O
dangerous O
and O
unintended O
scenarios O
. O

Reporting B-TARGET_ASSET
messages I-TARGET_ASSET
are O
a O
standard O
part O
of O
data O
acquisition O
in O
control B-TARGET_ASSET
systems I-TARGET_ASSET
. O

Reporting B-TARGET_ASSET
messages I-TARGET_ASSET
are O
used O
as O
a O
way O
to O
transmit O
system O
state O
information O
and O
acknowledgements O
that O
specific O
actions O
have O
occurred O
. O

These O
messages O
provide O
vital O
information O
for O
the O
management O
of O
a O
physical O
process O
, O
and O
keep O
operators O
, O
engineers O
, O
and O
administrators O
aware O
of O
the O
state O
of O
system B-TARGET_ASSET
devices I-TARGET_ASSET
and O
physical O
processes O
. O

If O
an O
adversary O
is O
able O
to O
change O
the O
reporting B-TARGET_ASSET
settings I-TARGET_ASSET
, O
certain O
events O
could O
be O
prevented O
from O
being O
reported O
. O

This O
type O
of O
modification O
can O
also O
prevent O
operators O
or O
devices B-TARGET_ASSET
from O
performing O
actions O
to O
keep O
the O
system B-TARGET_ASSET
in O
a O
safe O
state O
. O

If O
critical O
reporting O
messages O
cannot O
trigger O
these O
actions O
then O
a O
[ O
Impact O
] O
( O
https://attack.mitre.org/tactics/TA0105 O
) O
could O
occur O
. O

In O
ICS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
the O
adversary O
may O
have O
to O
use O
[ O
Alarm O
Suppression O
] O
( O
https://attack.mitre.org/techniques/T0878 O
) O
or O
contend O
with O
multiple O
alarms B-TARGET_ASSET
and/or O
alarm O
propagation O
to O
achieve O
a O
specific O
goal O
to O
evade O
detection O
or O
prevent O
intended O
responses O
from O
occurring O
. O

( O
Citation O
: O
Jos O
Wetzels O
, O
Marina O
Krotofil O
2019 O
) O

Methods O
of O
suppression O
often O
rely O
on O
modification O
of O
alarm B-TARGET_ASSET
settings I-TARGET_ASSET
, O
such O
as O
modifying O
in O
memory O
code O
to O
fixed O
values O
or O
tampering O
with O
assembly O
level O
instruction O
code O
. O

Adversaries O
may O
communicate O
over O
a O
commonly B-PRECON
used I-PRECON
port B-TARGET_ASSET
to O
bypass O
firewalls B-TARGET_ASSET
or O
network B-TARGET_ASSET
detection I-TARGET_ASSET
systems I-TARGET_ASSET
and O
to O
blend O
in O
with O
normal O
network B-TARGET_ASSET
activity O
, O
to O
avoid O
more O
detailed O
inspection O
. O

They O
may O
use O
the O
protocol B-TARGET_ASSET
associated O
with O
the O
port B-TARGET_ASSET
, O
or O
a O
completely O
different O
protocol B-TARGET_ASSET
. O

They O
may O
use O
commonly B-PRECON
open I-PRECON
ports B-TARGET_ASSET
, O
such O
as O
the O
examples O
provided O
below O
. O

* O
TCP:80 B-TARGET_ASSET
( O
HTTP B-TARGET_ASSET
) O
* O
TCP:443 B-TARGET_ASSET
( O
HTTPS B-TARGET_ASSET
) O
* O
TCP/UDP:53 B-TARGET_ASSET
( O
DNS B-TARGET_ASSET
) O
* O
TCP:1024-4999 B-TARGET_ASSET
( O
OPC B-TARGET_ASSET
on O
XP/Win2k3 O
) O
* O
TCP:49152-65535 B-TARGET_ASSET
( O
OPC B-TARGET_ASSET
on O
Vista O
and O
later O
) O
* O
TCP:23 B-TARGET_ASSET
( O
TELNET B-TARGET_ASSET
) O
* O
UDP:161 B-TARGET_ASSET
( O
SNMP B-TARGET_ASSET
) O
* O
TCP:502 B-TARGET_ASSET
( O
MODBUS B-TARGET_ASSET
) O
* O
TCP:102 B-TARGET_ASSET
( O
S7comm/ISO-TSAP B-TARGET_ASSET
) O
* O
TCP:20000 B-TARGET_ASSET
( O
DNP3 B-TARGET_ASSET
) O
* O
TCP:44818 B-TARGET_ASSET
( O
Ethernet/IP B-TARGET_ASSET
) O

Adversaries O
may O
attempt O
to O
infect O
project B-TARGET_ASSET
files I-TARGET_ASSET
with O
malicious O
code O
. O

These O
project B-TARGET_ASSET
files I-TARGET_ASSET
may O
consist O
of O
objects O
, O
program O
organization O
units O
, O
variables O
such O
as O
tags O
, O
documentation O
, O
and O
other O
configurations O
needed O
for O
PLC B-TARGET_ASSET
programs I-TARGET_ASSET
to O
function O
. O

( O
Citation O
: O
Beckhoff O
) O

Using O
built O
in O
functions O
of O
the O
engineering B-TARGET_ASSET
software I-TARGET_ASSET
, O
adversaries O
may O
be O
able O
to O
download O
an O
infected B-PRECON
program B-TARGET_ASSET
to O
a O
PLC B-TARGET_ASSET
in O
the O
operating O
environment O
enabling O
further O
[ O
Execution O
] O
( O
https://attack.mitre.org/tactics/TA0104 O
) O
and O
[ O
Persistence O
] O
( O
https://attack.mitre.org/tactics/TA0110 O
) O
techniques O
. O

( O
Citation O
: O
PLCdev O
) O

Adversaries O
may O
export O
their O
own O
code O
into O
project B-TARGET_ASSET
files I-TARGET_ASSET
with O
conditions O
to O
execute O
at O
specific O
intervals O
. O

( O
Citation O
: O
Nicolas O
Falliere O
, O
Liam O
O O
Murchu O
, O
Eric O
Chien O
February O
2011 O
) O

Malicious O
programs B-TARGET_ASSET
allow O
adversaries O
control O
of O
all O
aspects O
of O
the O
process O
enabled O
by O
the O
PLC B-TARGET_ASSET
. O

Once O
the O
project B-TARGET_ASSET
file I-TARGET_ASSET
is O
downloaded O
to O
a O
PLC B-TARGET_ASSET
the O
workstation B-TARGET_ASSET
device I-TARGET_ASSET
may O
be O
disconnected O
with O
the O
infected B-PRECON
project B-TARGET_ASSET
file I-TARGET_ASSET
still O
executing O
. O

( O
Citation O
: O
PLCdev O
) O

Adversaries O
may O
perform O
network B-TARGET_ASSET
connection I-TARGET_ASSET
enumeration I-TARGET_ASSET
to O
discover O
information O
about O
device B-TARGET_ASSET
communication O
patterns O
. O

If O
an O
adversary O
can O
inspect O
the O
state O
of O
a O
network B-TARGET_ASSET
connection I-TARGET_ASSET
with O
tools B-TARGET_ASSET
, O
such O
as O
Netstat(Citation B-TARGET_ASSET
: O
Netstat) O
, O
in O
conjunction O
with O
[ O
System B-TARGET_ASSET
Firmware I-TARGET_ASSET
] O
( O
https://attack.mitre.org/techniques/T0857 O
) O
, O
then O
they O
can O
determine O
the O
role O
of O
certain O
devices B-TARGET_ASSET
on O
the O
network B-TARGET_ASSET
( O
Citation O
: O
MITRE O
) O
. O

The O
adversary O
can O
also O
use O
[ O
Network O
Sniffing O
] O
( O
https://attack.mitre.org/techniques/T0842 O
) O
to O
watch O
network B-TARGET_ASSET
traffic I-TARGET_ASSET
for O
details O
about O
the O
source O
, O
destination O
, O
protocol B-TARGET_ASSET
, O
and O
content O
. O

Adversaries O
may O
transfer O
tools B-TARGET_ASSET
or O
other O
files B-TARGET_ASSET
from O
one O
system B-TARGET_ASSET
to O
another O
system B-TARGET_ASSET
to O
stage O
adversary O
tools B-TARGET_ASSET
or O
other O
files B-TARGET_ASSET
over O
the O
course O
of O
an O
operation O
. O

( O
Citation O
: O
Enterprise O
ATT O
& O
CK O
) O

Copying O
of O
files B-TARGET_ASSET
may O
also O
be O
performed O
laterally O
between O
internal O
victim O
systems B-TARGET_ASSET
to O
support O
Lateral O
Movement O
with O
remote O
Execution O
using O
inherent B-PRECON
file I-PRECON
sharing I-PRECON
protocols B-TARGET_ASSET
such O
as O
file O
sharing O
over O
SMB B-TARGET_ASSET
to O
connected O
network B-TARGET_ASSET
shares I-TARGET_ASSET
. O

( O
Citation O
: O
Enterprise O
ATT O
& O
CK O
) O

In O
control B-TARGET_ASSET
systems I-TARGET_ASSET
environments I-TARGET_ASSET
, O
malware B-TARGET_ASSET
may O
use O
SMB B-TARGET_ASSET
and O
other O
file B-TARGET_ASSET
sharing I-TARGET_ASSET
protocols I-TARGET_ASSET
to O
move O
laterally O
through O
industrial B-TARGET_ASSET
networks I-TARGET_ASSET
. O

Adversaries O
may O
install O
malicious B-PRECON
or I-PRECON
vulnerable I-PRECON
firmware B-TARGET_ASSET
onto O
modular B-TARGET_ASSET
hardware I-TARGET_ASSET
devices I-TARGET_ASSET
. O

Control B-TARGET_ASSET
system I-TARGET_ASSET
devices I-TARGET_ASSET
often O
contain O
modular B-PRECON
hardware I-PRECON
devices B-TARGET_ASSET
. O

These O
devices B-TARGET_ASSET
may O
have O
their O
own O
set O
of O
firmware B-TARGET_ASSET
that O
is O
separate B-PRECON
from I-PRECON
the I-PRECON
firmware B-TARGET_ASSET
of I-PRECON
the I-PRECON
main I-PRECON
control I-PRECON
system B-TARGET_ASSET
equipment I-PRECON
. O

This O
technique O
is O
similar O
to O
[ O
System B-TARGET_ASSET
Firmware I-TARGET_ASSET
] O
( O
https://attack.mitre.org/techniques/T0857 O
) O
, O
but O
is O
conducted O
on O
other O
system B-TARGET_ASSET
components I-TARGET_ASSET
that O
may O
not O
have O
the O
same O
capabilities O
or O
level O
of O
integrity O
checking O
. O

Although O
it O
results O
in O
a O
device B-TARGET_ASSET
re-image O
, O
malicious O
device B-TARGET_ASSET
firmware I-TARGET_ASSET
may O
provide O
persistent O
access O
to O
remaining O
devices B-TARGET_ASSET
. O

( O
Citation O
: O
Daniel O
Peck O
, O
Dale O
Peterson O
January O
2009 O
) O

An O
easy O
point O
of O
access O
for O
an O
adversary O
is O
the O
Ethernet B-TARGET_ASSET
card I-TARGET_ASSET
, O
which O
may O
have O
its O
own O
CPU B-TARGET_ASSET
, O
RAM B-TARGET_ASSET
, O
and O
operating B-TARGET_ASSET
system I-TARGET_ASSET
. O

The O
adversary O
may O
attack O
and O
likely O
exploit O
the O
computer B-TARGET_ASSET
on O
an O
Ethernet B-TARGET_ASSET
card I-TARGET_ASSET
. O

Exploitation O
of O
the O
Ethernet B-TARGET_ASSET
card I-TARGET_ASSET
computer I-TARGET_ASSET
may O
enable O
the O
adversary O
to O
accomplish O
additional O
attacks O
, O
such O
as O
the O
following O
: O

( O
Citation O
: O
Daniel O
Peck O
, O
Dale O
Peterson O
January O
2009 O
) O
* O
Delayed O
Attack O
- O
The O
adversary O
may O
stage O
an O
attack O
in O
advance O
and O
choose O
when O
to O
launch O
it O
, O
such O
as O
at O
a O
particularly O
damaging O
time O
. O

* O
Brick O
the O
Ethernet O
Card O
- O
Malicious O
firmware O
may O
be O
programmed O
to O
result O
in O
an O
Ethernet O
card O
failure O
, O
requiring O
a O
factory O
return O
. O

* O
Random O
Attack O
or O
Failure O
- O
The O
adversary O
may O
load O
malicious O
firmware O
onto O
multiple O
field O
devices O
. O

Execution O
of O
an O
attack O
and O
the O
time O
it O
occurs O
is O
generated O
by O
a O
pseudo-random O
number O
generator O
. O

* O
A O
Field O
Device O
Worm O
- O
The O
adversary O
may O
choose O
to O
identify O
all O
field O
devices O
of O
the O
same O
model O
, O
with O
the O
end O
goal O
of O
performing O
a O
device-wide O
compromise O
. O

* O
Attack O
Other O
Cards O
on O
the O
Field O
Device O
- O
Although O
it O
is O
not O
the O
most O
important O
module O
in O
a O
field O
device O
, O
the O
Ethernet O
card O
is O
most O
accessible O
to O
the O
adversary O
and O
malware O
. O

Compromise O
of O
the O
Ethernet O
card O
may O
provide O
a O
more O
direct O
route O
to O
compromising O
other O
modules O
, O
such O
as O
the O
CPU O
module O
. O

Adversaries O
may O
gain O
access O
into O
industrial O
environments O
through O
systems B-TARGET_ASSET
exposed B-PRECON
directly I-PRECON
to I-PRECON
the I-PRECON
internet I-PRECON
for O
remote O
access O
rather O
than O
through O
[ O
External O
Remote O
Services B-TARGET_ASSET
] O
( O
https://attack.mitre.org/techniques/T0822 O
) O
. O

Internet B-TARGET_ASSET
Accessible I-TARGET_ASSET
Devices I-TARGET_ASSET
are O
exposed B-PRECON
to I-PRECON
the I-PRECON
internet I-PRECON
unintentionally B-PRECON
or O
intentionally B-PRECON
without I-PRECON
adequate I-PRECON
protections I-PRECON
. O

This O
may O
allow O
for O
adversaries O
to O
move O
directly O
into O
the O
control B-TARGET_ASSET
system I-TARGET_ASSET
network I-TARGET_ASSET
. O

Access O
onto O
these O
devices B-TARGET_ASSET
is O
accomplished O
without O
the O
use O
of O
exploits O
, O
these O
would O
be O
represented O
within O
the O
[ O
Exploit O
Public-Facing O
Application B-TARGET_ASSET
] O
( O
https://attack.mitre.org/techniques/T0819 O
) O
technique O
. O

Adversaries O
may O
leverage O
built B-PRECON
in I-PRECON
functions I-PRECON
for O
remote O
access O
which O
may O
not O
be O
protected B-PRECON
or O
utilize O
minimal B-PRECON
legacy I-PRECON
protections I-PRECON
that O
may O
be O
targeted O
. O

( O
Citation O
: O
NCCIC O
January O
2014 O
) O

These O
services B-TARGET_ASSET
may O
be O
discoverable O
through O
the O
use O
of O
online O
scanning O
tools B-TARGET_ASSET
. O

In O
the O
case O
of O
the O
Bowman O
dam O
incident O
, O
adversaries O
leveraged O
access O
to O
the O
dam O
control B-TARGET_ASSET
network I-TARGET_ASSET
through O
a O
cellular B-TARGET_ASSET
modem I-TARGET_ASSET
. O

Access O
to O
the O
device B-TARGET_ASSET
was O
protected B-PRECON
by I-PRECON
password I-PRECON
authentication I-PRECON
, O
although O
the O
application B-TARGET_ASSET
was O
vulnerable B-PRECON
to I-PRECON
brute I-PRECON
forcing I-PRECON
. O

( O
Citation O
: O
NCCIC O
January O
2014 O
) O

( O
Citation O
: O
Danny O
Yadron O
December O
2015 O
) O

( O
Citation O
: O
Mark O
Thompson O
March O
2016 O
) O

In O
Trend O
Micros O
manufacturing O
deception O
operations O
adversaries O
were O
detected O
leveraging O
direct B-PRECON
internet I-PRECON
access I-PRECON
to O
an O
ICS B-TARGET_ASSET
environment I-TARGET_ASSET
through O
the O
exposure B-PRECON
of O
operational O
protocols B-TARGET_ASSET
such O
as O
Siemens O
S7 B-TARGET_ASSET
, O
Omron O
FINS B-TARGET_ASSET
, O
and O
EtherNet/IP B-TARGET_ASSET
, O
in O
addition O
to O
misconfigured B-PRECON
VNC I-PRECON
access I-PRECON
. O

( O
Citation O
: O
Stephen O
Hilt O
, O
Federico O
Maggi O
, O
Charles O
Perine O
, O
Lord O
Remorin O
, O
Martin O
Rsler O
, O
and O
Rainer O
Vosseler O
) O

Adversaries O
may O
target O
and O
collect O
data O
from O
local B-TARGET_ASSET
system I-TARGET_ASSET
sources I-TARGET_ASSET
, O
such O
as O
file B-TARGET_ASSET
systems I-TARGET_ASSET
, O
configuration B-TARGET_ASSET
files I-TARGET_ASSET
, O
or O
local O
databases B-TARGET_ASSET
. O

This O
can O
include O
sensitive O
data O
such O
as O
specifications O
, O
schematics O
, O
or O
diagrams O
of O
control O
system O
layouts O
, O
devices O
, O
and O
processes O
. O

Adversaries O
may O
do O
this O
using O
[ O
Command-Line B-TARGET_ASSET
Interface I-TARGET_ASSET
] O
( O
https://attack.mitre.org/techniques/T0807 O
) O
or O
[ O
Scripting B-TARGET_ASSET
] O
( O
https://attack.mitre.org/techniques/T0853 O
) O
techniques O
to O
interact O
with O
the O
file B-TARGET_ASSET
system I-TARGET_ASSET
to O
gather O
information O
. O

Adversaries O
may O
also O
use O
[ O
Automated O
Collection O
] O
( O
https://attack.mitre.org/techniques/T0802 O
) O
on O
the O
local O
system B-TARGET_ASSET
. O

Adversaries O
may O
modify O
or O
add O
a O
program B-TARGET_ASSET
on O
a O
controller B-TARGET_ASSET
to O
affect O
how O
it O
interacts O
with O
the O
physical O
process O
, O
peripheral O
devices B-TARGET_ASSET
and O
other O
hosts B-TARGET_ASSET
on O
the O
network B-TARGET_ASSET
. O

Modification O
to O
controller B-TARGET_ASSET
programs I-TARGET_ASSET
can O
be O
accomplished O
using O
a O
Program O
Download O
in O
addition O
to O
other O
types O
of O
program B-TARGET_ASSET
modification I-TARGET_ASSET
such O
as O
online O
edit O
and O
program O
append O
. O

Program B-TARGET_ASSET
modification I-TARGET_ASSET
encompasses O
the O
addition O
and O
modification O
of O
instructions O
and O
logic O
contained O
in O
Program B-TARGET_ASSET
Organization I-TARGET_ASSET
Units I-TARGET_ASSET
( O
POU O
) O
( O
Citation O
: O
IEC O
February O
2013 O
) O
and O
similar O
programming O
elements O
found O
on O
controllers B-TARGET_ASSET
. O

This O
can O
include O
, O
for O
example O
, O
adding O
new O
functions O
to O
a O
controller B-TARGET_ASSET
, O
modifying O
the O
logic O
in O
existing O
functions O
and O
making O
new O
calls O
from O
one O
function O
to O
another O
. O

Some O
programs B-TARGET_ASSET
may O
allow O
an O
adversary O
to O
interact O
directly O
with O
the O
native B-PRECON
API B-TARGET_ASSET
of O
the O
controller B-TARGET_ASSET
to O
take O
advantage O
of O
obscure O
features O
or O
vulnerabilities O
. O

Adversaries O
may O
modify O
software B-TARGET_ASSET
and I-TARGET_ASSET
device I-TARGET_ASSET
credentials B-TARGET_ASSET
to O
prevent O
operator O
and O
responder O
access O
. O

Depending O
on O
the O
device B-TARGET_ASSET
, O
the O
modification O
or O
addition O
of O
this O
password O
could O
prevent O
any O
device B-TARGET_ASSET
configuration I-TARGET_ASSET
actions O
from O
being O
accomplished O
and O
may O
require O
a O
factory O
reset O
or O
replacement O
of O
hardware B-TARGET_ASSET
. O

These O
credentials B-TARGET_ASSET
are O
often O
built-in B-PRECON
features I-PRECON
provided O
by O
the O
device B-TARGET_ASSET
vendors O
as O
a O
means O
to O
restrict O
access O
to O
management B-TARGET_ASSET
interfaces I-TARGET_ASSET
. O

An O
adversary O
with O
access O
to O
valid B-PRECON
or O
hardcoded B-PRECON
credentials B-TARGET_ASSET
could O
change O
the O
credential B-TARGET_ASSET
to O
prevent O
future O
authorized O
device B-TARGET_ASSET
access O
. O

Change O
Credential O
may O
be O
especially O
damaging O
when O
paired O
with O
other O
techniques O
such O
as O
Modify O
Program O
, O
Data O
Destruction O
, O
or O
Modify O
Controller O
Tasking O
. O

In O
these O
cases O
, O
a O
device B-TARGET_ASSET
s O
configuration B-TARGET_ASSET
may O
be O
destroyed O
or O
include O
malicious O
actions O
for O
the O
process O
environment O
, O
which O
cannot O
not O
be O
removed O
through O
normal O
device B-TARGET_ASSET
configuration I-TARGET_ASSET
actions O
. O

Additionally O
, O
recovery O
of O
the O
device B-TARGET_ASSET
and O
original O
configuration O
may O
be O
difficult O
depending O
on O
the O
features O
provided O
by O
the O
device B-TARGET_ASSET
. O

In O
some O
cases O
, O
these O
passwords O
cannot O
be O
removed O
onsite O
and O
may O
require O
that O
the O
device B-TARGET_ASSET
be O
sent O
back O
to O
the O
vendor O
for O
additional O
recovery O
steps O
. O

A O
chain O
of O
incidents O
occurred O
in O
Germany O
, O
where O
adversaries O
locked O
operators O
out O
of O
their O
building B-TARGET_ASSET
automation I-TARGET_ASSET
system I-TARGET_ASSET
( I-TARGET_ASSET
BAS I-TARGET_ASSET
) O
controllers B-TARGET_ASSET
by O
enabling O
a O
previously B-PRECON
unset I-PRECON
BCU I-PRECON
key I-PRECON
. O

( O
Citation O
: O
German O
BAS O
Lockout O
Dec O
2021 O
) O

Adversaries O
may O
abuse O
Windows B-TARGET_ASSET
Management I-TARGET_ASSET
Instrumentation I-TARGET_ASSET
( I-TARGET_ASSET
WMI I-TARGET_ASSET
) I-TARGET_ASSET
to O
execute O
malicious O
commands O
and O
payloads O
. O
WMI B-TARGET_ASSET
is O
designed O
for O
programmers O
and O
is O
the O
infrastructure O
for O
management O
data O
and O
operations O
on O
Windows B-TARGET_ASSET
systems I-TARGET_ASSET
. O
(Citation: O
WMI O
1-3) O
WMI B-TARGET_ASSET
is O
an O
administration O
feature O
that O
provides O
a O
uniform O
environment O
to O
access O
Windows B-TARGET_ASSET
system I-TARGET_ASSET
components I-TARGET_ASSET
. O

The O
WMI B-TARGET_ASSET
service I-TARGET_ASSET
enables O
both O
local O
and O
remote O
access O
, O
though O
the O
latter O
is O
facilitated O
by O
[Remote B-TARGET_ASSET
Services](https://attack.mitre.org/techniques/T1021) I-TARGET_ASSET
such O
as O
[Distributed B-TARGET_ASSET
Component I-TARGET_ASSET
Object I-TARGET_ASSET
Model](https://attack.mitre.org/techniques/T1021/003) I-TARGET_ASSET
and O
[Windows B-TARGET_ASSET
Remote I-TARGET_ASSET
Management](https://attack.mitre.org/techniques/T1021/006) I-TARGET_ASSET
. O
(Citation: O
WMI O
1-3) O
Remote O
WMI B-TARGET_ASSET
over O
DCOM B-TARGET_ASSET
operates O
using O
port B-TARGET_ASSET
135 O
, O
whereas O
WMI B-TARGET_ASSET
over O
WinRM B-TARGET_ASSET
operates O
over O
port B-TARGET_ASSET
5985 O
when O
using O
HTTP O
and O
5986 O
for O
HTTPS O
. O
(Citation: O
WMI O
1-3) O
(Citation: O
Mandiant O
WMI) O

An O
adversary O
can O
use O
WMI B-TARGET_ASSET
to O
interact O
with O
local O
and O
remote O
systems B-TARGET_ASSET
and O
use O
it O
as O
a O
means O
to O
execute O
various O
behaviors O
, O
such O
as O
gathering O
information O
for O
[Discovery](https://attack.mitre.org/tactics/TA0007) O
as O
well O
as O
[Execution](https://attack.mitre.org/tactics/TA0002) O
of O
commands O
and O
payloads O
. O
(Citation: O
Mandiant O
WMI) O
For O
example O
, O
`wmic.exe` B-TARGET_ASSET
can O
be O
abused O
by O
an O
adversary O
to O
delete O
shadow B-TARGET_ASSET
copies I-TARGET_ASSET
with O
the O
command O
`wmic.exe O
Shadowcopy O
Delete` O
(i.e. O
[Inhibit O
System O
Recovery](https://attack.mitre.org/techniques/T1490)) O
. O
(Citation: O
WMI O
6) O

**Note:** O
`wmic.exe` B-TARGET_ASSET
is O
deprecated B-PRECON
as O
of O
January O
of O
2024 O
, O
with O
the O
WMIC B-TARGET_ASSET
feature I-TARGET_ASSET
being O
“disabled B-PRECON
by I-PRECON
default” I-PRECON
on O
Windows O
11+ O
. O
WMIC B-TARGET_ASSET
will O
be O
removed O
from O
subsequent O
Windows O
releases O
and O
replaced O
by O
[PowerShell](https://attack.mitre.org/techniques/T1059/001) B-TARGET_ASSET
as O
the O
primary O
WMI B-TARGET_ASSET
interface I-TARGET_ASSET
. O
(Citation: O
WMI O
7,8) O
In O
addition O
to O
PowerShell B-TARGET_ASSET
and O
tools B-TARGET_ASSET
like O
`wbemtool.exe` B-TARGET_ASSET
, O
COM B-TARGET_ASSET
APIs I-TARGET_ASSET
can O
also O
be O
used O
to O
programmatically O
interact O
with O
WMI B-TARGET_ASSET
via O
C++ O
, O
.NET O
, O
VBScript O
, O
etc.(Citation: O
WMI O
7,8) O

Adversaries O
may O
establish O
persistence O
through O
executing O
malicious O
commands O
triggered O
by O
a O
user’s O
shell B-TARGET_ASSET
. O
User O
shells B-TARGET_ASSET
execute O
several O
configuration B-TARGET_ASSET
scripts I-TARGET_ASSET
at O
different O
points O
throughout O
the O
session O
based O
on O
events O
. O
For O
example O
, O
when O
a O
user O
opens O
a O
command O
line O
interface O
or O
remotely O
logs O
in O
(such O
as O
SSH) O
a O
login B-TARGET_ASSET
shell I-TARGET_ASSET
is O
initiated O
. O
The O
login B-TARGET_ASSET
shell I-TARGET_ASSET
executes O
scripts B-TARGET_ASSET
from O
the O
system O
(/etc) O
and O
the O
user’s O
home O
directory O
(~/ O
) O
to O
configure O
the O
environment O
. O
All O
login B-TARGET_ASSET
shells I-TARGET_ASSET
on O
a O
system B-TARGET_ASSET
use O
<code>/etc/profile</code> B-TARGET_ASSET
when O
initiated O
. O
These O
configuration B-TARGET_ASSET
scripts I-TARGET_ASSET
run O
at O
the O
permission O
level O
of O
their O
directory O
and O
are O
often O
used O
to O
set O
environment O
variables O
, O
create O
aliases O
, O
and O
customize O
the O
user’s O
environment O
. O
When O
the O
shell B-TARGET_ASSET
exits O
or O
terminates O
, O
additional O
shell B-TARGET_ASSET
scripts I-TARGET_ASSET
are O
executed O
to O
ensure O
the O
shell B-TARGET_ASSET
exits O
appropriately O
. O

Adversaries O
may O
attempt O
to O
establish O
persistence O
by O
inserting O
commands O
into O
scripts B-TARGET_ASSET
automatically B-PRECON
executed I-PRECON
by I-PRECON
shells B-TARGET_ASSET
. O
Using O
bash O
as O
an O
example O
, O
the O
default O
shell B-TARGET_ASSET
for O
most O
GNU/Linux O
systems O
, O
adversaries O
may O
add O
commands O
that O
launch O
malicious O
binaries O
into O
the O
<code>/etc/profile</code> B-TARGET_ASSET
and O
<code>/etc/profile.d</code> B-TARGET_ASSET
files I-TARGET_ASSET
(Citation: O
intezer-kaiji-malware) O
. O
These O
files B-TARGET_ASSET
require B-PRECON
root I-PRECON
permissions I-PRECON
and O
are O
executed O
each O
time O
any O
shell B-TARGET_ASSET
on O
a O
system B-TARGET_ASSET
launches O
. O
For O
user O
level O
permissions O
, O
adversaries O
can O
insert O
malicious O
commands O
into O
<code>~/.bash_profile</code> B-TARGET_ASSET
, O
<code>~/.bash_login</code> B-TARGET_ASSET
, O
or O
<code>~/.profile</code> B-TARGET_ASSET
(Rocke) O
which O
are O
sourced O
when O
a O
user O
opens O
a O
command O
line O
interface O
or O
connects O
remotely O
. O
Adversaries O
often O
use O
~/.bash_profile B-TARGET_ASSET
since O
the O
system O
only O
executes O
the O
first O
file B-TARGET_ASSET
that O
exists O
in O
the O
listed O
order O
. O
Adversaries O
have O
also O
leveraged O
the O
<code>~/.bashrc</code> B-TARGET_ASSET
file I-TARGET_ASSET
(Tsunami, O
Rocke, O
Linux O
Rabbit, O
Magento) O
which O
is O
additionally O
executed O
if O
the O
connection O
is O
established O
remotely O
or O
an O
additional O
interactive O
shell B-TARGET_ASSET
is O
opened O
, O
such O
as O
a O
new O
tab O
in O
the O
command O
line O
interface O
. O
Some O
malware O
targets O
the O
termination O
of O
a O
program O
to O
trigger O
execution O
(Cannon) O
, O
adversaries O
can O
use O
the O
<code>~/.bash_logout</code> B-TARGET_ASSET
file I-TARGET_ASSET
to O
execute O
malicious O
commands O
at O
the O
end O
of O
a O
session(Pearl_shellbot) O
. O

For O
macOS O
, O
the O
functionality O
of O
this O
technique O
is O
similar O
but O
leverages O
zsh B-TARGET_ASSET
, O
the O
default B-PRECON
shell B-TARGET_ASSET
for O
macOS O
10.15+ O
. O
When O
the O
Terminal.app B-TARGET_ASSET
is O
opened O
, O
the O
application B-TARGET_ASSET
launches O
a O
zsh B-TARGET_ASSET
login I-TARGET_ASSET
shell I-TARGET_ASSET
and O
a O
zsh B-TARGET_ASSET
interactive I-TARGET_ASSET
shell I-TARGET_ASSET
. O
The O
login B-TARGET_ASSET
shell I-TARGET_ASSET
configures O
the O
system O
environment O
using O
<code>/etc/profile</code> B-TARGET_ASSET
, O
<code>/etc/zshenv</code> B-TARGET_ASSET
, O
<code>/etc/zprofile</code> B-TARGET_ASSET
, O
and O
<code>/etc/zlogin</code> B-TARGET_ASSET
. O
The O
login B-TARGET_ASSET
shell I-TARGET_ASSET
then O
configures O
the O
user O
environment O
with O
<code>~/.zprofile</code> B-TARGET_ASSET
and O
<code>~/.zlogin</code> B-TARGET_ASSET
. O
The O
interactive B-TARGET_ASSET
shell I-TARGET_ASSET
uses O
the O
<code>~/.zshrc<code> O
to O
configure O
the O
user O
environment O
. O
Upon O
exiting O
, O
<code>/etc/zlogout</code> B-TARGET_ASSET
and O
<code>~/.zlogout</code> B-TARGET_ASSET
are O
executed O
. O
For O
legacy O
programs O
, O
macOS O
executes O
<code>/etc/bashrc</code> B-TARGET_ASSET
on O
startup O
. O

Adversaries O
may O
attempt O
to O
take O
screen B-TARGET_ASSET
captures I-TARGET_ASSET
of O
the O
desktop B-TARGET_ASSET
to O
gather O
information O
over O
the O
course O
of O
an O
operation O
. O
Screen O
capturing O
functionality O
may O
be O
included O
as O
a O
feature O
of O
a O
remote O
access O
tool O
used O
in O
post-compromise O
operations O
. O
Taking O
a O
screenshot O
is O
also O
typically O
possible O
through O
native O
utilities B-TARGET_ASSET
or O
API B-TARGET_ASSET
calls I-TARGET_ASSET
, O
such O
as O
<code>CopyFromScreen</code> O
, O
<code>xwd</code> O
, O
or O
<code>screencapture</code> O
. O
(Citation: O
CopyFromScreen O
.NET)(Citation: O
Antiquated O
Mac O
Malware) O

