Encrypting O
and/or O
encoding O
file B-TARGET_ASSET
content I-TARGET_ASSET
aims O
to O
conceal O
malicious O
artifacts O
within O
a O
file B-TARGET_ASSET
used O
in O
an O
intrusion O
. O 

Many O
other O
techniques O
, O
such O
as O
[Software B-TARGET_ASSET
Packing](https://attack.mitre.org/techniques/T1027/002) I-TARGET_ASSET
, O
[Steganography](https://attack.mitre.org/techniques/T1027/003) O
, O
and O
[Embedded B-TARGET_ASSET
Payloads](https://attack.mitre.org/techniques/T1027/009) I-TARGET_ASSET
, O
share O
this O
same O
broad O
objective O
. O 

Encrypting O
and/or O
encoding O
files B-TARGET_ASSET
could O
lead O
to O
a O
lapse O
in O
detection O
of O
static O
signatures O
, O
only O
for O
this O
malicious O
content O
to O
be O
revealed O
(i.e., O
[Deobfuscate/Decode O
Files O
or O
Information](https://attack.mitre.org/techniques/T1140)) O
at O
the O
time O
of O
execution/use O
. O 


This O
type O
of O
file O
obfuscation O
can O
be O
applied O
to O
many O
file B-TARGET_ASSET
artifacts I-TARGET_ASSET
present O
on O
victim O
hosts B-TARGET_ASSET
, O
such O
as O
malware B-TARGET_ASSET
log/configuration I-TARGET_ASSET
and O
payload B-TARGET_ASSET
files I-TARGET_ASSET
. O 

(Citation: O
File O
obfuscation) O
Files B-TARGET_ASSET
can O
be O
encrypted B-PRECON
with I-PRECON
a I-PRECON
hardcoded I-PRECON
or I-PRECON
user-supplied I-PRECON
key I-PRECON
, O
as O
well O
as O
otherwise O
obfuscated O
using O
standard O
encoding O
schemes O
such O
as O
Base64 O
. O 


The O
entire O
content O
of O
a O
file B-TARGET_ASSET
may O
be O
obfuscated B-PRECON
, O
or O
just O
specific O
functions O
or O
values O
(such O
as O
C2 O
addresses) O
. O 

Encryption O
and O
encoding O
may O
also O
be O
applied O
in O
redundant O
layers O
for O
additional O
protection O
. O 


For O
example O
, O
adversaries O
may O
abuse O
password-protected B-PRECON
Word B-TARGET_ASSET
documents I-TARGET_ASSET
or O
self-extracting B-TARGET_ASSET
( I-TARGET_ASSET
SFX I-TARGET_ASSET
) I-TARGET_ASSET
archives I-TARGET_ASSET
as O
a O
method O
of O
encrypting/encoding O
a O
file B-TARGET_ASSET
such O
as O
a O
[Phishing](https://attack.mitre.org/techniques/T1566) O
payload B-TARGET_ASSET
. O 

These O
files B-TARGET_ASSET
typically O
function O
by O
attaching O
the O
intended O
archived O
content O
to O
a O
decompressor B-TARGET_ASSET
stub I-TARGET_ASSET
that O
is O
executed O
when O
the O
file B-TARGET_ASSET
is O
invoked O
(e.g., O
[User O
Execution](https://attack.mitre.org/techniques/T1204)) O
. O 

(Citation: O
SFX O
- O
Encrypted/Encoded O
File) O

Adversaries O
may O
also O
abuse O
file-specific O
as O
well O
as O
custom O
encoding O
schemes O
. O 

For O
example O
, O
Byte O
Order O
Mark O
(BOM) O
headers B-TARGET_ASSET
in O
text B-TARGET_ASSET
files I-TARGET_ASSET
may O
be O
abused O
to O
manipulate O
and O
obfuscate O
file B-TARGET_ASSET
content I-TARGET_ASSET
until O
[Command B-TARGET_ASSET
and I-TARGET_ASSET
Scripting I-TARGET_ASSET
Interpreter](https://attack.mitre.org/techniques/T1059) I-TARGET_ASSET
execution O
. O 


Link-Local B-TARGET_ASSET
Multicast I-TARGET_ASSET
Name I-TARGET_ASSET
Resolution I-TARGET_ASSET
( I-TARGET_ASSET
LLMNR I-TARGET_ASSET
) I-TARGET_ASSET
and O
NetBIOS B-TARGET_ASSET
Name I-TARGET_ASSET
Service I-TARGET_ASSET
( I-TARGET_ASSET
NBT-NS I-TARGET_ASSET
) I-TARGET_ASSET
are O
Microsoft O
Windows O
components O
that O
serve O
as O
alternate O
methods O
of O
host O
identification O
. O 

LLMNR B-TARGET_ASSET
is O
based O
upon O
the O
Domain B-TARGET_ASSET
Name I-TARGET_ASSET
System I-TARGET_ASSET
( I-TARGET_ASSET
DNS I-TARGET_ASSET
) I-TARGET_ASSET
format O
and O
allows O
hosts B-TARGET_ASSET
on O
the O
same O
local O
link O
to O
perform O
name O
resolution O
for O
other O
hosts B-TARGET_ASSET
. O 

NBT-NS B-TARGET_ASSET
identifies O
systems B-TARGET_ASSET
on O
a O
local O
network O
by O
their O
NetBIOS O
name O
. O 

(Citation: O
Wikipedia O
LLMNR) O
(Citation: O
TechNet O
NetBIOS) O

Adversaries O
can O
spoof O
an O
authoritative O
source O
for O
name O
resolution O
on O
a O
victim O
network B-TARGET_ASSET
by O
responding O
to O
LLMNR B-TARGET_ASSET
(UDP O
5355)/NBT-NS B-TARGET_ASSET
(UDP O
137) O
traffic O
as O
if O
they O
know O
the O
identity O
of O
the O
requested O
host B-TARGET_ASSET
, O
effectively O
poisoning O
the O
service B-TARGET_ASSET
so O
that O
the O
victims O
will O
communicate O
with O
the O
adversary O
controlled O
system B-TARGET_ASSET
. O 

If O
the O
requested O
host B-TARGET_ASSET
belongs O
to O
a O
resource O
that O
requires O
identification/authentication O
, O
the O
username O
and O
NTLMv2 B-TARGET_ASSET
hash I-TARGET_ASSET
will O
then O
be O
sent O
to O
the O
adversary O
controlled O
system B-TARGET_ASSET
. O 

The O
adversary O
can O
then O
collect O
the O
hash B-TARGET_ASSET
information I-TARGET_ASSET
sent O
over O
the O
wire O
through O
tools B-TARGET_ASSET
that O
monitor O
the O
ports B-TARGET_ASSET
for O
traffic O
or O
through O
[Network B-TARGET_ASSET
Sniffing](https://attack.mitre.org/techniques/T1040) I-TARGET_ASSET
and O
crack O
the O
hashes B-TARGET_ASSET
offline O
through O
[Brute O
Force](https://attack.mitre.org/techniques/T1110) O
to O
obtain O
the O
plaintext O
passwords B-TARGET_ASSET
. O 

In O
some O
cases O
where O
an O
adversary O
has O
access O
to O
a O
system B-TARGET_ASSET
that O
is O
in O
the O
authentication O
path O
between O
systems O
or O
when O
automated O
scans O
that O
use O
credentials B-TARGET_ASSET
attempt O
to O
authenticate O
to O
an O
adversary O
controlled O
system B-TARGET_ASSET
, O
the O
NTLMv2 B-TARGET_ASSET
hashes I-TARGET_ASSET
can O
be O
intercepted O
and O
relayed O
to O
access O
and O
execute O
code O
against O
a O
target O
system B-TARGET_ASSET
. O 

The O
relay O
step O
can O
happen O
in O
conjunction O
with O
poisoning O
but O
may O
also O
be O
independent O
of O
it O
. O 

(Citation: O
byt3bl33d3r O
NTLM O
Relaying)(Citation: O
Secure O
Ideas O
SMB O
Relay) O

Several O
tools B-TARGET_ASSET
exist O
that O
can O
be O
used O
to O
poison O
name O
services B-TARGET_ASSET
within O
local O
networks B-TARGET_ASSET
such O
as O
NBNSpoof B-TARGET_ASSET
, O
Metasploit B-TARGET_ASSET
, O
and O
[Responder](https://attack.mitre.org/software/S0174) B-TARGET_ASSET
. O 

(Citation: O
GitHub O
NBNSpoof) O
(Citation: O
Rapid7 O
LLMNR O
Spoofer) O
(Citation: O
GitHub O
Responder) O

Adversaries O
may O
gather O
the O
victim's O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

Public O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
be O
allocated B-PRECON
to O
organizations O
by O
block O
, O
or O
a O
range O
of O
sequential O
addresses O
. O 

Information O
about O
assigned O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
include O
a O
variety O
of O
details O
, O
such O
as O
which O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
are O
in B-PRECON
use I-PRECON
. O 

IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
also O
enable O
an O
adversary O
to O
derive O
other O
details O
about O
a O
victim O
, O
such O
as O
organizational O
size O
, O
physical O
location(s) O
, O
Internet O
service O
provider O
, O
and O
or O
where/how O
their O
publicly-facing O
infrastructure B-TARGET_ASSET
is O
hosted B-PRECON
. O 


Adversaries O
may O
gather O
this O
information O
in O
various O
ways O
, O
such O
as O
direct O
collection O
actions O
via O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
. O 

Information O
about O
assigned O
IP B-TARGET_ASSET
addresses I-TARGET_ASSET
may O
also O
be O
exposed B-PRECON
to O
adversaries O
via O
online O
or O
other O
accessible O
data O
sets O
(ex: O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596)) O
. O 

(Citation: O
WHOIS)(Citation: O
DNS O
Dumpster)(Citation: O
Circl O
Passive O
DNS) O
Gathering O
this O
information O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593)) O
, O
establishing O
operational O
resources O
(ex: O
[Acquire O
Infrastructure](https://attack.mitre.org/techniques/T1583) O
or O
[Compromise O
Infrastructure](https://attack.mitre.org/techniques/T1584)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133)) O
. O 


Adversaries O
may O
attempt O
to O
cause O
a O
denial O
of O
service O
(DoS) O
by O
directly O
sending O
a O
high-volume O
of O
network O
traffic B-TARGET_ASSET
to O
a O
target O
. O 

This O
DoS O
attack O
may O
also O
reduce O
the O
availability O
and O
functionality O
of O
the O
targeted O
system(s) B-TARGET_ASSET
and O
network B-TARGET_ASSET
. O 

[Direct B-TARGET_ASSET
Network I-TARGET_ASSET
Flood](https://attack.mitre.org/techniques/T1498/001) I-TARGET_ASSET
s O
are O
when O
one O
or O
more O
systems B-TARGET_ASSET
are O
used O
to O
send O
a O
high-volume O
of O
network B-TARGET_ASSET
packets I-TARGET_ASSET
towards O
the O
targeted O
service's B-TARGET_ASSET
network I-TARGET_ASSET
. O 

Almost O
any O
network B-TARGET_ASSET
protocol I-TARGET_ASSET
may O
be O
used O
for O
flooding O
. O 

Stateless O
protocols B-TARGET_ASSET
such O
as O
UDP B-TARGET_ASSET
or O
ICMP B-TARGET_ASSET
are O
commonly O
used O
but O
stateful O
protocols B-TARGET_ASSET
such O
as O
TCP B-TARGET_ASSET
can O
be O
used O
as O
well O
. O 


Botnets B-TARGET_ASSET
are O
commonly O
used O
to O
conduct O
network B-TARGET_ASSET
flooding I-TARGET_ASSET
attacks I-TARGET_ASSET
against O
networks B-TARGET_ASSET
and O
services B-TARGET_ASSET
. O 

Large O
botnets B-TARGET_ASSET
can O
generate O
a O
significant O
amount O
of O
traffic O
from O
systems B-TARGET_ASSET
spread B-PRECON
across I-PRECON
the I-PRECON
global I-PRECON
Internet I-PRECON
. O 

Adversaries O
may O
have O
the O
resources O
to O
build O
out O
and O
control O
their O
own O
botnet B-TARGET_ASSET
infrastructure I-TARGET_ASSET
or O
may O
rent O
time O
on O
an O
existing O
botnet B-TARGET_ASSET
to O
conduct O
an O
attack O
. O 

In O
some O
of O
the O
worst O
cases O
for O
distributed O
DoS O
(DDoS) O
, O
so O
many O
systems B-TARGET_ASSET
are O
used O
to O
generate O
the O
flood O
that O
each O
one O
only O
needs O
to O
send O
out O
a O
small O
amount O
of O
traffic O
to O
produce O
enough O
volume O
to O
saturate O
the O
target O
network B-TARGET_ASSET
. O 

In O
such O
circumstances O
, O
distinguishing O
DDoS O
traffic O
from O
legitimate O
clients O
becomes O
exceedingly O
difficult O
. O 

Botnets B-TARGET_ASSET
have O
been O
used O
in O
some O
of O
the O
most O
high-profile O
DDoS O
flooding O
attacks O
, O
such O
as O
the O
2012 O
series O
of O
incidents O
that O
targeted O
major O
US O
banks O
. O 

(Citation: O
USNYAG O
IranianBotnet O
March O
2016) O

Adversaries O
may O
insert O
, O
delete O
, O
or O
manipulate O
data B-TARGET_ASSET
at B-PRECON
rest I-PRECON
in O
order O
to O
manipulate O
external O
outcomes O
or O
hide O
activity O
. O 

(Citation: O
FireEye O
APT38 O
Oct O
2018)(Citation: O
DOJ O
Lazarus O
Sony O
2018) O
By O
manipulating O
stored O
data B-TARGET_ASSET
, O
adversaries O
may O
attempt O
to O
affect O
a O
business O
process O
, O
organizational O
understanding O
, O
and O
decision O
making O
. O 


Stored O
data B-TARGET_ASSET
could O
include O
a O
variety O
of O
file B-TARGET_ASSET
formats I-TARGET_ASSET
, O
such O
as O
Office O
files B-TARGET_ASSET
, O
databases B-TARGET_ASSET
, O
stored O
emails B-TARGET_ASSET
, O
and O
custom O
file B-TARGET_ASSET
formats I-TARGET_ASSET
. O 

The O
type O
of O
modification O
and O
the O
impact O
it O
will O
have O
depends O
on O
the O
type O
of O
data O
as O
well O
as O
the O
goals O
and O
objectives O
of O
the O
adversary O
. O 

For O
complex O
systems O
, O
an O
adversary O
would O
likely O
need O
special O
expertise O
and O
possibly O
access O
to O
specialized O
software O
related O
to O
the O
system O
that O
would O
typically O
be O
gained O
through O
a O
prolonged O
information O
gathering O
campaign O
in O
order O
to O
have O
the O
desired O
impact O
. O 


Adversaries O
may O
execute O
their O
own O
malicious O
payloads B-TARGET_ASSET
by O
hijacking O
environment B-TARGET_ASSET
variables I-TARGET_ASSET
used O
to O
load O
libraries B-TARGET_ASSET
. O 

The O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
contains O
a O
list O
of O
directories O
(User O
and O
System) O
that O
the O
OS B-TARGET_ASSET
searches O
sequentially O
through O
in O
search O
of O
the O
binary B-TARGET_ASSET
that O
was O
called O
from O
a O
script O
or O
the O
command O
line O
. O 


Adversaries O
can O
place O
a O
malicious O
program B-TARGET_ASSET
in O
an O
earlier O
entry O
in O
the O
list O
of O
directories O
stored O
in O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
, O
resulting O
in O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
executing O
the O
malicious O
binary B-TARGET_ASSET
rather O
than O
the O
legitimate O
binary B-TARGET_ASSET
when O
it O
searches O
sequentially O
through O
that O
PATH O
listing O
. O 


For O
example O
, O
on O
Windows O
if O
an O
adversary O
places O
a O
malicious O
program B-TARGET_ASSET
named O
""net.exe"" O
in O
`C:\example O
path` O
, O
which O
by O
default B-PRECON
precedes I-PRECON
`C:\Windows\system32\net.exe` O
in O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
, O
when O
""net"" O
is O
executed O
from O
the O
command-line O
the O
`C:\example O
path` O
will O
be O
called O
instead O
of O
the O
system's O
legitimate O
executable B-TARGET_ASSET
at O
`C:\Windows\system32\net.exe` O
. O 

Some O
methods O
of O
executing O
a O
program B-TARGET_ASSET
rely O
on O
the O
PATH B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
to O
determine O
the O
locations O
that O
are O
searched O
when O
the O
path O
for O
the O
program B-TARGET_ASSET
is O
not O
given O
, O
such O
as O
executing O
programs B-TARGET_ASSET
from O
a O
[Command B-TARGET_ASSET
and I-TARGET_ASSET
Scripting I-TARGET_ASSET
Interpreter](https://attack.mitre.org/techniques/T1059) I-TARGET_ASSET
. O 

(Citation: O
ExpressVPN O
PATH O
env O
Windows O
2021) O

Adversaries O
may O
also O
directly O
modify O
the O
$PATH B-TARGET_ASSET
variable I-TARGET_ASSET
specifying O
the O
directories O
to O
be O
searched O
. O 

An O
adversary O
can O
modify O
the O
`$PATH` B-TARGET_ASSET
variable I-TARGET_ASSET
to O
point O
to O
a O
directory O
they O
have O
write O
access O
. O 

When O
a O
program B-TARGET_ASSET
using O
the O
$PATH B-TARGET_ASSET
variable I-TARGET_ASSET
is O
called O
, O
the O
OS B-TARGET_ASSET
searches O
the O
specified O
directory O
and O
executes O
the O
malicious O
binary B-TARGET_ASSET
. O 

On O
macOS O
, O
this O
can O
also O
be O
performed O
through O
modifying O
the O
$HOME B-TARGET_ASSET
variable I-TARGET_ASSET
. O 

These O
variables B-TARGET_ASSET
can O
be O
modified O
using O
the O
command-line O
, O
launchctl O
, O
[Unix O
Shell O
Configuration O
Modification](https://attack.mitre.org/techniques/T1546/004) O
, O
or O
modifying O
the O
`/etc/paths.d` O
folder O
contents O
. O 

(Citation: O
uptycs O
Fake O
POC O
linux O
malware O
2023)(Citation: O
nixCraft O
macOS O
PATH O
variables)(Citation: O
Elastic O
Rules O
macOS O
launchctl O
2022) O

Adversaries O
may O
leverage O
the O
SharePoint B-TARGET_ASSET
repository I-TARGET_ASSET
as O
a O
source O
to O
mine O
valuable O
information O
. O 

SharePoint B-TARGET_ASSET
will O
often O
contain O
useful O
information O
for O
an O
adversary O
to O
learn O
about O
the O
structure O
and O
functionality O
of O
the O
internal O
network B-TARGET_ASSET
and O
systems B-TARGET_ASSET
. O 

For O
example O
, O
the O
following O
is O
a O
list O
of O
example O
information O
that O
may O
hold O
potential O
value O
to O
an O
adversary O
and O
may O
also O
be O
found O
on O
SharePoint B-TARGET_ASSET
: O

* O
Policies O
, O
procedures O
, O
and O
standards O
* O
Physical O
/ O
logical O
network B-TARGET_ASSET
diagrams I-TARGET_ASSET
* O
System B-TARGET_ASSET
architecture I-TARGET_ASSET
diagrams I-TARGET_ASSET
* O
Technical O
system B-TARGET_ASSET
documentation I-TARGET_ASSET
* O
Testing O
/ O
development O
credentials B-TARGET_ASSET
(i.e., O
[Unsecured B-TARGET_ASSET
Credentials](https://attack.mitre.org/techniques/T1552) I-TARGET_ASSET
) O
* O
Work O
/ O
project O
schedules O
* O
Source O
code O
snippets O
* O
Links O
to O
network B-TARGET_ASSET
shares I-TARGET_ASSET
and O
other O
internal O
resources O

Adversaries O
may O
directly O
access O
a O
volume B-TARGET_ASSET
to O
bypass O
file B-TARGET_ASSET
access I-TARGET_ASSET
controls I-TARGET_ASSET
and O
file B-TARGET_ASSET
system I-TARGET_ASSET
monitoring I-TARGET_ASSET
. O 

Windows O
allows O
programs O
to O
have O
direct B-PRECON
access I-PRECON
to O
logical B-TARGET_ASSET
volumes I-TARGET_ASSET
. O 

Programs O
with O
direct B-PRECON
access I-PRECON
may O
read O
and O
write O
files B-TARGET_ASSET
directly O
from O
the O
drive B-TARGET_ASSET
by O
analyzing O
file B-TARGET_ASSET
system I-TARGET_ASSET
data I-TARGET_ASSET
structures I-TARGET_ASSET
. O 

This O
technique O
may O
bypass O
Windows O
file B-TARGET_ASSET
access I-TARGET_ASSET
controls I-TARGET_ASSET
as O
well O
as O
file B-TARGET_ASSET
system I-TARGET_ASSET
monitoring I-TARGET_ASSET
tools I-TARGET_ASSET
. O 

(Citation: O
Hakobyan O
2009) O

Utilities B-TARGET_ASSET
, O
such O
as O
`NinjaCopy` O
, O
exist O
to O
perform O
these O
actions O
in O
PowerShell B-TARGET_ASSET
. O 

(Citation: O
Github O
PowerSploit O
Ninjacopy) O
Adversaries O
may O
also O
use O
built-in O
or O
third-party O
utilities B-TARGET_ASSET
(such O
as O
`vssadmin` O
, O
`wbadmin` O
, O
and O
[esentutl](https://attack.mitre.org/software/S0404) B-TARGET_ASSET
) O
to O
create O
shadow B-TARGET_ASSET
copies I-TARGET_ASSET
or O
backups B-TARGET_ASSET
of O
data B-TARGET_ASSET
from O
system B-TARGET_ASSET
volumes I-TARGET_ASSET
. O 

(Citation: O
LOLBAS O
Esentutl) O

Processes O
may O
automatically O
execute O
specific O
binaries B-TARGET_ASSET
as O
part O
of O
their O
functionality O
or O
to O
perform O
other O
actions O
. O 

If O
the O
permissions O
on O
the O
file B-TARGET_ASSET
system I-TARGET_ASSET
directory I-TARGET_ASSET
containing O
a O
target O
binary B-TARGET_ASSET
, O
or O
permissions O
on O
the O
binary B-TARGET_ASSET
itself O
, O
are O
improperly B-PRECON
set I-PRECON
, O
then O
the O
target O
binary B-TARGET_ASSET
may O
be O
overwritten O
with O
another O
binary B-TARGET_ASSET
using O
user-level O
permissions O
and O
executed O
by O
the O
original O
process B-TARGET_ASSET
. O 

If O
the O
original O
process B-TARGET_ASSET
and O
thread O
are O
running B-PRECON
under I-PRECON
a I-PRECON
higher I-PRECON
permissions I-PRECON
level I-PRECON
, O
then O
the O
replaced O
binary B-TARGET_ASSET
will O
also O
execute O
under O
higher-level O
permissions O
, O
which O
could O
include O
SYSTEM O
. O 


Adversaries O
may O
use O
this O
technique O
to O
replace O
legitimate O
binaries B-TARGET_ASSET
with O
malicious O
ones O
as O
a O
means O
of O
executing O
code O
at O
a O
higher O
permissions O
level O
. O 

If O
the O
executing O
process B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
run I-PRECON
at I-PRECON
a I-PRECON
specific I-PRECON
time I-PRECON
or O
during O
a O
certain O
event O
(e.g., O
system O
bootup) O
then O
this O
technique O
can O
also O
be O
used O
for O
persistence O
. O 


### O
Services O
Manipulation O
of O
Windows O
service B-TARGET_ASSET
binaries I-TARGET_ASSET
is O
one O
variation O
of O
this O
technique O
. O 

Adversaries O
may O
replace O
a O
legitimate O
service B-TARGET_ASSET
executable I-TARGET_ASSET
with O
their O
own O
executable B-TARGET_ASSET
to O
gain O
persistence O
and/or O
privilege O
escalation O
to O
the O
account O
context O
the O
service B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
execute I-PRECON
under I-PRECON
(local/domain O
account, O
SYSTEM, O
LocalService, O
or O
NetworkService) O
. O 

Once O
the O
service B-TARGET_ASSET
is O
started O
, O
either O
directly O
by O
the O
user O
(if O
appropriate O
access O
is O
available) O
or O
through O
some O
other O
means O
, O
such O
as O
a O
system O
restart O
if O
the O
service B-TARGET_ASSET
starts B-PRECON
on I-PRECON
bootup I-PRECON
, O
the O
replaced O
executable B-TARGET_ASSET
will O
run O
instead O
of O
the O
original O
service B-TARGET_ASSET
executable I-TARGET_ASSET
. O 


### O
Executable O
Installers O
Another O
variation O
of O
this O
technique O
can O
be O
performed O
by O
taking O
advantage O
of O
a O
weakness O
that O
is O
common O
in O
executable B-TARGET_ASSET
, O
self-extracting B-TARGET_ASSET
installers I-TARGET_ASSET
. O 

During O
the O
installation O
process O
, O
it O
is O
common O
for O
installers B-TARGET_ASSET
to O
use O
a O
subdirectory O
within O
the O
<code>%TEMP%</code> O
directory O
to O
unpack O
binaries B-TARGET_ASSET
such O
as O
DLLs B-TARGET_ASSET
, O
EXEs B-TARGET_ASSET
, O
or O
other O
payloads B-TARGET_ASSET
. O 

When O
installers B-TARGET_ASSET
create O
subdirectories O
and O
files O
they O
often O
do O
not O
set O
appropriate O
permissions O
to O
restrict O
write O
access O
, O
which O
allows O
for O
execution O
of O
untrusted O
code O
placed O
in O
the O
subdirectories O
or O
overwriting O
of O
binaries B-TARGET_ASSET
used O
in O
the O
installation O
process O
. O 

This O
behavior O
is O
related O
to O
and O
may O
take O
advantage O
of O
[DLL B-TARGET_ASSET
Search I-TARGET_ASSET
Order I-TARGET_ASSET
Hijacking](https://attack.mitre.org/techniques/T1038) I-TARGET_ASSET
. O 

Some O
installers B-TARGET_ASSET
may O
also O
require O
elevated B-PRECON
privileges I-PRECON
that O
will O
result O
in O
privilege O
escalation O
when O
executing O
adversary O
controlled O
code O
. O 

This O
behavior O
is O
related O
to O
[Bypass O
User O
Account O
Control](https://attack.mitre.org/techniques/T1088) O
. O 

Several O
examples O
of O
this O
weakness O
in O
existing O
common O
installers B-TARGET_ASSET
have O
been O
reported O
to O
software O
vendors O
. O 

(Citation: O
Mozilla O
Firefox O
Installer O
DLL O
Hijack) O
(Citation: O
Seclists O
Kanthak O
7zip O
Installer) O

Adversaries O
may O
obtain O
access O
to O
generative B-TARGET_ASSET
artificial I-TARGET_ASSET
intelligence I-TARGET_ASSET
tools I-TARGET_ASSET
, O
such O
as O
large B-TARGET_ASSET
language I-TARGET_ASSET
models I-TARGET_ASSET
( I-TARGET_ASSET
LLMs I-TARGET_ASSET
) I-TARGET_ASSET
, O
to O
aid O
various O
techniques O
during O
targeting O
. O 

These O
tools B-TARGET_ASSET
may O
be O
used O
to O
inform O
, O
bolster O
, O
and O
enable O
a O
variety O
of O
malicious O
tasks O
, O
including O
conducting O
[Reconnaissance](https://attack.mitre.org/tactics/TA0043) O
, O
creating O
basic O
scripts B-TARGET_ASSET
, O
assisting O
social O
engineering O
, O
and O
even O
developing O
payloads B-TARGET_ASSET
. O 

(Citation: O
MSFT-AI) O

For O
example O
, O
by O
utilizing O
a O
publicly B-PRECON
available I-PRECON
LLM B-TARGET_ASSET
an O
adversary O
is O
essentially O
outsourcing O
or O
automating O
certain O
tasks O
to O
the O
tool B-TARGET_ASSET
. O 

Using O
AI O
, O
the O
adversary O
may O
draft O
and O
generate O
content O
in O
a O
variety O
of O
written O
languages O
to O
be O
used O
in O
[Phishing](https://attack.mitre.org/techniques/T1566)/[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
campaigns O
. O 

The O
same O
publicly B-PRECON
available I-PRECON
tool B-TARGET_ASSET
may O
further O
enable O
vulnerability O
or O
other O
offensive O
research O
supporting O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
. O 

AI B-TARGET_ASSET
tools I-TARGET_ASSET
may O
also O
automate O
technical O
tasks O
by O
generating O
, O
refining O
, O
or O
otherwise O
enhancing O
(e.g., O
[Obfuscated O
Files O
or O
Information](https://attack.mitre.org/techniques/T1027)) O
malicious O
scripts B-TARGET_ASSET
and O
payloads B-TARGET_ASSET
. O 

(Citation: O
OpenAI-CTI) O
Finally O
, O
AI-generated O
text O
, O
images O
, O
audio O
, O
and O
video O
may O
be O
used O
for O
fraud O
, O
[Impersonation](https://attack.mitre.org/techniques/T1656) O
, O
and O
other O
malicious O
activities O
. O 

(Citation: O
Google-Vishing24)(Citation: O
IC3-AI24)(Citation: O
WSJ-Vishing-AI24) O

Adversaries O
may O
attempt O
to O
modify O
hierarchical O
structures O
in O
infrastructure-as-a-service B-TARGET_ASSET
( I-TARGET_ASSET
IaaS I-TARGET_ASSET
) I-TARGET_ASSET
environments I-TARGET_ASSET
in O
order O
to O
evade O
defenses O
. O 


IaaS B-TARGET_ASSET
environments I-TARGET_ASSET
often O
group O
resources O
into O
a O
hierarchy O
, O
enabling O
improved O
resource O
management O
and O
application O
of O
policies O
to O
relevant O
groups O
. O 

Hierarchical O
structures O
differ O
among O
cloud O
providers O
. O 

For O
example O
, O
in O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
multiple O
accounts B-TARGET_ASSET
can O
be O
grouped O
under O
a O
single O
organization B-TARGET_ASSET
, O
while O
in O
Azure B-TARGET_ASSET
environments I-TARGET_ASSET
, O
multiple O
subscriptions B-TARGET_ASSET
can O
be O
grouped O
under O
a O
single O
management B-TARGET_ASSET
group I-TARGET_ASSET
. O 

(Citation: O
AWS O
Organizations)(Citation: O
Microsoft O
Azure O
Resources) O

Adversaries O
may O
add O
, O
delete O
, O
or O
otherwise O
modify O
resource B-TARGET_ASSET
groups I-TARGET_ASSET
within O
an O
IaaS B-TARGET_ASSET
hierarchy I-TARGET_ASSET
. O 

For O
example O
, O
in O
Azure B-TARGET_ASSET
environments I-TARGET_ASSET
, O
an O
adversary O
who O
has O
gained O
access O
to O
a O
Global O
Administrator O
account B-TARGET_ASSET
may O
create O
new O
subscriptions B-TARGET_ASSET
in O
which O
to O
deploy O
resources O
. O 

They O
may O
also O
engage O
in O
subscription O
hijacking O
by O
transferring O
an O
existing O
pay-as-you-go O
subscription B-TARGET_ASSET
from O
a O
victim O
tenant O
to O
an O
adversary-controlled O
tenant O
. O 

This O
will O
allow O
the O
adversary O
to O
use O
the O
victim’s O
compute O
resources O
without O
generating O
logs B-TARGET_ASSET
on O
the O
victim O
tenant O
. O 

(Citation: O
Microsoft O
Peach O
Sandstorm O
2023)(Citation: O
Microsoft O
Subscription O
Hijacking O
2022) O

In O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
adversaries O
with O
appropriate O
permissions O
in O
a O
given O
account B-TARGET_ASSET
may O
call O
the O
`LeaveOrganization` B-TARGET_ASSET
API I-TARGET_ASSET
, O
causing O
the O
account B-TARGET_ASSET
to O
be O
severed O
from O
the O
AWS B-TARGET_ASSET
Organization I-TARGET_ASSET
to O
which O
it O
was O
tied O
and O
removing O
any O
Service B-TARGET_ASSET
Control I-TARGET_ASSET
Policies I-TARGET_ASSET
, O
guardrails O
, O
or O
restrictions O
imposed O
upon O
it O
by O
its O
former O
Organization B-TARGET_ASSET
. O 

Alternatively O
, O
adversaries O
may O
call O
the O
`CreateAccount` B-TARGET_ASSET
API I-TARGET_ASSET
in O
order O
to O
create O
a O
new O
account B-TARGET_ASSET
within O
an O
AWS B-TARGET_ASSET
Organization I-TARGET_ASSET
. O 

This O
account B-TARGET_ASSET
will O
use O
the O
same O
payment O
methods O
registered O
to O
the O
payment O
account O
but O
may O
not O
be O
subject O
to O
existing O
detections O
or O
Service B-TARGET_ASSET
Control I-TARGET_ASSET
Policies I-TARGET_ASSET
. O 

(Citation: O
AWS O
RE:Inforce O
Threat O
Detection O
2024) O

Adversaries O
may O
use O
email B-TARGET_ASSET
rules I-TARGET_ASSET
to O
hide O
inbound O
emails B-TARGET_ASSET
in O
a O
compromised O
user's O
mailbox B-TARGET_ASSET
. O 

Many O
email B-TARGET_ASSET
clients I-TARGET_ASSET
allow O
users O
to O
create O
inbox B-TARGET_ASSET
rules I-TARGET_ASSET
for O
various O
email O
functions O
, O
including O
moving O
emails B-TARGET_ASSET
to O
other O
folders O
, O
marking O
emails B-TARGET_ASSET
as O
read O
, O
or O
deleting O
emails B-TARGET_ASSET
. O 

Rules B-TARGET_ASSET
may O
be O
created O
or O
modified O
within O
email B-TARGET_ASSET
clients I-TARGET_ASSET
or O
through O
external O
features O
such O
as O
the O
<code>New-InboxRule</code> O
or O
<code>Set-InboxRule</code> O
[PowerShell](https://attack.mitre.org/techniques/T1059/001) B-TARGET_ASSET
cmdlets I-TARGET_ASSET
on O
Windows O
systems B-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Inbox O
Rules)(Citation: O
MacOS O
Email O
Rules)(Citation: O
Microsoft O
New-InboxRule)(Citation: O
Microsoft O
Set-InboxRule) O

Adversaries O
may O
utilize O
email B-TARGET_ASSET
rules I-TARGET_ASSET
within O
a O
compromised B-PRECON
user's O
mailbox B-TARGET_ASSET
to O
delete O
and/or O
move O
emails B-TARGET_ASSET
to O
less O
noticeable O
folders O
. O 

Adversaries O
may O
do O
this O
to O
hide O
security O
alerts B-TARGET_ASSET
, O
C2 O
communication B-TARGET_ASSET
, O
or O
responses O
to O
[Internal O
Spearphishing](https://attack.mitre.org/techniques/T1534) O
emails B-TARGET_ASSET
sent O
from O
the O
compromised O
account B-TARGET_ASSET
. O 


Any O
user O
or O
administrator O
within O
the O
organization O
(or O
adversary O
with O
valid O
credentials) O
may O
be O
able O
to O
create O
rules B-TARGET_ASSET
to O
automatically O
move O
or O
delete O
emails B-TARGET_ASSET
. O 

These O
rules B-TARGET_ASSET
can O
be O
abused O
to O
impair/delay O
detection O
had O
the O
email B-TARGET_ASSET
content I-TARGET_ASSET
been O
immediately O
seen O
by O
a O
user O
or O
defender O
. O 

Malicious O
rules B-TARGET_ASSET
commonly O
filter O
out O
emails B-TARGET_ASSET
based O
on O
key O
words O
(such O
as O
<code>malware</code> O
, O
<code>suspicious</code> O
, O
<code>phish</code> O
, O
and O
<code>hack</code>) O
found O
in O
message B-TARGET_ASSET
bodies I-TARGET_ASSET
and O
subject B-TARGET_ASSET
lines I-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Cloud O
App O
Security) O

In O
some O
environments O
, O
administrators O
may O
be O
able O
to O
enable O
email B-TARGET_ASSET
rules I-TARGET_ASSET
that O
operate B-PRECON
organization-wide I-PRECON
rather O
than O
on O
individual O
inboxes B-TARGET_ASSET
. O 

For O
example O
, O
Microsoft B-TARGET_ASSET
Exchange I-TARGET_ASSET
supports O
transport B-TARGET_ASSET
rules I-TARGET_ASSET
that O
evaluate O
all O
mail B-TARGET_ASSET
an O
organization O
receives O
against O
user-specified O
conditions O
, O
then O
performs O
a O
user-specified O
action O
on O
mail B-TARGET_ASSET
that O
adheres O
to O
those O
conditions O
. O 

(Citation: O
Microsoft O
Mail O
Flow O
Rules O
2023) O
Adversaries O
that O
abuse O
such O
features O
may O
be O
able O
to O
automatically O
modify O
or O
delete O
all O
emails B-TARGET_ASSET
related O
to O
specific O
topics O
(such O
as O
internal O
security O
incident O
notifications) O
. O 


An O
adversary O
may O
deface O
systems B-TARGET_ASSET
external B-PRECON
to I-PRECON
an I-PRECON
organization I-PRECON
in O
an O
attempt O
to O
deliver O
messaging O
, O
intimidate O
, O
or O
otherwise O
mislead O
an O
organization O
or O
users O
. O 

[External O
Defacement](https://attack.mitre.org/techniques/T1491/002) O
may O
ultimately O
cause O
users O
to O
distrust O
the O
systems B-TARGET_ASSET
and O
to O
question/discredit O
the O
system’s B-TARGET_ASSET
integrity I-TARGET_ASSET
. O 

Externally-facing B-PRECON
websites B-TARGET_ASSET
are O
a O
common O
victim O
of O
defacement O
; O
often O
targeted O
by O
adversary O
and O
hacktivist O
groups O
in O
order O
to O
push O
a O
political O
message O
or O
spread O
propaganda O
. O 

(Citation: O
FireEye O
Cyber O
Threats O
to O
Media O
Industries)(Citation: O
Kevin O
Mandia O
Statement O
to O
US O
Senate O
Committee O
on O
Intelligence)(Citation: O
Anonymous O
Hackers O
Deface O
Russian O
Govt O
Site) O
[External O
Defacement](https://attack.mitre.org/techniques/T1491/002) O
may O
be O
used O
as O
a O
catalyst O
to O
trigger O
events O
, O
or O
as O
a O
response O
to O
actions O
taken O
by O
an O
organization O
or O
government O
. O 

Similarly O
, O
website B-TARGET_ASSET
defacement I-TARGET_ASSET
may O
also O
be O
used O
as O
setup O
, O
or O
a O
precursor O
, O
for O
future O
attacks O
such O
as O
[Drive-by B-TARGET_ASSET
Compromise](https://attack.mitre.org/techniques/T1189) I-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro O
Deep O
Dive O
Into O
Defacement) O

Adversaries O
may O
encrypt O
or O
encode O
files B-TARGET_ASSET
to O
obfuscate O
strings O
, O
bytes O
, O
and O
other O
specific O
patterns O
to O
impede O
detection O
. O 

Encrypting O
and/or O
encoding O
file B-TARGET_ASSET
content I-TARGET_ASSET
aims O
to O
conceal O
malicious O
artifacts O
within O
a O
file B-TARGET_ASSET
used O
in O
an O
intrusion O
. O 

Many O
other O
techniques O
, O
such O
as O
[Software B-TARGET_ASSET
Packing](https://attack.mitre.org/techniques/T1027/002) I-TARGET_ASSET
, O
[Steganography](https://attack.mitre.org/techniques/T1027/003) O
, O
and O
[Embedded B-TARGET_ASSET
Payloads](https://attack.mitre.org/techniques/T1027/009) I-TARGET_ASSET
, O
share O
this O
same O
broad O
objective O
. O 

Encrypting O
and/or O
encoding O
files B-TARGET_ASSET
could O
lead O
to O
a O
lapse O
in O
detection O
of O
static O
signatures O
, O
only O
for O
this O
malicious O
content O
to O
be O
revealed O
(i.e., O
[Deobfuscate/Decode O
Files O
or O
Information](https://attack.mitre.org/techniques/T1140)) O
at O
the O
time O
of O
execution/use O
. O 


This O
type O
of O
file O
obfuscation O
can O
be O
applied O
to O
many O
file B-TARGET_ASSET
artifacts I-TARGET_ASSET
present O
on O
victim O
hosts B-TARGET_ASSET
, O
such O
as O
malware B-TARGET_ASSET
log/configuration I-TARGET_ASSET
and O
payload B-TARGET_ASSET
files I-TARGET_ASSET
. O 

(Citation: O
File O
obfuscation) O
Files B-TARGET_ASSET
can O
be O
encrypted B-PRECON
with I-PRECON
a I-PRECON
hardcoded I-PRECON
or I-PRECON
user-supplied I-PRECON
key I-PRECON
, O
as O
well O
as O
otherwise O
obfuscated O
using O
standard O
encoding O
schemes O
such O
as O
Base64 O
. O 


The O
entire O
content O
of O
a O
file B-TARGET_ASSET
may O
be O
obfuscated B-PRECON
, O
or O
just O
specific O
functions O
or O
values O
(such O
as O
C2 O
addresses) O
. O 

Encryption O
and O
encoding O
may O
also O
be O
applied O
in O
redundant O
layers O
for O
additional O
protection O
. O 


For O
example O
, O
adversaries O
may O
abuse O
password-protected B-PRECON
Word B-TARGET_ASSET
documents I-TARGET_ASSET
or O
self-extracting B-TARGET_ASSET
( I-TARGET_ASSET
SFX I-TARGET_ASSET
) I-TARGET_ASSET
archives I-TARGET_ASSET
as O
a O
method O
of O
encrypting/encoding O
a O
file B-TARGET_ASSET
such O
as O
a O
[Phishing](https://attack.mitre.org/techniques/T1566) O
payload B-TARGET_ASSET
. O 

These O
files B-TARGET_ASSET
typically O
function O
by O
attaching O
the O
intended O
archived O
content O
to O
a O
decompressor B-TARGET_ASSET
stub I-TARGET_ASSET
that O
is O
executed O
when O
the O
file B-TARGET_ASSET
is O
invoked O
(e.g., O
[User O
Execution](https://attack.mitre.org/techniques/T1204)) O
. O 

(Citation: O
SFX O
- O
Encrypted/Encoded O
File) O

Adversaries O
may O
also O
abuse O
file-specific O
as O
well O
as O
custom O
encoding O
schemes O
. O 

For O
example O
, O
Byte O
Order O
Mark O
(BOM) O
headers B-TARGET_ASSET
in O
text B-TARGET_ASSET
files I-TARGET_ASSET
may O
be O
abused O
to O
manipulate O
and O
obfuscate O
file B-TARGET_ASSET
content I-TARGET_ASSET
until O
[Command B-TARGET_ASSET
and I-TARGET_ASSET
Scripting I-TARGET_ASSET
Interpreter](https://attack.mitre.org/techniques/T1059) I-TARGET_ASSET
execution O
. O 


Adversaries O
may O
use O
scripts B-TARGET_ASSET
automatically B-PRECON
executed I-PRECON
at I-PRECON
boot I-PRECON
or I-PRECON
logon I-PRECON
initialization I-PRECON
to O
establish O
persistence O
. O 

(Citation: O
Mandiant O
APT29 O
Eye O
Spy O
Email O
Nov O
22)(Citation: O
Anomali O
Rocke O
March O
2019) O
Initialization B-TARGET_ASSET
scripts I-TARGET_ASSET
can O
be O
used O
to O
perform O
administrative O
functions O
, O
which O
may O
often O
execute O
other O
programs O
or O
send O
information O
to O
an O
internal O
logging B-TARGET_ASSET
server I-TARGET_ASSET
. O 

These O
scripts B-TARGET_ASSET
can O
vary O
based O
on O
operating B-TARGET_ASSET
system I-TARGET_ASSET
and O
whether O
applied O
locally O
or O
remotely O
. O 


Adversaries O
may O
use O
these O
scripts B-TARGET_ASSET
to O
maintain O
persistence O
on O
a O
single O
system B-TARGET_ASSET
. O 

Depending O
on O
the O
access O
configuration O
of O
the O
logon B-TARGET_ASSET
scripts I-TARGET_ASSET
, O
either O
local O
credentials B-TARGET_ASSET
or O
an O
administrator O
account O
may O
be O
necessary O
. O 


An O
adversary O
may O
also O
be O
able O
to O
escalate O
their O
privileges O
since O
some O
boot B-TARGET_ASSET
or O
logon B-TARGET_ASSET
initialization I-TARGET_ASSET
scripts I-TARGET_ASSET
run B-PRECON
with I-PRECON
higher I-PRECON
privileges I-PRECON
. O 


Adversaries O
may O
attempt O
to O
position O
themselves O
between O
two O
or O
more O
networked O
devices B-TARGET_ASSET
using O
an O
adversary-in-the-middle O
(AiTM) O
technique O
to O
support O
follow-on O
behaviors O
such O
as O
[Network O
Sniffing](https://attack.mitre.org/techniques/T1040) O
, O
[Transmitted O
Data O
Manipulation](https://attack.mitre.org/techniques/T1565/002) O
, O
or O
replay O
attacks O
([Exploitation O
for O
Credential O
Access](https://attack.mitre.org/techniques/T1212)) O
. O 

By O
abusing O
features O
of O
common O
networking B-TARGET_ASSET
protocols I-TARGET_ASSET
that O
can O
determine O
the O
flow O
of O
network O
traffic B-TARGET_ASSET
(e.g. O 

ARP B-TARGET_ASSET
, O
DNS B-TARGET_ASSET
, O
LLMNR B-TARGET_ASSET
, O
etc.) O
, O
adversaries O
may O
force O
a O
device B-TARGET_ASSET
to O
communicate O
through O
an O
adversary O
controlled O
system B-TARGET_ASSET
so O
they O
can O
collect O
information O
or O
perform O
additional O
actions O
. O 

(Citation: O
Rapid7 O
MiTM O
Basics) O

For O
example O
, O
adversaries O
may O
manipulate O
victim O
DNS B-TARGET_ASSET
settings I-TARGET_ASSET
to O
enable O
other O
malicious O
activities O
such O
as O
preventing/redirecting O
users O
from O
accessing O
legitimate O
sites O
and/or O
pushing O
additional O
malware O
. O 

(Citation: O
ttint_rat)(Citation: O
dns_changer_trojans)(Citation: O
ad_blocker_with_miner) O
Adversaries O
may O
also O
manipulate O
DNS B-TARGET_ASSET
and O
leverage O
their O
position O
in O
order O
to O
intercept O
user O
credentials B-TARGET_ASSET
, O
including O
access B-TARGET_ASSET
tokens I-TARGET_ASSET
([Steal O
Application O
Access O
Token](https://attack.mitre.org/techniques/T1528)) O
and O
session B-TARGET_ASSET
cookies I-TARGET_ASSET
([Steal O
Web O
Session O
Cookie](https://attack.mitre.org/techniques/T1539)) O
. O 

(Citation: O
volexity_0day_sophos_FW)(Citation: O
Token O
tactics) O
[Downgrade O
Attack](https://attack.mitre.org/techniques/T1562/010)s O
can O
also O
be O
used O
to O
establish O
an O
AiTM O
position O
, O
such O
as O
by O
negotiating O
a O
less B-PRECON
secure I-PRECON
, O
deprecated B-PRECON
, O
or O
weaker B-PRECON
version O
of O
communication B-TARGET_ASSET
protocol I-TARGET_ASSET
(SSL/TLS) O
or O
encryption B-TARGET_ASSET
algorithm I-TARGET_ASSET
. O 

(Citation: O
mitm_tls_downgrade_att)(Citation: O
taxonomy_downgrade_att_tls)(Citation: O
tlseminar_downgrade_att) O

Adversaries O
may O
also O
leverage O
the O
AiTM O
position O
to O
attempt O
to O
monitor O
and/or O
modify O
traffic B-TARGET_ASSET
, O
such O
as O
in O
[Transmitted O
Data O
Manipulation](https://attack.mitre.org/techniques/T1565/002) O
. O 

Adversaries O
can O
setup O
a O
position O
similar O
to O
AiTM O
to O
prevent O
traffic B-TARGET_ASSET
from O
flowing O
to O
the O
appropriate O
destination O
, O
potentially O
to O
[Impair O
Defenses](https://attack.mitre.org/techniques/T1562) O
and/or O
in O
support O
of O
a O
[Network O
Denial O
of O
Service](https://attack.mitre.org/techniques/T1498) O
. O 


Adversaries O
may O
attempt O
to O
identify O
the O
primary O
user O
, O
currently O
logged O
in O
user O
, O
set O
of O
users O
that O
commonly O
uses O
a O
system B-TARGET_ASSET
, O
or O
whether O
a O
user O
is O
actively O
using O
the O
system B-TARGET_ASSET
. O 

They O
may O
do O
this O
, O
for O
example O
, O
by O
retrieving O
account B-TARGET_ASSET
usernames I-TARGET_ASSET
or O
by O
using O
[OS B-TARGET_ASSET
Credential I-TARGET_ASSET
Dumping](https://attack.mitre.org/techniques/T1003) I-TARGET_ASSET
. O 

The O
information O
may O
be O
collected O
in O
a O
number O
of O
different O
ways O
using O
other O
Discovery O
techniques O
, O
because O
user O
and O
username O
details O
are O
prevalent O
throughout O
a O
system B-TARGET_ASSET
and O
include O
running O
process O
ownership O
, O
file/directory O
ownership O
, O
session O
information O
, O
and O
system B-TARGET_ASSET
logs I-TARGET_ASSET
. O 

Adversaries O
may O
use O
the O
information O
from O
[System O
Owner/User O
Discovery](https://attack.mitre.org/techniques/T1033) O
during O
automated O
discovery O
to O
shape O
follow-on O
behaviors O
, O
including O
whether O
or O
not O
the O
adversary O
fully O
infects O
the O
target O
and/or O
attempts O
specific O
actions O
. O 


Various O
utilities B-TARGET_ASSET
and O
commands O
may O
acquire O
this O
information O
, O
including O
<code>whoami</code> O
. O 

In O
macOS O
and O
Linux O
, O
the O
currently O
logged O
in O
user O
can O
be O
identified O
with O
<code>w</code> O
and O
<code>who</code> O
. O 

On O
macOS O
the O
<code>dscl O
. O 

list O
/Users O
| O
grep O
-v O
'_'</code> O
command O
can O
also O
be O
used O
to O
enumerate O
user O
accounts B-TARGET_ASSET
. O 

Environment B-TARGET_ASSET
variables I-TARGET_ASSET
, O
such O
as O
<code>%USERNAME%</code> O
and O
<code>$USER</code> O
, O
may O
also O
be O
used O
to O
access O
this O
information O
. O 


On O
network B-TARGET_ASSET
devices I-TARGET_ASSET
, O
[Network B-TARGET_ASSET
Device I-TARGET_ASSET
CLI](https://attack.mitre.org/techniques/T1059/008) I-TARGET_ASSET
commands O
such O
as O
`show O
users` O
and O
`show O
ssh` O
can O
be O
used O
to O
display O
users O
currently O
logged O
into O
the O
device B-TARGET_ASSET
. O 

(Citation: O
show_ssh_users_cmd_cisco)(Citation: O
US-CERT O
TA18-106A O
Network O
Infrastructure O
Devices O
2018) O

Adversaries O
may O
buy O
, O
lease O
, O
rent O
, O
or O
obtain O
infrastructure B-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

A O
wide O
variety O
of O
infrastructure B-TARGET_ASSET
exists O
for O
hosting O
and O
orchestrating O
adversary O
operations O
. O 

Infrastructure B-TARGET_ASSET
solutions I-TARGET_ASSET
include O
physical O
or O
cloud O
servers B-TARGET_ASSET
, O
domains B-TARGET_ASSET
, O
and O
third-party O
web B-TARGET_ASSET
services I-TARGET_ASSET
. O 

(Citation: O
TrendmicroHideoutsLease) O
Some O
infrastructure B-TARGET_ASSET
providers I-TARGET_ASSET
offer O
free B-PRECON
trial I-PRECON
periods I-PRECON
, O
enabling O
infrastructure B-TARGET_ASSET
acquisition O
at O
limited O
to O
no O
cost O
. O 

(Citation: O
Free O
Trial O
PurpleUrchin) O
Additionally O
, O
botnets B-TARGET_ASSET
are O
available O
for O
rent O
or O
purchase O
. O 


Use O
of O
these O
infrastructure B-TARGET_ASSET
solutions I-TARGET_ASSET
allows O
adversaries O
to O
stage O
, O
launch O
, O
and O
execute O
operations O
. O 